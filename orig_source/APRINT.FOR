      SUBROUTINE APRINT(NUMBER)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
      IMPLICIT REAL*8(A-H,O-Z)
       LOGICAL*1 GTEMP(4)
      INTEGER DEBUG,SUM
       REAL*8 NAME,MACNAM,KRFSYS
      INTEGER PUNTAP
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
       INTEGER*2 VST2(28800),KTEMP(2)
      COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1
     1 ,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON /ASYNTB/SYNB(100),INSYN,MAXSYN
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/AMXTAB/MAXTAB,MAXVS1,MAXVS2,MAXPTP,MAXSCL,MAXVS,MAXVST,
     1MXPTPP,MXCAN,MXSRCN,MAXSLR,MAXELM,MAXPOT
      COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
       COMMON/ABREAK/NEXTNW,NRELCN,KANLCN,LOCSEQ,NEXTCN,NWONRD,LPLOCN
     1 ,JSW4,ISN,K,MXLOOP,JSW2,JSAV,JSW1,MAXMV,MXNEST,INILL,KF
      COMMON/ASCALR/SCALR(180),ISCWS,NSURF,LOCTEM,IARGTP
      COMMON/APARTB/ILPCNT,IRPCNT,ILVCNT
      COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
      COMMON/AVST/VST(7200)
      EQUIVALENCE(VST(1),CANON(1),PTPP(1))
      DIMENSION PTPP(1), CANON(1)
      COMMON/AMACRO/LIMCAN,LMDW,NITEMS,JWHAT,MACREC,MACVST,MACERR
      COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
      COMMON/AMCSTF/MACNAM(5),MACCUR,MACLCN(5),MACRD,MACSTR(5),NMACVR
     1 ,NUMIDS,IDLOCN,MACIDS(5),ISVID
       DIMENSION ICANON(2)
       EQUIVALENCE (ITEMP,KTEMP(1),GTEMP(1))
       EQUIVALENCE (VST(1),VST2(1)),(CANON(1),ICANON(1))
C*********
C*********
C*********
C  NOTE - - - IN ALL OF THE CALLS TO SUBROUTINE HEX, REFERENCES TO
C             PTPP ARE ACTUALLY REFERENCES TO CANON - THE RELATIVE INDEX
C             HAS BEEN ADJUSTED BY 2225 TO PERMIT THIS.
C*********
C*********
C*********
C
      IF(DEBUG .EQ. 0 )  GO TO 999
       GO TO (1,2,3,4,5,6,7,8,9),NUMBER
C
    1  JSTART = 1
       JEND = JLMENT
   10  WRITE (IOUTAP,11)
   11  FORMAT (1H0,4X,4HWORD,7X,6HICLASS,11X,6HELMENT)
       DO 18  I = JSTART,JEND
       ITEMP = ICLASS(I)
       GTEMP(4) = GTEMP(3)
   18  WRITE (IOUTAP,19) I,KTEMP(1),KTEMP(2),ICLASS(I),ELMENT(I)
   19  FORMAT (5X,I4,Z9,Z2,2X,Z2,Z20)
       GO TO 999
C
    5  JSTART = ISTARP - 10
       JEND = IENDP + 5
            IF(JEND.LE.JLMENT) GO TO 51
       JEND = JLMENT
   51       IF(JSTART)  1, 1, 10
C
    2  WRITE (IOUTAP,21) (PTPP(J),J=1,NITEMS)
   21  FORMAT (23H0    MACRO BEING STORED/(5X,5Z20/))
      GO TO 999
C
C...     GET SUBSCRIPT TO MACRO NAME IN VST
    3  J = 4*MACVST - 3
       MM = VST2(J+7)
       NN = 2*MM - 1
C...     GET NUMBER OF MACRO VARIABLES
       J = ICANON(NN+3)
       K = ICANON(NN+5)
       WRITE (IOUTAP,31) CANON(MM),J
   31  FORMAT (1H0,10H    MACRO ,A6,4H - -,I3,16H MACRO VARIABLES)
       L = MM - 2
C...     TEST FOR EXISTENCE OF MACRO VARIABLES
      IF(J .EQ. 0)  GO TO 37
C
       WRITE (IOUTAP,33)
   33  FORMAT (1H+,39X,14H, AS FOLLOWS -/7X,4HNAME,17X,12HNORMAL VALUE,
     1 27X,14HASSIGNED VALUE)
      J = J*5
      DO 34 I = 1,J,5
      L  = MM + 2 + I
   34  WRITE (IOUTAP,35) PTPP(L),PTPP(L+1),PTPP(L+2),PTPP(L+3)
     1 ,PTPP(L+4)
   35  FORMAT (6X,A6,2Z20,4X,2Z20)
C
   37 L = L + 5
      LL = L+K-1
       WRITE (IOUTAP,36) L,(PTPP(J),J=L,LL)
   36  FORMAT (29H0    SQUEEZED MACRO AT CANON(,I4,1H)//(5H+    ,5Z20/))
      GO TO 999
C
    4  WRITE (IOUTAP,41) MACNAM(MACCUR)
   41  FORMAT (24H0    RETURNING TO MACRO ,A6)
       GO TO 74
C
    6  LS = LMDW/5
       WRITE (IOUTAP,61) LS
   61  FORMAT (1H0,20X,I3,16H MACRO VARIABLES)
            IF(LMDW.EQ.0) GO TO 999
       WRITE (IOUTAP,33)
       LBB = LIMCAN - 1
       DO 62  L = 1,LS
       LBB = LBB + 5
      LP4 = LBB + 4
       WRITE (IOUTAP,35) (PTPP(J),J=LBB,LP4)
   62 CONTINUE
      GO TO 999
C
    7  WRITE (IOUTAP,71) MACNAM(MACCUR)
   71  FORMAT (11H0    MACRO ,A6,7H CALLED)
            IF(MACCUR.LE.1) GO TO 3
C
   74  WRITE (IOUTAP,75) MACCUR,KANLCN,NMACVR,MACCUR,MACSTR(MACCUR)
   75  FORMAT (10H     LEVEL,I4,10H, KANLCN =,I6,10H, NMACVR =,I4,9H, MA
     1CSTR(,I2,3H) =,I6)
            IF(NUMBER.EQ.4) GO TO 999
      GOTO 3
C
    8  WRITE (IOUTAP,121) KLASS,KLASTP
  121  FORMAT (1H0,4X,28HVOCABULARY WORD, ICLASS TYPE,I4,10H,  SUBTYPE,
     1 I4)
      GO TO 999
C
    9  WRITE (IOUTAP,91) (SYNB(J),J=1,INSYN)
   91  FORMAT (1H0,10X,22HSYNONYM TABLE CONTENTS/(9X,A6,Z20/))
      GO TO 999
  999 RETURN
      END

