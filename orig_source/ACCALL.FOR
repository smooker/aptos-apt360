      SUBROUTINE ACCALL
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4,MODIFICATION 4 ***
      IMPLICIT REAL*8(A-H,O-Z)
      REAL*8 INWORD,NEWONE,NAME,IDIS,MACNAM,KRFSYS
      INTEGER AMATOD,AEXTRA,AMDTOA,AEXTRD,AEXCH,DEBUG,SUM
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
      COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
       COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
      COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
      DIMENSION IPT(600)
      EQUIVALENCE (PT(1),IPT(1))
C     SET UP CLASS 17 PTPP - SPECIAL PROGRAM CALL
      JMODE = 5
      NW = -K1
      NPT=0
      ITSQ = 0
      PT(1)=AFULL8(17,K0)
C     PICK UP SPECIAL PROGRAM NAME
      PT(2) = ELMENT(ISTARP-3)
      IT=0
C     CHECK FORMAT OF PARAMETERS (IF ANY)
      IF(ISTARP.GT.JLMENT) GO TO 20
       JV = ISTARP + 2
      IF(JV.GT.JLMENT) GOTO 10
      IF(IATYPE(JV).NE.K4) GOTO 10
      IF(IBCLAS(JV).NE.K8) GOTO 10
      IT=K2
      GOTO 20
 10   IT=K1
C     SET SEC1 OR SEC2 CALL
 20   JV = IBCLAS(ISTARP-1)
      IF(AEXTRA(JV,K2).NE.31) GOTO 60
      PT(3)=AFULL8(AMDTOA(JV,K2),IT)
      INPTP=K4
C     SET UP PARAMETER LIST (IF ANY)
      IF(ISTARP.GT.JLMENT) GO TO 40
C
 25   IF(IATYPE(ISTARP).NE.4) GO TO 90
      IF(IBCLAS(ISTARP).NE.9) GO TO 90
      ISTARP = ISTARP + 1
      IF(IT.EQ.K1) GOTO 30
C     SET ALPHAMERIC NAME
      IF(IATYPE(ISTARP).NE.1) GO TO 60
      PT(INPTP) = ELMENT(ISTARP)
      ISTARP = ISTARP + 1
       INPTP = INPTP + 1
C...     CHECK FOR = SIGN
          IF(IATYPE(ISTARP).NE.4) GO TO 100
          IF(IBCLAS(ISTARP).NE.8) GO TO 100
      ISTARP = ISTARP + 1
C
C... MOVE PARAMETER TO PT
   30  CALL APTLOD
C...     CHECK FOR PARAMETER IN ERROR
            IF(JSUBER.NE.0) GO TO 110
      IF(ISTARP.LE.JLMENT) GO TO 50
C     SET PTPP JMODE FOR FINAL PARAMETER
 40   IF(JMODE.NE.5) JMODE = 3
      INPTP = INPTP - 1
      NW=NW+INPTP
      IPT(2) = NW
      GO TO 115
 50   IF(INPTP.LE.296) GO TO 25
      IF(JMODE.EQ.5) JMODE = 1
      CALL APTPUT
      JMODE = 2
      INPTP=K1
      GOTO 25
C     INCORRECT FORMAT FOR SPECIAL PROGRAM CALL
 60   JSUBER=226
      GOTO 110
C     ILLEGAL VARIABLE SYMBOL - ID OR MACRO NAME
C     NO COMMA
 90   JSUBER=234
      GOTO 110
C     NO = SIGN
 100  JSUBER=229
C     ABORT THIS PTPP CLASS
 110  JMODE=K4
 115  CALL APTPUT
      RETURN
      END

