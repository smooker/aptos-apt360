      SUBROUTINE ASCLPT(A)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C*    THIS ROUTINE STORES SCALAR 'A' IN THE CANON SCALAR STORAGE AREA
C*    ICANSC IS THE BEGINNING OF SCALAR STORAGE INDEX
C*    NAME CONTAINS THE VST INDEX OF THE SCALAR SYMBOL
C*    NAMSUB CONTAINS THE SUBSCRIPT VALUE
C
      IMPLICIT REAL*8(A-H,O-Z)
       INTEGER IERR(2)/0,9/
       DIMENSION PTPP(7200),CANON(7200)
       DIMENSION IVST(14400)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/AVST/VST(7200)
      EQUIVALENCE(VST(1),PTPP(1),CANON(1))
       EQUIVALENCE (VST(1),IVST(1))
      COMMON/A2CLS7/PPSEQ1,PPSEQ2,ENAME,EINAME,IEREC,ISN
      COMMON/A1PAS2/I,J,K,L,MOVLGE,KANMAX,ICANST,IOVREC,KANPTR,MDFTAB,
     1KANCNT,KAUX,KDFCNT,IDEFP,KPRCNT,MDFPRE,IPREP,KOVFLP,KSRFCT,KOVCNT,
     2LSCAN,IOVFLO,MAXCAN,IREF,ICANSC,NAMSTA,KANGO,LASPTP,ISUB,
     3LCOMP,LGEREC,IRECN,JREC,JNUM,KANCUR,KANCOT,KDFENT,KANPAR,LGELOC,
     4IDTMOV,ISPPRG,INDEXS,KPTP,KPTPCT,KLASTP,KLASCT,KPRNT
      COMMON/ADEBUG/IDEBUG(3),KCANDF
       EQUIVALENCE (ERRCOD,IERR(1))
       DATA A1/8HASCALRPT/
C
      I=NAME
C     CHECK STATUS OF VARIABLE SYMBOL
C     AVS2CK SETS NAME TO VST INDEX FOR SUB. AND NON-SUB. VARIABLES
      CALL AVS2CK(KRET)
       JTEMP = 2*NAME - 1
C...     IF DATA TO BE STORED IS AN ERROR CODE, GO TO PUT ERROR CODE
C...     IN VST ENTRY FOR SYMBOL
            IF(A.EQ.ERRCOD) GO TO 22
C...     TEST FOR DEFINED SCALAR VARIABLE
            IF(KRET.EQ.2) GO TO 30
C...     SEE IF SYMBOL IS UNDEFINED IN PASS 2 - YES IF KRET = 7
            IF(KRET.EQ.7) GO TO 20
C     SAVE SYMBOL FOR ERROR DIAGNOSTICS
      ENAME=VST(I)
C...    IGNORE IF ERROR ALREADY DIAGNOSED
      IV = 2*I-1
      IF(IVST(IV+2).EQ.9) GO TO 40
C     VARIABLE IS ILL-DEFINED
    5  JSUBER = 139
      RETURN
C...     SEE IF AVAILABLE SCALAR STORAGE SPACE HAS BEEN EXCEEDED
   20       IF(ICANSC.LT.ICANST) GO TO 25
C...     YES - SET ERROR FLAG
       JSUBER = 139
C...     PUT CODE IN VST ENTRY FOR INCORRECTLY DEFINED
   22  IVST(JTEMP) = 9
       RETURN
C
C...     SET VST REFERENCE TO DEFINED SCALAR VARIABLE
   25  IVST(JTEMP) = 2
C...     PUT SCALAR STORAGE INDEX INTO VST
       IVST(JTEMP+1) = ICANSC
C...     INCREMENT SCALAR STORAGE INDEX FOR NEXT ENTRY
       ICANSC = ICANSC + 1
C
C...     PICK UP INDEX TO SCALAR STORAGE LOCATION
   30  J = IVST(JTEMP+1)
C     STORE SCALAR VALUE IN CANON
      CANON(J)=A
C     IS DEBUG ON
      IF(KDBUG.EQ.0 ) RETURN
       IDEBUG(1) = 8
      IDEBUG( 2)=I
       IDEBUG(3) = J
       CALL ADPRNT(A1)
 40   RETURN
      END

