      SUBROUTINE ASPHER(N)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C               *          *          *          *         *
      IMPLICIT REAL*8(A-H,O-Z)
       DIMENSION DEFANS(82)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/AVST/VST(7200)
      DIMENSION DEFTAB(1000)
      EQUIVALENCE(VST(7200),DEFTAB(1000))
      COMMON/ADFSTO/DEFSTO(85),PARTNO(11)
      EQUIVALENCE(DEFSTO(4),DEFANS(1))
C***********************************************************************
      SQRT(Q) = DSQRT(Q)
      ABS(Q) = DABS(Q)
       GO TO (100,181,184,187,800,600),N
C...
C...  S = SPHERE/XCOORD,YCOORD,ZCOORD, RADIUS VALUE $$
C...
  100 DO 180 K=1,4
  180 DEFANS(K) = DEFTAB(K+1)
      GO TO 540
C
C...     SPHERE/CENTER,PT1,RADIUS,R
C
  181 DO 182 K = 1,3
  182 DEFANS(K) = DEFTAB(K+3)
      DEFANS(4) = DEFTAB(8)
      GO TO 540
C
C...     SPHERE/CENTER,PT1,PT2
C
  184 DO 185 K = 1,3
  185 DEFANS(K) = DEFTAB(K+3)
C
C...  RADIUS = SQRTF((X2-X1)**2 + (Y2-Y1)**2 + (Z2-Z1)**2)
C
      DEFANS(4) = SQRT((DEFTAB(8)-DEFTAB(4))**2 + (DEFTAB(9)-DEFTAB(5))
     1           **2 + (DEFTAB(10)-DEFTAB(6))**2)
      GO TO 540
C
C...     SPHERE/CENTER,PT1,TANTO,PLN1
C
  187 DO 188 K = 1,3
  188 DEFANS(K) = DEFTAB(K+3)
      DEFANS(4) = ABS((DEFTAB(4)*DEFTAB(9) + DEFTAB(5)*DEFTAB(10)
     1           + DEFTAB(6)*DEFTAB(11)) - DEFTAB(12))
      GO TO 540
C
C...     SPHERE/PT1,PT2,PT3,PT4
C
  800 CONTINUE
      DEFTAB(200) = DEFTAB(15)**2+DEFTAB(16)**2+DEFTAB(17)**2
      L =96
      DO 801 K = 3,11,4
      L=L+4
      DEFTAB(L)   = DEFTAB(K) - DEFTAB(15)
      DEFTAB(L+1) = DEFTAB(K+1) - DEFTAB(16)
      DEFTAB(L+2) = DEFTAB(K+2) - DEFTAB(17)
      DEFTAB(L+3) = DEFTAB(K)**2+DEFTAB(K+1)**2+DEFTAB(K+2)**2 -
     1              DEFTAB(200)
  801 CONTINUE
      CALL APLAN (K2)
      IF (JSUBER) 540,802,540
  802 DO 803 K = 3,5
  803 DEFTAB(K) = DEFTAB(K+12)
      DO 804 K = 1,4
  804 DEFTAB(K+49) = DEFANS(K)
      DO 8040 J=1,3
 8040 DEFANS(J)=DEFTAB(J+6)-DEFTAB(J+2)
  805 CALL ADOT(DEFTAB(50),DEFANS(1),DEFTAB(49))
      IF(DEFTAB(49))806,97,806
  806 CALL ASIMEQ
      IF(JSUBER) 540,807,540
  807 DEFTAB(115)=DEFTAB(112)*DEFTAB(15)+DEFTAB(113)*DEFTAB(16) +
     1            DEFTAB(114)*DEFTAB(17) - DEFTAB(200)
      DO 808 K = 1,3
  808 DEFANS(K) = DEFTAB(K+111)/2.0
      A=DEFTAB(112)**2 + DEFTAB(113)**2 + DEFTAB(114)**2-4.0*DEFTAB(115)
      IF(A) 809,97,809
  809 DEFANS(4)=SQRT(A)/2.0
      GO TO 540
C
C...     SPHERE/PT1,A
C
C...  PROCESS  SP6 = SPHERE/POINT,R
 600  DO 605 I = 3,6
 605  DEFANS ( I-2 ) = DEFTAB ( I )
      GO TO 540
C
   97  JSUBER = 1005
C
  540 RETURN
      END

