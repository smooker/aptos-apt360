       SUBROUTINE  SETUPP
C  *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 0 ***
C...
C... THIS SUBROUTINE IS USED TO SET UP THE NECESSARY DATA TO DESCRIBE
C... THE PLOT FRAME AND SCALING EQUATIONS TO BE USED BY THE LOWER LEVEL
C... PLOTTING SUBROUTINES
C********************************************************************
      IMPLICIT REAL*8 (A-H,O-Z)
C***********************************************************************
       DOUBLE PRECISION   APOSTP,ATAPTB
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1 NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
       COMMON/APOSTP/PPNAME(20)
      COMMON/A3FXD1/AMATI1(4,4),AMATI2(4,4),AMATI3(4,4),AMATRX(3,4),
     1AMTR(36),AN1,AN2,ANAME,AX,AX0,AXVEC(3),AY,AY0,CNTM(36),CNTMAT(3,4)
     2,CONT(3),COUNT(3),CSEQNO(1),DELX,DELY,DX,DY,F0,ORIGIN(3),PARRAY
     3(20),PARTNO(12),PNT(3),PPRINT(12),PPT(6),PT0(3),PTT(6),PTU(3),
     4SEQNO(1),SUB(5),SUB4(6),TAPSTO(250),TITL(8),TL,TMATRX(3,4),
     5TNTM(36),TOOLNG,TRAMAT(3,4),VEC(3),WORD,X0,X1,X2,X3,XNEW,
     6Y0,Y1,Y2,Y3,YNEW
      REAL*8 MOTION
      COMMON/A3FXD2/MOTION(8)
      COMMON/A3FXI1/IARROW,I1,I2,ICLWAS,ICOPY,IDPLOT,IDPLSQ,IFIRST,
     1IGODLT,INDN,INSTR1,INSTR2,IND2TB(160),INDOFF,INDTAB(160),
     2INDXNO(3),IPERSP,IPL5AX,IPLOTI,IPLOTX,IPLWAS,IPX,IPY,IRECNI(3),
     3IRECNO,IRECTP,IRET,IRETVR,ISUBSC,ISWMAC,ISWNOC,IT,
     4ITHPNT,ITRAFL,ITRUNC,JARROW,JCLPRT,JCOPY,JPTSW,
     5JSW,JTYPSW,JVECTR,KCLPRT,KCOPY,MAXCOP,MULTAX,
     6NCAMRA,NK,NNTAB,NRECNO,NTAB,NUMWDS,NURCNO,NX,NX0,
     7NX1,NX2,NX4,NX5,NXP,NY,NY0,NY1,NY2,NY4,NY5,NYP,
     8IFALMS,IWARMS,INTSEQ
       REAL*8 NUCLTP
      EQUIVALENCE   (NUCLTP,TAPES2)
C...********************************************************************
C...********************************************************************
C... IS CAMERA ONE      REQUESTED
      IF(NCAMRA-K1)                               9030,18,12
C... IS CAMERA ONE OR   BOTH REQUESTED
   12        IF (NCAMRA -K2)        16,16,19
C...  SET NCAMRA = 35MM.
   16            NCAMRA = 35
          GO TO         19
C...  SET NCAMRA = 9X9 CAMERA.
   18            NCAMRA = K9
C...  SELECT THE CAMERA TO BE USED FOR THIS FRAME.
 19   CALL CMLOAD(NCAMRA)
      CALL CAMRAV(NCAMRA)
C...  GET A CLEAN FRAME TO PLOT ON.
               CALL FRAMEV
C...  PRINT THE PARTNO ON THE PLOT FRAME.
               CALL PRINTV (66,PARTNO,250,1000)
C...  IS PERSPECTIVE IN EFFECT - EQUAL IS NO.
             IF (IPERSP)                          1000 ,   30 , 1000
C...  SET UP GRID ACCORDING TO INPUT DATA OF FRAME SIZE.
   30          DC = 60.0
C... DEFINE GRID SIZE   AND LABELS FOR GRID1V
               CALL DXDYV (1,PT0(IPX),PTU(IPX),DX,N,I,NX,DC,IERR)
C... WAS THERE AN ERROR RETURN
             IF (IERR)                              40 ,   40 , 9000
C... DEFINE GRID SIZE   AND LABELS FOR GRID1V
   40          CALL DXDYV (2,PT0(IPY),PTU(IPY),DY,M,J,NY,DC,IERR)
C... WAS THERE AN ERROR RETURN
             IF (IERR)                              50 ,   50 , 9000
C...  LET GRID1V SET UP AND PLOT THE GRID ACCORDING TO PARAMS FROM DXDYV
   50          CALL GRID1V(2,PT0(IPX),PTU(IPX),PT0(IPY),PTU(IPY),DX,
     1                        DY,-N,-M,-1,-1,4,4)
       GO TO   9999
C...  THIS AREA WILL SET UP PERSPECTIVE TRANSFORMATION EQUATIONS.
 1000  GO TO   3000
C...********************************************************************
C...  SCALE FOR X BETWEEN INPUT DATA AND CRT TUBE.
 3000          CALL XSCALV (PT0(IPX),PTU(IPX),0,0)
C...  SCALE FOR Y BETWEEN INPUT DATA AND CRT TUBE.
               CALL YSCALV (PT0(IPY),PTU(IPY),0,0)
C...  PUT AXIS VECTORS ON PLOT FRAME AT THE ORIGIN OF THE INPUT DATA
              ORIGIN(1) = 0.0
              ORIGIN(2) = 0.0
              ORIGIN(3) = 0.0
               JARROW = K0
               IFIRST = K1
C...  INITIALIZE USING THE ORIGIN.
               CALL PL3AXS (ORIGIN)
C...  PLOT THE X AXIS VECTOR.
               AXVEC(1) = 1.0
               AXVEC(2) = 0.0
               AXVEC(3) = 0.0
               JARROW = K1
               IFIRST = K0
               CALL PL3AXS (AXVEC)
C...  IF THE TRUNC ROUTINE PUT AN ARROW ON THE LINE-THEN BYPASS ARROW.
             IF (ITRUNC)                          3020 , 3020 , 3040
C...  TRUNC DID NOT PLOT ARROW SO DO IT NOW.
 3020          CALL ARROW
C...  BACK TO ORIGIN - SET JARROW SO NO ARROW CAN BE PLOTTED BY TRUNC.
 3040          JARROW = K0
               CALL PL3AXS (ORIGIN)
C...  SET UP THE Y AXIS VECTOR.
               AXVEC(1) = 0.0
               AXVEC(2) = 1.0
               JARROW = K1
C...  PLOT THE Y AXIS
               CALL PL3AXS (AXVEC)
C...  IF THE TRUNC ROUTINE PUT AN ARROW ON THE LINE-THEN BYPASS ARROW.
             IF (ITRUNC)                          3060 , 3060 , 3080
C...  TRUNC DID NOT PLOT ARROW SO DO IT NOW.
 3060          CALL ARROW
C...  BACK TO ORIGIN - SET JARROW SO NO ARROW CAN BE PLOTTED BY TRUNC.
 3080          JARROW = K0
               CALL PL3AXS (ORIGIN)
C...  SET UP THE Z AXIS VECTOR.
               AXVEC(2) = 0.0
               AXVEC(3) = 1.0
               JARROW = K1
C...  PLOT THE Z AXIS.
               CALL PL3AXS (AXVEC)
C...  IF THE TRUNC ROUTINE PUT AN ARROW ON THE LINE-THEN BYPASS ARROW.
             IF (ITRUNC)                          3100 , 3100 , 3120
C...  TRUNC DID NOT PLOT ARROW SO DO IT NOW.
 3100          CALL ARROW
C... PUT A FRAME AROUND THE PICTURE.
C...  PLOT LEFT FRAME EDGE.
 3120          CALL LINEV (0,0,0,1023)
C...  PLOT UPPER FRAME EDGE.
               CALL LINEV (0,1023,1023,1023)
C...  PLOT RIGHT FRAME EDGE.
               CALL LINEV (1023,1023,1023,0)
C...  PLOT BOTTOM FRAME EDGE.
               CALL LINEV (1023,0,0,0)
C...  RETURN TO CALLING ROUTINE - PERSPECTIVE HAS BEEN SET UP.
       GO TO   9999
C...  FRAME SIZE IS LESS THAN ZERO IN WIDTH OR LENGTH OR BOTH.
 9000 WRITE (IOUTAP,9100)SEQNO(1),SEQNO(2),CSEQNO(1),CSEQNO(2)
      GO TO 9900
 9030 WRITE (IOUTAP,9031)
 9031 FORMAT (14H NO CAMRA CARD)
 9900 IPLOTI=K0
 9999  RETURN
C... FORMAT STATEMENTS
 9100 FORMAT(60H-FRAME SIZE IS LESS THAN ZERO IN WIDTH OR LENGTH - CARD
     1NO. A6,A2,20H LAST CALL CARD NO. A6,A2)
       END

