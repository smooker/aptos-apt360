      SUBROUTINE ATRFRM
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
      IMPLICIT REAL*8(A-H,O-Z)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
      COMMON/A2CLS7/PPSEQ1,PPSEQ2,ENAME,EINAME,IEREC,ISN
      COMMON/ADFSTO/DEFSTO(85),PARTNO(11)
       EQUIVALENCE (DEFSTO(1),KSTYP)
C
C     CHECK SURFACE TYPE
      IF(KSTYP-15)30,10,10
 10   WRITE(IOUTAP,20)ENAME,NAMSUB
 20   FORMAT(34H0THIS SURFACE IS NOT TRANSFORMED, A6,2H (I4,1H)/1H )
      RETURN
 30   GOTO(300,100,100,200,200,400,400,200,400,400,500,10,300,400),KSTYP
C     LINES AND PLANES
 100  CALL ATDL
       GO TO 900
C     CIRCLE,CYLINDER,CONE
 200  CALL ATFMVC(K1)
      CALL ATFMVC(K0)
       GO TO 900
C     POINT,SPHERE
 300  CALL ATFMVC(K1)
       GO TO 900
C     QUADRICS
 400  CALL ATFMQD
       GO TO 900
C     VECTORS
 500  CALL ATFMVC(-K1)
C
C...     CALL ROUTINE TO CHECK FOR PROPER NORMALIZATION OF
C...     TRANSFORMED CANONICAL FORM
  900  CALL ACANCK(KSTYP)
C
       RETURN
       END

