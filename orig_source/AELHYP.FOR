      SUBROUTINE AELHYP
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C
C...  CALCULATES GENERAL EQUATION FOR THE ELLIPSE
C...  AND HYPERBOLA. PM IS FLAG = +1 FOR ELLIPSE
C...                              -1 FOR HYPERBOLA
C
      IMPLICIT REAL*8(A-H,O-Z)
       DIMENSION DEFANS(82)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/AVST/VST(7200)
      DIMENSION DEFTAB(1000)
      EQUIVALENCE(VST(7200),DEFTAB(1000))
      COMMON/ADFSTO/DEFSTO(85),PARTNO(11)
      EQUIVALENCE(DEFSTO(4),DEFANS(1))
      COMMON/ADFPRG/DEFPRG(16)
      EQUIVALENCE(PM,DEFPRG(16))
C
C...  DEFTAB(11,12,...,16) = SIN THETA,COS THETA,SIN THETA**2,
C...                         COS THETA**2,B**2,A**2, RESPECTIVELY
C
      DEFTAB(11) = DSIN(DEFTAB(9)/57.29577951289617)
      DEFTAB(12) = DCOS(DEFTAB(9)/57.29577951289617)
      DEFTAB(13) = DEFTAB(11)**2
      DEFTAB(14) = DEFTAB(12)**2
      DEFTAB(15) = DEFTAB(8)**2
      DEFTAB(16) = DEFTAB(7)**2
      DEFANS(1) = DEFTAB(15)*DEFTAB(14) + PM*DEFTAB(16)*DEFTAB(13)
      DEFANS(2) = DEFTAB(15)*DEFTAB(13) + PM*DEFTAB(16)*DEFTAB(14)
C
C...  DEFANS(3) = 0.
C
      DEFANS(4) = DEFTAB(15)*(DEFTAB(4)*DEFTAB(12)+DEFTAB(5)*DEFTAB(11))
     1            **2 + PM*DEFTAB(16)*(DEFTAB(4)*DEFTAB(11) - DEFTAB(5)
     2            *DEFTAB(12))**2 - DEFTAB(15)*DEFTAB(16)
C
C...  DEFANS(5) = 0.
C...  DEFANS(6) = 0.
C...  DEFANS(7) = 2H
C
      DEFANS(7) = DEFTAB(11)*DEFTAB(12)*(DEFTAB(15) - PM*DEFTAB(16))
C
C...  DEFANS(8) = 2P
C
      DEFANS(8) = DEFTAB(5)*DEFTAB(11)*DEFTAB(12)*(PM*DEFTAB(16)-DEFTAB
     1          (15)) - DEFTAB(4)*(DEFTAB(15)*DEFTAB(14) + PM*DEFTAB
     2            (16)*DEFTAB(13))
C
C...  DEFANS(9) = 2Q
C
      DEFANS(9) = DEFTAB(4)*DEFTAB(11)*DEFTAB(12)*(PM*DEFTAB(16)-DEFTAB
     1            (15)) - DEFTAB(5)*(DEFTAB(15)*DEFTAB(13) + PM*DEFTAB
     2            (16)*DEFTAB(14))
C
C...  DEFANS(10) = 0.
C
      RETURN
      END

