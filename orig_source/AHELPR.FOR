      SUBROUTINE AHELPR(INILL)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 2 ***
      IMPLICIT REAL*8(A-H,O-Z)
       REAL*8 NAME,KRFSYS
       INTEGER DEBUG,SUM
C     THIS ROUTINE REMOVES IMPLICIT NESTED PLANE DEFINITIONS FROM THE
C     ZSURF AND PSIS STATEMENTS
C
      COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
       COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
      COMMON/ADATA1/ANODEF,BLANX,BLANKS,SYN,TLAXIS,DUMMY,PLENT,LOOPST
     1 ,LOOPND,MACRO,NTRMAC,NCALL,LAPTH,JAPTH,IPLUS,NCOMMA,IFF,IC(10),
     2 LLASS
C
C...     BRANCH ON TYPE OF FIRST ENTRY FOLLOWING SLASH
            IF(ICLASS(INILL+2).EQ.6) GO TO 2605
            IF(ICLASS(INILL+2).EQ.3) GO TO 2602
            IF(ICLASS(INILL+2).EQ.1) GO TO 2601
            IF(ICLASS(INILL+2).EQ.5) GO TO 2602
      JSUBER = 576
      GOTO 2605
C...  VARIABLE SYMBOL - MAY BE SURFACE NAME OR SCALAR
 2601 NAME = ELMENT(INILL+2)
      CALL AVS1CK(J)
      IF(J.EQ.5) GO TO 2602
      IF(J.NE.8) GO TO 2605
C...  SCALAR - MUST BE IMPLICIT PLANE DEFINITION
 2602 NMOVE = JLMENT - INILL
C...  SETUP PSUEDO NESTED DEFN.
      DO 2603 IP = 1,NMOVE
       KP = JLMENT + 2 + IP
      JP = INILL + IP
      ELMENT(KP)=ELMENT(JP)
 2603 ICLASS(KP)=ICLASS(JP)
       ISTARP = JLMENT + 2
       IENDP = JLMENT + 3 + NMOVE
      ELMENT(JLMENT+2) = PLENT
      ICLASS(JLMENT+2) = LLASS
       ICLASS(IENDP) = JAPTH
C...  PROCESS NESTED DEFN.
      CALL ADFPRO
C...  ADJUST ELMENT TABLE POINTERS FOR NESTED DEFN.
      ELMENT(INILL+2) = ELMENT(JLMENT+1)
       ICLASS(INILL+2) = 6
       JLMENT = INILL + 2
       ISTARP = INILL
       IENDP = JLMENT
 2605 RETURN
      END

