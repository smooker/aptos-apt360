       SUBROUTINE AEXPRS
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C..
C
C THIS SUBROUTINE CONTROLS THE OUTPUT OF A CLASS 12 PTPP RECORD.SJD
C....
C
      IMPLICIT REAL*8(A-H,O-Z)
      REAL*8 NAME,KRFSYS
      INTEGER DEBUG,SUM
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,
     1LOOP,IFINI
      COMMON/ASCALR/SCALR(180),ISCWS,NSURF,LOCTEM,IARGTP
      COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
      COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
      DIMENSION IPT(600)
      EQUIVALENCE (PT(1),IPT(1))
C...
C
C..SET APTLOD  PICK-UP INDEX TO THE FIRST ENTRY TO BE PROCESSED.
      ISTARP = ISTARP + 1
C.. SET PTPP TRANSFER FLAG TO NORMAL MODE.
      IT = 5
C.. TRANSLATE AN ICLASS ENTRY INTO THE DESIRED PTPP CODED ENTRIES.
   10 CALL APTLOD
      IF ( JSUBER.NE.0 ) GO TO 130
C... HAVE WE FOUND THE END OF THE NEST.
      IF ( ISTARP.GE.IENDP ) GO TO 20
C... NOT END OF NEST, IS THERE AN OVERFLOW OF PT BUFFER.
            IF(INPTP.GE.298) GO TO 80
C... A.O.K.    TRANSLATE NEXT ICLASS ENTRY
      GO TO 10
C..
C...   END OF NEST IS FOUND.BRANCH ON JMODE SETTING,THAT IS 'IT'.
   20 GOTO ( 60,60,60,998,70 ) ,IT
C..
C...     OUTPUT NUMBER OF WORDS IN PTPP RECORD, EXCLUDING FIRST ONE
   30 IPT(2) = N
C...
   40 JMODE = IT
      INPTP = INPTP - 1
      CALL APTPUT
      IF (JSUBER.NE.0) GO TO 130
      IF ( IT.GE.3 ) GO TO 998
C..
C.. PREVIOUS MODE SETIING WAS 'OUTPUT 1ST PORTION'OR ' CONT. MODE'
C..       SET 'IT' TO CONT. MODE.
C.. THIS IS CONTINUATION MODE. TRANS. REMAINING ICLASS ENTRIES.
   50 IT = 2
      INPTP = 1
      GO TO 10
C..
C..  END OF NEST ENCOUNTERED WHILE  CONTINUATION OF PT BUFFER PREVAILS.
   60 IT = 3
       NW = NW + INPTP - 1
      GO TO 40
C..
C.. END OF NEST IN NORMAL MODE.
C..  CALCULATE LENGTH OF THIS PTPP RECORD.
   70 N = INPTP - 2
      GO TO 30
C..
C..
C.. OVERFLO OF PT BUFFER, BRANCH ON 'IT' SETTING.
   80  GO TO (100,105,110,110,90),IT
C..
C..  PREVIOUS MODE SETTING WAS 'NORMAL'. SET 'IT' TO OUTPUT 1ST PORTION.
   90 IT = 1
C...     INITIALIZE COUNT OF WORDS IN PTPP RECORD TO EXCLUDE FIRST WORD
       NW = INPTP - 2
       GO TO 40
C..
C.. SET 'IT' TO CONTINUATION MODE AND OUTPUT PT BUFFER.
  100 IT = 2
  105  NW = NW + INPTP - 1
      GO TO 40
C..
C.. IMPOSSIBLE TO GET THIS ERROR SETTING----BUT JUST IN CASE..
  110 JSUBER = 6128
C..
C..
C.. ERASE PTPP TABLE ENTRIES FOR THIS ERROR RECORD.
C...    THAT IS, IF THERE WAS A CONTINUATION MODE PREVAILING.
 130  IF (IT.EQ.5) GO TO 998
      IT = 4
      GO TO 40
C...
  998 RETURN
      END

