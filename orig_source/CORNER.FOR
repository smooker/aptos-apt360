C
      SUBROUTINE CORNER
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C********************************************************************
C...    CORNER CALCULATES CUTTER POSITIONS FOR WCORN
C...    ITERATIONS.
      IMPLICIT REAL*8 (A-H,O-Z)
C***********************************************************************
       DOUBLE PRECISION   APOSTP,ATAPTB
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1 NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
       COMMON/APOSTP/PPNAME(20)
      COMMON/A3FXD1/AMATI1(4,4),AMATI2(4,4),AMATI3(4,4),AMATRX(3,4),
     1AMTR(36),AN1,AN2,ANAME,AX,AX0,AXVEC(3),AY,AY0,CNTM(36),CNTMAT(3,4)
     2,CONT(3),COUNT(3),CSEQNO(1),DELX,DELY,DX,DY,F0,ORIGIN(3),PARRAY
     3(20),PARTNO(12),PNT(3),PPRINT(12),PPT(6),PT0(3),PTT(6),PTU(3),
     4SEQNO(1),SUB(5),SUB4(6),TAPSTO(250),TITL(8),TL,TMATRX(3,4),
     5TNTM(36),TOOLNG,TRAMAT(3,4),VEC(3),WORD,X0,X1,X2,X3,XNEW,
     6Y0,Y1,Y2,Y3,YNEW
       DIMENSION  IRR(1),ARR(1)
       EQUIVALENCE(IARROW,IRR(1))
       EQUIVALENCE(AMATI1(1,1),ARR(1))
      REAL*8 MOTION
      COMMON/A3FXD2/MOTION(8)
      COMMON/A3FXI1/IARROW,I1,I2,ICLWAS,ICOPY,IDPLOT,IDPLSQ,IFIRST,
     1IGODLT,INDN,INSTR1,INSTR2,IND2TB(160),INDOFF,INDTAB(160),
     2INDXNO(3),IPERSP,IPL5AX,IPLOTI,IPLOTX,IPLWAS,IPX,IPY,IRECNI(3),
     3IRECNO,IRECTP,IRET,IRETVR,ISUBSC,ISWMAC,ISWNOC,IT,
     4ITHPNT,ITRAFL,ITRUNC,JARROW,JCLPRT,JCOPY,JPTSW,
     5JSW,JTYPSW,JVECTR,KCLPRT,KCOPY,MAXCOP,MULTAX,
     6NCAMRA,NK,NNTAB,NRECNO,NTAB,NUMWDS,NURCNO,NX,NX0,
     7NX1,NX2,NX4,NX5,NXP,NY,NY0,NY1,NY2,NY4,NY5,NYP,
     8IFALMS,IWARMS,INTSEQ
       REAL*8 NUCLTP
      EQUIVALENCE   (NUCLTP,TAPES2)
       EQUIVALENCE(ITRCUT,LCLPRT)
      REAL*8 A5AXIS
      COMMON/A5AXIS/
     1ZP1   ,YP1   ,XP1   ,ZP2   ,YP2   ,XP2   ,ZP3   ,YP3   ,
     2XP3   ,ZP1B  ,YP1B  ,XP1B  ,ZP1F  ,YP1F  ,XP1F  ,ZP3F  ,
     3YP3F  ,XP3F  ,ZP3B  ,YP3B  ,XP3B  ,ZLM   ,YLM   ,XLM   ,
     4ZTA1  ,YTA1  ,XTA1  ,ZTA2  ,YTA2  ,XTA2  ,ZTA3  ,YTA3  ,
     5XTA3  ,ZDTA  ,YDTA  ,XDTA  ,ZTA2I ,YTA2I ,XTA2I ,ZCV1  ,
     6YCV1  ,XCV1  ,ZCV3  ,YCV3  ,XCV3  ,ZCV1P ,YCV1P ,XCV1P ,
     7ZCV3P ,YCV3P ,XCV3P ,ZCV1I ,YCV1I ,XCV1I ,ZCV3I ,YCV3I ,
     8XCV3I ,ZDCV  ,YDCV  ,XDCV  ,ZCP   ,YCP   ,XCP   ,ZCP1B ,
     9YCP1B ,XCP1B ,ZCP1F ,YCP1F ,XCP1F ,ZCP3B ,YCP3B ,XCP3B
      REAL*8 B5AXIS
      COMMON/B5AXIS/
     1ZCP3F ,YCP3F ,XCP3F ,ZDP   ,YDP   ,XDP   ,ZD01  ,YD01  ,
     2XD01  ,ZD03  ,YD03  ,XD03  ,ZPL1  ,YPL1  ,XPL1  ,ZPL3  ,
     3YPL3  ,XPL3  ,WCORN5,WCORN7,WCORN8,WTLXS6,TLNTH1,TLNTH2,
     4AI    ,ALPHA ,CSIGMA,CPHI  ,SH    ,CLAMDA,S1    ,S2    ,
     5S3    ,TS    ,GAMMA ,BETA  ,DELTA ,WCORN9,THETA ,S     ,
     6ZP2I  ,YP2I  ,XP2I
      REAL*4 A5FXIS
      COMMON/A5FXIS/
     1IP1   ,IP1I  ,IP2   ,IP2I  ,IP3   ,IP3I  ,IP1B  ,IP1BI ,
     2IP1F  ,IP1FI ,IP3F  ,IP3FI ,IP3B  ,IP3BI ,ILM   ,ILMI  ,IPS   ,
     3ICORN1,ICORN9,IFLAG ,IFLAG1,ICM   ,ICMI  ,II    ,IIII  ,IFG   ,
     4ITCONT,ITC1
      REAL*8 C5AXIS
      COMMON/C5AXIS/
     1Z1                  ,Z2                  ,ZSTART,YSTART,
     2XSTART,ZD    ,YD    ,XD    ,ZCV   ,YCV   ,XCV   ,ZDO   ,
     3YDO   ,XDO   ,ZCC   ,YCC   ,XCC   ,ZUN   ,YUN   ,XUN   ,
     4ZTR   ,YTR   ,XTR   ,ZTA   ,YTA   ,XTA   ,Z     ,STANG ,
     5ENDANG,DANG  ,CANG  ,DLNGTH,TLNGTH,CUTTER,TEST  ,CRADUS
      REAL*4 C5FXIS
      COMMON/C5FXIS/
     1IS    ,IR    ,IL    ,IE    ,JSUBER,IABOVE
C********************************************************************
   70 DELTA = 1.5707963 - ACOS(ZTA2I)
      CDELTA =DCOS(DELTA)
      SDELTA =DSIN(DELTA)
      TEST = (1.0/SDELTA)*(CRADUS*(1.0-CDELTA-SDELTA)+CUTTER*CDELTA)
      IF(IABOVE)     74,  76, 74
   74 IF((CANG * ZUN) .GE. 0.D0) GO TO 76
      TEST = - TEST
   76 XTA = XTA2I
      YTA = YTA2I
      ZTA = ZTA2I
      XTA2I = TEST*XTA2I
      YTA2I = TEST*YTA2I
      ZTA2I = TEST*ZTA2I
      XCC = XP2I      + XTA2I
      YCC = YP2I      + YTA2I
      ZCC = ZP2I      + ZTA2I
   80 RETURN
      END

