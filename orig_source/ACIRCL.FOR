      SUBROUTINE ACIRCL(N)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C               *          *          *          *         *
      IMPLICIT REAL*8(A-H,O-Z)
       DIMENSION DEFANS(82)
       DIMENSION IDFTAB(2000)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/AVST/VST(7200)
      DIMENSION DEFTAB(1000)
      EQUIVALENCE(VST(7200),DEFTAB(1000))
       EQUIVALENCE (DEFTAB(1),IDFTAB(1))
      COMMON/ADFSTO/DEFSTO(85),PARTNO(11)
      EQUIVALENCE(DEFSTO(4),DEFANS(1))
      COMMON/ADFPRG/DEFPRG(16)
      EQUIVALENCE(ZSURR,DEFPRG(16))
C***********************************************************************
      GO TO (100,200,102,400,106,109,163,112,831,1000,1100,901),N
C...
C...  C1 = CIRCLE/XCOORD,YCOORD,ZCOORD,RADIUS OF CIRCLE $$
C...
  100 DEFANS(1) = DEFTAB(2)
      DEFANS(2)=DEFTAB(3)
C...  DEFANS(3)= 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
      DEFANS(7) = DEFTAB(5)
      GO TO 1240
C
C...     CIRCLE/X,Y,R
C
  200 DEFANS(1) = DEFTAB(2)
      DEFANS(2) = DEFTAB(3)
C
C...     DEFANS(3) = 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
      DEFANS(7) = DEFTAB(4)
      GO TO 1240
C
C...     CIRCLE/CENTER,PT1,RADIUS,R
C
  102 DEFANS(1)=DEFTAB(4)
      DEFANS(2)=DEFTAB(5)
C...  DEFANS(3) = 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
      DEFANS(7) = DEFTAB(8)
      GO TO 1240
C
C...     CIRCLE/CENTER,X,Y,Z,RADIUS,R
C
  400 DEFANS(1) = DEFTAB(3)
      DEFANS(2)=DEFTAB(4)
C...  DEFANS(3) = 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
      DEFANS(7) = DEFTAB(7)
      GO TO 1240
C
C...     CIRCLE/CENTER,PT1,TANTO,LN1
C
  106 DEFANS(1)=DEFTAB(4)
      DEFANS(2)=DEFTAB(5)
C...  DEFANS(3) = 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
       DEFANS(7) = DABS((DEFTAB(4)*DEFTAB(9)+DEFTAB(5)*DEFTAB(10))
     1             -DEFTAB(12))
      GO TO 1240
C
C...     CIRCLE/CENTER,PT1,PT2
C
  109 DEFANS(1)=DEFTAB(4)
      DEFANS(2)=DEFTAB(5)
C...  DEFANS(3) = 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
C
C...  RADIUS = SQRT((X2-X1)**2 + (Y2-Y1)**2)
C
       DEFANS(7) = DSQRT((DEFTAB(8)-DEFTAB(4))**2 + (DEFTAB(9)-
     1             DEFTAB(5))**2)
      GO TO 1240
C
C...     CIRCLE/PT1,LARGE OR SMALL,TANTO,CIR1
C
  112       IF(IDFTAB(14)-26)  113, 115, 98
  113       IF(IDFTAB(14)-7)  98, 116, 98
  115 ASSIGN 119 TO N
      GO TO 120
  116 ASSIGN 118 TO N
  120  DEFTAB(17) = DSQRT((DEFTAB(10)-DEFTAB(4))**2 + (DEFTAB(11)-
     1             DEFTAB(5))**2)
      DEFANS(1)=DEFTAB(4)
      DEFANS(2)=DEFTAB(5)
C...  DEFANS(3) = 0.
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
       DEFANS(6) = 1.0
      GO TO N,(118,119)
  118 DEFANS(7) = DEFTAB(16) + DEFTAB(17)
      GO TO 1240
  119  DEFANS(7) = DABS(DEFTAB(16) - DEFTAB(17))
      GO TO 1240
C
C...     CIRCLE/TANTO,LN1,X- OR YLARGE OR SMALL,PT1,RADIUS,R
C
  831 DEFANS(7)=DEFTAB(14)
      DEFTAB(40)=DEFTAB(10)*DEFTAB(4)+DEFTAB(11)*DEFTAB(5)
            IF(DABS(DEFTAB(40)-DEFTAB(7))-.00001)  832, 832, 833
  832       IF(IDFTAB(16)-31)  98, 8321, 8322
 8321 IF (DEFTAB(4)) 834,97,835
 8322       IF(IDFTAB(16)-32)  97, 8323, 8324
 8323 IF (DEFTAB(4)) 835,97,834
 8324       IF(IDFTAB(16)-35)  98, 8325, 8326
 8325 IF (DEFTAB(5)) 834,97,835
 8326       IF(IDFTAB(16)-36)  98, 8327, 98
 8327 IF(DEFTAB(5)) 835,97,834
  833 IF (DEFTAB(40)-DEFTAB(7)) 834,97,835
  834 DEFTAB(7)=DEFTAB(7)-DEFTAB(14)
      GO TO 837
  835 DEFTAB(7)=DEFTAB(7)+DEFTAB(14)
  837 DEFTAB(2)=DEFTAB(8)
      DEFTAB(8)=DEFTAB(7)
      DEFTAB(7)=DEFTAB(6)
      DEFTAB(6)=DEFTAB(5)
      DEFTAB(5)=DEFTAB(4 )
      DEFTAB(4)=DEFTAB(3)
      DEFTAB(13)=0.0
      DEFTAB(14)=0.0
      DEFTAB(15)=1.0
      DEFTAB(16)=DEFANS(7)
       CALL APOINT(4)
      DEFANS(3)=0.0
C...  DEFANS(4)=0.
C...  DEFANS(5)=0.
  838 DEFANS(6)=1.0
      GO TO 1240
C
C...     CIRCLE/X- OR YLARGE OR SMALL,LN1,X- OR YLARGE OR   $
C...            SMALL,LN2,RADIUS,R
C
 1000 ZSURR=1.0
      K=4
  821  IK = 2*K - 5
            IF(IDFTAB(IK+1)-32)  811, 814, 812
  811       IF(IDFTAB(IK+1)-31)  98, 817, 817
  812       IF(IDFTAB(IK+1)-35)  98, 818, 813
  813       IF(IDFTAB(IK+1)-36)  98, 819, 98
  814 IF (DEFTAB(K)) 815,97,816
  815 DEFTAB(K+3) = DEFTAB(K+3) + DEFTAB(15)
      GO TO 820
  816 DEFTAB(K+3) = DEFTAB(K+3) - DEFTAB(15)
      GO TO 820
  817 IF (DEFTAB(K)) 816,97,815
  818 IF (DEFTAB(K+1)) 816,97,815
  819 IF(DEFTAB(K+1)) 815,97,816
  820 IF(ZSURR) 823,823,822
  822 ZSURR=0.0
      K = K+6
      GO TO 821
  823 ZSURR=DEFTAB(15)
      DO 824 J=8,12
  824 DEFTAB(J)=DEFTAB(J+1)
       CALL APOINT(3)
C
C...     DEFPRE ROUTINE PONT03 WILL STORE THE CIRCLE CENTER POINT
C...  DEFANS(1) = X
C...  DEFANS(2) = Y
      DEFANS(3)=0.0
C
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
      DEFANS(7)=ZSURR
      GO TO 1240
C
C...     CIRCLE/PT1,PT2,PT3
C
  163 L = 96
      DO 164 K = 3,11,4
      L=L+4
      DEFTAB(L)    = DEFTAB(K)
      DEFTAB(L+1) = DEFTAB(K+1)
      DEFTAB(L+2) = 1.0
  164 DEFTAB(L+3) = DEFTAB(K)**2 + DEFTAB(K+1)**2
      CALL ASIMEQ
      IF(JSUBER) 1240,166,1240
  166 DEFANS(1) = DEFTAB(112)/2.0
      DEFANS(2) = DEFTAB(113)/2.0
C...  DEFANS(3) = 0.
C
C...  DEFANS(4) = 0.
C...  DEFANS(5) = 0.
C
      DEFANS(6) = 1.0
       DEFANS(7) = DSQRT(DEFTAB(112)**2+DEFTAB(113)**2 + 4.0*
     1             DEFTAB(114))/2.0
      GO TO 1240
C
C...     CIRCLE/X- OR YLARGE OR SMALL,IN OR OUT,CIR1,   $
C...            IN OR OUT,CIR2,RADIUS,R
C
 1100 DO 40 J=1,10,9
       IK = 2*J + 3
            IF(IDFTAB(IK+1)-48)  98, 20, 10
   10       IF(IDFTAB(IK+1)-49)  98, 30, 98
   20  DEFTAB(J+10) = DABS(DEFTAB(J+10)-DEFTAB(22))
   25 GO TO 40
   30 DEFTAB(J+10)=DEFTAB(J+10)+DEFTAB(22)
   40 CONTINUE
      DO 50 J=1,8
      DEFTAB(J+11)=DEFTAB(J+12)
   50 CONTINUE
C...  DEFANS(3)=0
C...  DEFANS(4)=0
C...  DEFANS(5)=0
      DEFANS(6)=1.0
      DEFANS(7)=DEFTAB(22)
       CALL APOINT(5)
      GO TO 1240
C
C...     CIRCLE/X- OR YLARGE OR SMALL,LN1,X- OR YLARGE OR   $
C...            SMALL,IN OR OUT,CIR1,RADIUS,R
C
  901       IF(IDFTAB(18)-48)  98, 903, 902
  902       IF(IDFTAB(18)-49)  98, 904, 98
  903 D=-1.0
      GO TO 905
  904 D=1.0
  905  DEFTAB(17) = DABS(DEFTAB(17)+D*DEFTAB(19))
            IF(IDFTAB(4)-31)  98, 909, 906
  906       IF(IDFTAB(4)-32)  98, 910, 907
  907       IF(IDFTAB(4)-35)  98, 911, 908
  908       IF(IDFTAB(4)-36)  98, 912, 98
  909 IF(DEFTAB(4)) 914,97,913
  910 IF(DEFTAB(4)) 913,97,914
  911 IF(DEFTAB(5)) 914,97,913
  912 IF(DEFTAB(5)) 913,97,914
  913 DEFTAB(7)=DEFTAB(7)+DEFTAB(19)
      GO TO 915
  914 DEFTAB(7)=DEFTAB(7)-DEFTAB(19)
  915 DO 918 K=1,8
  918 DEFTAB(K+8)=DEFTAB(K+9)
      DEFTAB(2)=DEFTAB(8)
      K=7
      DO 919 J=1,4
      DEFTAB(K+1)=DEFTAB(K)
  919 K=K-1
      DEFANS(6)=1.0
      DEFANS(7)=DEFTAB(19)
       CALL APOINT(4)
      DEFANS(3)=0.0
      GO TO 1240
C
   97  JSUBER = 1005
      GO TO 1240
   98  JSUBER = 1003
C
 1240 RETURN
      END

