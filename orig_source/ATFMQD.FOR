      SUBROUTINE ATFMQD
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
      IMPLICIT REAL*8(A-H,O-Z)
       COMMON /ATMATY/XMAT4(16),XMAT3(16),XMAT2(16),XMAT1(16),TMATX(16)
      COMMON/ADFSTO/DEFSTO(85),PARTNO(11)
      XMAT1(1) = DEFSTO(4)
      XMAT1( 2)=DEFSTO(10)
      XMAT1( 3)=DEFSTO(9)
      XMAT1( 4)=DEFSTO(11)
      XMAT1( 5)=DEFSTO(10)
      XMAT1( 6)=DEFSTO(5)
      XMAT1( 7)=DEFSTO(8)
      XMAT1( 8)=DEFSTO(12)
      XMAT1( 9)=DEFSTO(9)
      XMAT1(10)=DEFSTO(8)
      XMAT1(11)=DEFSTO(6)
      XMAT1(12)=DEFSTO(13)
      XMAT1(13)=DEFSTO(11)
      XMAT1(14)=DEFSTO(12)
      XMAT1(15)=DEFSTO(13)
      XMAT1(16)=DEFSTO(7)
      CALL AINVRT
      XMAT2(13)=0.
      XMAT2(14)=0.
      XMAT2(15)=0.
      XMAT2(16)=1.
       CALL AMATM(4)
       CALL ATRPOS(4)
       DO 10  J = 1,16
 10   XMAT2(J)=XMAT3(J)
       CALL AMATM(4)
      DEFSTO( 4)=XMAT3(1)
      DEFSTO( 5)=XMAT3(6)
      DEFSTO( 6)=XMAT3(11)
      DEFSTO( 7)=XMAT3(16)
      DEFSTO( 8)=XMAT3(7)
      DEFSTO( 9)=XMAT3(3)
      DEFSTO(10)=XMAT3(2)
      DEFSTO(11)=XMAT3(4)
      DEFSTO(12)=XMAT3(8)
      DEFSTO(13)=XMAT3(12)
       XMAT2(13) = 0.0
       XMAT2(14) = 0.0
       XMAT2(15) = 0.0
       XMAT2(16) = 1.0
       RETURN
       END

