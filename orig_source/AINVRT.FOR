      SUBROUTINE AINVRT
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4,MODIFICATION 4 ***
      IMPLICIT REAL*8(A-H,O-Z)
       COMMON /ATMATY/XMAT4(16),XMAT3(16),XMAT2(16),XMAT1(16),TMATX(16)
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
      XMAT2(1)=TMATX(1)
      XMAT2(2)=TMATX(5)
      XMAT2(3)=TMATX(9)
      XMAT2(5)=TMATX(2)
      XMAT2(6)=TMATX(6)
      XMAT2(7)=TMATX(10)
      XMAT2(9)=TMATX(3)
      XMAT2(10)=TMATX(7)
      XMAT2(11)=TMATX(11)
   10 K=K0
   11 DO 13 J=K4,12,4
   12 K=K+K1
   13 XMAT2(J)=-(TMATX(K)*TMATX(4)+TMATX(K+4)*TMATX(8)+TMATX(K+8)*
     1TMATX(12))
      DET = TMATX(1)*((TMATX(6)*TMATX(11))-(TMATX(10)*TMATX(7)))
     C     -TMATX(2)*((TMATX(5)*TMATX(11))-(TMATX(7)*TMATX(9)))
     C     +TMATX(3)*((TMATX(5)*TMATX(10))-(TMATX(6) *TMATX(9)))
      DET = DABS(DET)
      IF(DABS(DET-1.D0).LE.10.D-10) GO TO 16
      IF(DET.LE.10.D-10) GO TO 15
      DET = DET**(2.D0/3.D0)
      DO 14 J=1,12
   14 XMAT2(J) = XMAT2(J)/DET
         DET=DSQRT(DET)
      DO 144 J=4,12,4
  144 XMAT2(J)=XMAT2(J)/DET
      GO TO 16
   15 WRITE(IOUTAP,100)
  100 FORMAT('0','** WARNING - ATTEMPTING TO APPLY MATRIX WITH ZERO SCAL
     1E FACTOR - IMPROPER RESULTS **')
   16 RETURN
      END

