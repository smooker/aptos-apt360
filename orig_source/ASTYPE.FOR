      INTEGER FUNCTION ASTYPE(INDXPT)
      IMPLICIT REAL*8(A-H,O-Z)
       DIMENSION PTPP(7200),CANON(7200)
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/AVST/VST(7200)
      EQUIVALENCE(VST(1),PTPP(1),CANON(1))
      INTEGER AMDTOA,AEXTRA,AMATOD,AEXCH,AEXTRD
C**** THIS IS A FUNCTION SUBROUTINE WHICH EXAMINES THE PTPP ENTRY FOR A
C     SURFACE TYPE. IF ONE EXISTS IT ISPLACED IN THE CALLING VARIABLE
C     LOCATION.  THE INPUT IS THE PTPP AND THE CALLING SEQUENCE.
C     I=ASTYPE(INDXPT)
C     IF NO SURFACE TYPE EXISTS I IS SET TO ZERO.
C     GET HIGH ORDER 4 BYTES OF PTPP(INDXPT).
      IJ=AMDTOA(PTPP(INDXPT),K4)
      IF(IJ.EQ.K5)GO TO 10
      IF(IJ.EQ.K4)GO TO 20
C     PTPP DOES NOT CONTAIN EXPECTED SURFACE TYPE.
      ASTYPE=K0
      RETURN
C  10 EXPECTED SURFACE TYPE IS IN 4 HIGH ORDER BYTES OF PTPP(INDXPT+1)
   10 ASTYPE=AMDTOA(PTPP(INDXPT+1),K4)
      RETURN
C  20 GET 4 LOW ORDER BYTES OF PTPP(INDXPT)
   20 JK=AEXTRA(PTPP(INDXPT),K4)
      IF(JK.LT.K2)GO TO 10
C     EXPECTED SURFACE TYPE IN 4 LOW ORDER BYTES OF PTPP(INDXPT+2)
      ASTYPE=AEXTRA(PTPP(INDXPT+2),K4)
      RETURN
      END

