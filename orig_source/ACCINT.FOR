      SUBROUTINE ACCINT(CF1,CF2,PT1,PT2,    EPS)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 1 ***
      IMPLICIT REAL*8 (A-H,O-Z)
C     SPECIAL COMMON FOR 2 DIMENSIONAL PACKAGE-- USES PROTAPE BUFFER
C     READ AREA WHICH IS AVAILABLE AT ARLM2 TIME AS SCRATCH
C***
C     NOTE... VARIABLES IER,VTEM,VNUL ARE NOT THE SAME AS IN THE MAIN
C     STREAM ARITHMETIC ELEMENT
C     ALSO EX,EY,EZ,VNUL
      COMMON/A2CMMN/DUMMY(1308) ,CSCF(3) ,DSCF(3) ,CFTEM(3) ,VTEM(3) ,
     1PTEM1(3)  ,PTEM2(3)  ,PT(3,6)   ,DOT(6)    ,FPNT(3)   ,TE2D(3)   ,
     2TI2D(3)   ,CR        ,THDS      ,THCS      ,TAUDS     ,TAUCS     ,
     3PERCEN    ,ANS       ,RES       ,PNTTAN(3) ,EX(3)     ,EY(3)     ,
     4EZ(3)     ,VNUL(3)   ,
     5ICSCF     ,IDSCF     ,ITOPT     ,N         ,IDONE     ,NREV      ,
     6ITFAR     ,ITC       ,IOC       ,IPC       ,INTP      ,IER       ,
     7NINT      ,ICASE     ,ITAN
      COMMON/A2DYDP/ KDYNFQ(12), NKFQ
      COMMON/A2FPC / Q15X01,QP9X01    ,QP6X01    ,QP5X01    ,QP4X01    ,
     1QP0001    ,QP001     ,QP01      ,QP1       ,Q1P       ,Q10P      ,
     2Q1000P    ,Q1PE5     ,Q1PE6     ,Q1PE10    ,Q1PE20    ,Q1PE30    ,
     3Q1PE36    ,Q1PE38    ,QP8X01    ,QP7X01    ,
     4QP4X09    ,QP9       ,QP99      ,QP995     ,QP997     ,QP999     ,
     5QP9999    ,QP4X95    ,QP5X95    ,QP6X9     ,QP7X9     ,
     6QP6X05    ,QP5X05    ,QP4X05    ,QP0005    ,QP005     ,QP05      ,
     7QP5       ,Q5P       ,                                 Q4X045    ,
     8QP0002    ,QP0047    ,QP017     ,Q1RAD     ,QP0349    ,QP125     ,
     9QP6       ,QP2       ,QP2499    ,QP25      ,QP3
      COMMON/A2FPC / QP7   ,QP75      ,QP8       ,QP866     ,Q1P01     ,
     1Q1P1      ,Q1P2      ,Q1P25     ,Q1P5      ,Q2P       ,Q2P5      ,
     2Q3P       ,Q3P5      ,Q4P       ,Q8P       ,Q11P      ,Q45P      ,
     3Q90P      ,Q130P     ,Q4500P    ,Q9000P    ,QP02      ,QNUL      ,
     4QPIE       ,QFIL(9)
C
      DIMENSION CF1(1),CF2(1),PT1(1),PT2(1)
C
C      INTERSECTS TWO CIRCLES
C      CF1 = CANONICAL FORM OF FIRST
C      CF2 = CANONICAL FORM OF SECOND
C      PT1 = FORST ANSWER POINT
C      PT2 = SECOND ANS WR POINT
C      IER = 0,1,2    NUMBER OF INTERSECTIONS
C      EPS = TOLERANCE
C
C      COMPUTE DISTANCE BETWEEN CENTERS
CA
      CALL AVSUB(CF1,CF2,VTEM)
      VTEM(3) = QNUL
C      ZERO OUT NON SIGNIVICANT VALUE
      CALL AVLENG(VTEM,ANS)
      IF(ANS.LT.QP4X01) CALL AERR(717)
C
C      SEE IF NO INTERSECTION
C
      IER = 2
      IF((ANS+CF1(3)).LT.(CF2(3)-EPS))  IER = 0
      IF((ANS+CF2(3)).LT.(CF1(3)-EPS))  IER = 0
      IF((ANS-EPS).GT.(CF1(3)+CF2(3)))  IER = 0
      IF(DABS(CF1(3)+CF2(3)-ANS).LT.(EPS+QP5X01)) IER = 1
      IF(DABS(DABS(CF1(3)-CF2(3))-ANS).LT.(EPS+QP5X01)) IER = 3
      J = IER +1
      GO TO (10,20,30,40), J
C
C      NO INTERSECTIONS
C
   10 RETURN
C
C      ONE INTERSECTION
   40 IER = 1
      IF(CF2(3).GT.CF1(3)) GO TO 20
      CALL AVSUB(VNUL,VTEM,VTEM)
   20 CALL AVNORM(VTEM,VTEM,KER)
      IF(KER.EQ.1) CALL AERR(718)
      CALL AVMULT(VTEM,CF2(3),VTEM)
      CALL AVADD(VTEM,CF2,PT1)
      PT1(3) = PT1(3) - CF2(3)
      IF((J .EQ. 2) .OR. (J .EQ. 4)) GO TO 100
      RETURN
  100 CONTINUE
C... WHEN ONLY ONE INTERSECTION FOUND, CALCULATE THE DISTANCE FROM THE
C... INTERSECTION POINT TO THE PSEUDO DS, AND STORE THAT IN QFIL(9)
C... USED IN AINT TO SELECT BEST TAN. PT. IN 'MULTIPLE TAN. PT.' CASE
      CALL AVSUB(PT1,CF1,VTEM)
      VTEM(3) = QNUL
      CALL AVLENG(VTEM,ANS)
      QFIL(9) = DABS(ANS - CF1(3))
      RETURN
C...
C      TWO INTERSECTIONS
   30 CONTINUE
C
C               2        2    2
C   GIVEN (X-A1) + (Y-B1) = R1
C
C
C   AND
C               2        2    2
C         (X-A2) + (Y-B2) = R2
C
C   EXPAND
C
C    2           2            2    2    2
C   X  - 2A1X + Y  -2B1Y  = R1  -A1  -B1
C
C
C   SUBTRACT
C
C                                2    2    2    2    2    2
C    X(2A1-2A2) + Y(2B1-2B2) = A1  +B1  -R1  -A2  -B2  +R2
C
C
C     THIS IS THE EQUATION OF A PLANE  NORMAL TO THE LINE JOINING THE
C   CENTERS OF THE CIRCLES, AND WHICH INTERSECTS THE CIRCLES AT THEIR
C     MUTUAL INTERSECTION.   WE COULD HAVE USED THIS TECHNIQUE EXCLUSIVE
C      FOR THIS WHOLE SUBROUTINE, BUT THE TOLERANCE WOULD NOT BE PROPER
C      FOR THE TANGENCY CASES.   THEREFORE, IT IS USED ONLY WHEN WE KNOW
C      TWO INTERSECTIONS.
C
C
C      USE VTEM AS A TEMPORARY CANONICAL FORM STORAGE AREA
      VTEM(1) = Q2P*(CF1(1)-CF2(1))
      VTEM(2) = Q2P*(CF1(2)-CF2(2))
      VTEM(3) = QNUL
      CALL AVLENG(VTEM,ANSN)
      CALL AVNORM(VTEM,VTEM,IIER)
      IF(IIER.EQ.1) CALL AERR(-726)
      VTEM(3) = CF1(1)**2+CF1(2)**2-CF1(3)**2-CF2(1)**2-CF2(2)**2
     1 +CF2(3)**2
      VTEM(3) = VTEM(3)/ANSN
      CALL ALCINT(VTEM,CF2,PT1,PT2,TAUCS)
      IF(IER.NE.2) CALL ALCINT(VTEM,CF1,PT1,PT2,TAUDS)
      IF(IER.EQ.0) CALL AERR(-725)
C      DUMMY DO LOOP
      KK=3
      DO 88 I=3,KK
      VTEM(I) = QNUL
   88 CONTINUE
C... IF ALCINT RETURN INDICATES ONE INTERSECTION, CALCULATE THE
C... DISTANCE FROM THE INTERSECTION POINT (PT1) TO THE PSEUDO DS,
C... AND STORE THAT DISTANCE IN QFIL(9) ... USED IN AINT TO SELECT BEST
C... TAN. PT. IN 'MULTIPLE TAN. PT.' CASE.
      IF(IER .NE. 1) GO TO 98765
      CALL AVSUB(PT1,CF1,VTEM)
      VTEM(3) = QNUL
      CALL AVLENG(VTEM,ANS)
      QFIL(9) = DABS(ANS - CF1(3))
98765 RETURN
      END

