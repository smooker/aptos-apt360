      SUBROUTINE ASCNTL
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4,MODIFICATION 4 ***
C*    THIS IS THE CONTROL PROGRAM FOR SECTION 1, THE LANGUAGE TRANSLATOR
      IMPLICIT REAL*8(A-H,O-Z)
       REAL*8 INWORD
      INTEGER PUNTAP
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB
     1 ,KDBUG,INDXPT,LOOP,IFINI
      COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST
     1 ,NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
      COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1
     1 ,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
      COMMON/AMXTAB/MAXTAB,MAXVS1,MAXVS2,MAXPTP,MAXSCL,MAXVS,
     1MAXVST,MXPTPP,MXCAN,MXSRCN,MAXSLR,MAXELM,MAXPOT
      COMMON/AINPOT/INWORD(14),MORE,IFIRST
      COMMON/AVST/VST(7200)
      COMMON/AMACRO/LIMCAN,LMDW,NITEMS,JWHAT,MACREC,MACVST,MACERR
      COMMON/ASCALR/SCALR(180),ISCWS,NSURF,LOCTEM,IARGTP
      COMMON/A1PAS2/I,J,K,L,MOVLGE,KANMAX,ICANST,IOVREC,KANPTR,MDFTAB,
     1KANCNT,KAUX,KDFCNT,IDEFP,KPRCNT,MDFPRE,IPREP,KOVFLP,KSRFCT,KOVCNT,
     2LSCAN,IOVFLO,MAXCAN,IREF,ICANSC,NAMSTA,KANGO,LASPTP,ISUB,
     3LCOMP,LGEREC,IRECN,JREC,JNUM,KANCUR,KANCOT,KDFENT,KANPAR,LGELOC,
     4IDTMOV,ISPPRG,INDEXS,KPTP,KPTPCT,KLASTP,KLASCT,KPRNT
       DIMENSION IVST(14400)
       EQUIVALENCE (VST(1),IVST(1))
C
      DIMENSION IFW(3)
C
      IF(IFINI) 2,1,8
    1  IWAVEN = 0
       IFIRST = 0
       MORE = 0
       CALL AMONTR
C
    2  ISPRG = 0
       ILMCAN = LIMCAN - MAXVST - MXPTPP
       MAXVS1 = MAXVS1 + 1
       IMXVST = MAXVS1 + MAXVS2
       IMXSCL = MAXSCL
C...     IF INSUFFICIENT SPACE LEFT IN CANON, ADJUST SCALAR
C...     STORAGE LIMIT INDEX TO PROVIDE MINIMUM CANON STORAGE
       IC = IMXVST + MAXPTP + MAXSCL
            IF(IC.LE.5900) GO TO 220
       MAXSCL = MAXSCL + 5900 - IC
C
  220  LSURFT = 6200 - IMXVST - MAXPTP - MAXSCL
      WRITE(IOUTAP,99) MAXVST,MAXVS1,IMXVST,MXPTPP,MAXPTP,MAXPTP,
     1 IMXSCL,MAXSCL,MXCAN,ILMCAN,LSURFT
   99 FORMAT(1H0,42X'TABLE USAGE DURING INPUT TRANSLATION'//34X'PASS ONE
     1'38X'PASS TWO'/33X'ALLOCATED     USED'23X'DYNAMIC ALLOCATION'/26X
     2'VST' 7X,I4,7X,I4,23X'VST'11X,I4,/26X'PTPP'6X,I4,7X,I4,23X'PTPP'10
     3X,I4/26X'SCALARS'14X,I4,23X'SCALARS'7X,I4/26X'CANON'5X,I4,7X,I4,
     4 23X'CANON'9X,I4///)
C
C...     IF SCALAR STORAGE HAS BEEN REDUCED, OUTPUT A DIAGNOSTIC FOR
C...     INSUFFICIENT SPACE
            IF(IMXSCL.LE.MAXSCL) GO TO 100
       JSUBER = 14
       WRITE (IOUTAP,199) JSUBER
  199  FORMAT (26H0***** ISN 1, ERROR NUMBER,I5,6H *****)
       JSUBER = 0
       IWAVEN = 1
C
C...     DUMP VST IF DEBUG HAS BEEN REQUESTED WHEN FINI
C...     FOUND
  100       IF(KDBUG.EQ.0) GO TO 4
       DO 110  JJ = 1,MAXVS1,4
       WRITE (IOUTAP,3) VST(JJ),VST(JJ),VST(JJ+1),VST(JJ+2),VST(JJ+2)
     1 ,VST(JJ+3)
    3  FORMAT (7X,A6,2Z18,6X,A6,2Z18)
  110  CONTINUE
C     INITIALIZE VST1 AND VST2 TO UNDEFINED SYMBOL
    4  DO 5  I = 2,MAXVS1,2
       JTEMP1 = 2*I - 1
       JTEST = IVST(JTEMP1)
C...  IS THIS FOR A SUBSCRIPTED VARIABLE
      IF(JTEST .LT. 0)  GO TO 5
      JT = 7
      IF(JTEST .NE. 10) GO TO 42
C...  MACRO NAME - SET VST FOR CROSS-REFERENCED FOR PASS TWO
  41  JT = 8
      GO TO 44
  42  IF(JTEST .NE. 3) GO TO 44
C...  SET VST FOR A STATEMENT ID FOR PASS TWO
      VST(I-1) = 0.0D0
      GO TO 41
   44  IVST(JTEMP1) = JT
 5    CONTINUE
       J = MAXVS1 + 1
      K=MAXVS1+MAXVS2
      DO 7 I=J,K
       JTEMP1 = 2*I - 1
    7  IVST(JTEMP1) = 7
      CALL ASYCTL
      RETURN
    8       IF(KDBUG.EQ.0) GO TO 20
      WRITE (IOUTAP,9)
   9  FORMAT(////58H THE CONTENTS OF THE VARIABLE SYMBOL TABLE ARE AS FO
     1LLOWS       // )
       DO 210  JJ = 1,KANPTR,4
       WRITE (IOUTAP,3)  VST(JJ),VST(JJ),VST(JJ+1),VST(JJ+2),VST(JJ+2)
     1 ,VST(JJ+3)
  210  CONTINUE
      WRITE (IOUTAP,10)
   10 FORMAT(////44H THE CONTENTS OF THE PROTAP ARE AS FOLLOWS     // )
   11  CALL ATAPRD(PROTAP,IOFLAG,NWRDS,2,IFW,3,VST,0)
      IF(IOFLAG.GE.0) GOTO 13
       WRITE (IOUTAP,12) (IFW(I),I=1,3)
       WRITE (IOUTAP,200) (VST(I),I=1,NWRDS)
  200  FORMAT (7X,5Z18)
      IF(IFW(2).EQ.14000) GOTO 13
      GOTO 11
 12   FORMAT(7X,3I10)
   13  CALL ATAPOP(PROTAP,1,IOFLAG)
      IF(LGEREC .EQ. 0)  GO TO 20
      CALL ATAPOP(SRFTAP,1,IOFLAG)
      WRITE (IOUTAP,14) LGEREC
   14 FORMAT(////53H DUMP OF LARGE SURFACE FILE... NUMBER OF SURFACES IS
     1       I4  )
      DO 15 J =1,LGEREC
       CALL ATAPRD(SRFTAP,IOFLAG,NWRDS,2,IFW,3,VST,0)
      IF(IOFLAG.GE.0) GOTO 16
       WRITE (IOUTAP,12) (IFW(I),I=1,3)
   15  WRITE (IOUTAP,200) (VST(I),I=1,NWRDS)
  16  CALL ATAPOP(SRFTAP,1,IOFLAG)
  20  IFINI = 0
      WRITE (IOUTAP,25)
   25 FORMAT(1H1,70X)
C...  THE FOLLOWING STATEMENT SETS NOPOST IF NO MACHIN/ WAS GIVEN
      IF(NUMPST .EQ. 0)  NOPOST = 1
      CALL ACNTRL
C     THIS RETURN IS NEVER EXECUTED
      RETURN
      END

