      SUBROUTINE APOCK1
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4,MODIFICATION 4 ***
      IMPLICIT REAL*8(A-H,O-Z)
       REAL*8 NAME,KRFSYS
       INTEGER DEBUG,SUM
       INTEGER ISLASH/Z00000304/,ICOMMA/Z00000904/
       COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
       COMMON/AMOTCM/PINT(30),IFURST,JPTIND,NOW,JSUB,KRESLT,KRSLT2
     1,NWDS,ITS,NEXT,MULTAX
      COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
       COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
       DIMENSION IPT(600)
       EQUIVALENCE (PT(1),IPT(1))
C
C...     MAKE SURE AT THIS POINT THAT THERE IS AT LEAST ONE PARAMETER
C...     FOLLOWING SLASH - NOT ENOUGH IF ONLY ONE, BUT FURTHER TESTS
C...     MADE LATER
            IF(ISTARP+1.LT.JLMENT) GO TO 100
C...     TEST FOR SLASH
  100       IF(ICLASS(ISTARP+1).EQ.ISLASH) GO TO 110
       JSUBER = 155
       GO TO 999
C
C...     MOVE SCANNING INDEX PAST SLASH
  110  ISTARP = ISTARP + 2
C
       INPTP = 4
       JMODE = 5
       IPT(5) = 11000
       IPT(6) = 3
C
C...     FIRST EIGHT ENTRIES ARE FLAGS DESCRIBING CHARACTERISTICS OF
C...     POCKETING OPERATION TO BE DONE - MUST ALL BE SCALARS
       DO 120  J = 1,8
       CALL APTLOD
            IF(JPTIND.EQ.2) GO TO 115
            IF(JPTIND.NE.3) GO TO 158
  115       IF(ISTARP.GE.JLMENT) GO TO 210
C...     TEST FOR COMMA FOLLOWING PARAMETER - IF NOT, ERROR
            IF(ICLASS(ISTARP).NE.ICOMMA) GO TO 158
       ISTARP = ISTARP + 1
  120  CONTINUE
C
       NPT = 8
       ISTARP = ISTARP - 1
C...     INITIALIZE SCALAR AND SURFACE COUNTERS
       NSCAL = 0
       NSURF = 0
C...     SET FLAG FOR AUTOMATIC COMMA PICK-UP
       ITSQ = 4
C
C...     TEST FOR END OF STATEMENT
  140       IF(ISTARP-JLMENT)  150, 210, 200
C...     NO - GET NEXT PARAMETER
  150  CALL APTLOD
       NPT = NPT + 1
C...     TEST FOR SURFACE
            IF(JPTIND.NE.4) GO TO 155
C...     YES - PACK A TYPE CODE FOR A POINT IN PTPP ENTRY
       CALL ASWICH(1)
       GO TO 170
C...     NOT A SURFACE - IF NOT SCALAR, ERROR
  155       IF(JPTIND.EQ.2) GO TO 160
            IF(JPTIND.EQ.3) GO TO 160
C...     IF ERROR ALREADY DIAGNOSED IN APTLOD, JUST EXIT
  158       IF(JPTIND.EQ.8) GO TO 999
       JSUBER = 376
       GO TO 999
C...     PARAMETER IS A SCALAR
  160  NSCAL = NSCAL + 1
       GO TO 180
C...     PARAMETER IS A SURFACE
  170  NSURF = NSURF + 1
            IF(3*(NSCAL/3).NE.NSCAL) GO TO 210
  180       IF(INPTP-298)  140, 210, 210
C
C...     END OF STATEMENT REACHED - TEST FOR PROPER NO. OF PARAMETERS
  200  ISCAL = NSCAL/3
            IF(3*ISCAL.NE.NSCAL)  GO TO 210
            IF(NSURF+ISCAL.LT.3) GO TO 210
            IF(NSURF+ISCAL.LE.21) GO TO 220
  210  JSUBER = 377
       GO TO 999
C
  220  IPT(1) = 6
       IPT(2) = INPTP - 2
       IPT(3) = NPT
       IPT(4) = 0
       INPTP = INPTP - 1
      CALL APTPUT
C
  999  RETURN
C
      END

