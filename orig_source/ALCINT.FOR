      SUBROUTINE ALCINT(CFL,CFC,PANS1,PANS2,    EPS)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 2 ***
      IMPLICIT REAL*8 (A-H,O-Z)
C***
C     SPECIAL COMMON FOR 2 DIMENSIONAL PACKAGE-- USES PROTAPE BUFFER
C     READ AREA WHICH IS AVAILABLE AT ARLM2 TIME AS SCRATCH
C***
C     NOTE... VARIABLES IER,VTEM,VNUL ARE NOT THE SAME AS IN THE MAIN
C     STREAM ARITHMETIC ELEMENT
C     ALSO EX,EY,EZ,VNUL
      COMMON/A2CMMN/DUMMY(1308) ,CSCF(3) ,DSCF(3) ,CFTEM(3) ,VTEM(3) ,
     1PTEM1(3)  ,PTEM2(3)  ,PT(3,6)   ,DOT(6)    ,FPNT(3)   ,TE2D(3)   ,
     2TI2D(3)   ,CR        ,THDS      ,THCS      ,TAUDS     ,TAUCS     ,
     3PERCEN    ,ANS       ,RES       ,PNTTAN(3) ,EX(3)     ,EY(3)     ,
     4EZ(3)     ,VNUL(3)   ,
     5ICSCF     ,IDSCF     ,ITOPT     ,N         ,IDONE     ,NREV      ,
     6ITFAR     ,ITC       ,IOC       ,IPC       ,INTP      ,IER       ,
     7NINT      ,ICASE     ,ITAN
      COMMON/A2DYDP/ KDYNFQ(12), NKFQ
      COMMON/A2FPC / Q15X01,QP9X01    ,QP6X01    ,QP5X01    ,QP4X01    ,
     1QP0001    ,QP001     ,QP01      ,QP1       ,Q1P       ,Q10P      ,
     2Q1000P    ,Q1PE5     ,Q1PE6     ,Q1PE10    ,Q1PE20    ,Q1PE30    ,
     3Q1PE36    ,Q1PE38    ,QP8X01    ,QP7X01    ,
     4QP4X09    ,QP9       ,QP99      ,QP995     ,QP997     ,QP999     ,
     5QP9999    ,QP4X95    ,QP5X95    ,QP6X9     ,QP7X9     ,
     6QP6X05    ,QP5X05    ,QP4X05    ,QP0005    ,QP005     ,QP05      ,
     7QP5       ,Q5P       ,                                 Q4X045    ,
     8QP0002    ,QP0047    ,QP017     ,Q1RAD     ,QP0349    ,QP125     ,
     9QP6       ,QP2       ,QP2499    ,QP25      ,QP3
      COMMON/A2FPC / QP7   ,QP75      ,QP8       ,QP866     ,Q1P01     ,
     1Q1P1      ,Q1P2      ,Q1P25     ,Q1P5      ,Q2P       ,Q2P5      ,
     2Q3P       ,Q3P5      ,Q4P       ,Q8P       ,Q11P      ,Q45P      ,
     3Q90P      ,Q130P     ,Q4500P    ,Q9000P    ,QP02      ,QNUL      ,
     4QPIE       ,QFIL(9)
C      INTERSECTS A LINE AND A CORCLE
C
      DIMENSION CFL(1),CFC(1),PANS1(1),PANS2(1)
C
C      CFL = LINE CANONICAL FORM8 OF FORM AX +BY = D
C      CFC = CIRCLE CANONICAL FORM8 OF FORM (X-A)**2 + (Y-B)**2 = R**I
C      PANS1 AND 2 ARE ANSWERS
C      IER = 0  NO INTERSECTIONS  =1 ONE, =2, TWO
C
C      COMPUTE THE DISTANCE FOM CORCLE TO LINE
      DIST = CFL(1)*CFC(1) + CFL(2)*CFC(2)-CFL(3)
C
C      SEE IF NONE8 ONE OR TWO INTERSECTIONS
      IER = 2
      IF(DABS(DIST).GT.(CFC(3)+EPS)) IER = 0
      IF(DABS(DABS(DIST)-CFC(3)).LE.EPS) IER = 1
      IF((IER.NE.1).OR.(ITOPT.EQ.4)) GO TO 10
      IF(DABS(DIST).LT.CFC(3)) IER=2
   10 J=IER+1
      GO TO (1,2,3),J
    1 GO TO 5
C      ONE     RESIDUL TIMES PLANE VECTOR IS POINT
    2 IF(ICASE .NE. 3) GO TO 22
      IF(DABS(DABS(DIST)-DSCF(3)) .LT. EPS) DIST = DSIGN(DSCF(3),DIST)
   22 PANS1(1) = -DIST * CFL(1) + CFC(1)
      PANS1(2) = - DIST*CFL(2) + CFC(2)
      PANS1(3) = QNUL
      GO TO 5
C
C      TWO INTERSECTIONS
    3 ROOT = DSQRT(CFC(3)**2 - DIST**2)
      PANS1(1) = CFC(1) - DIST*CFL(1)-ROOT*CFL(2)
      PANS1(2) = CFC(2) - DIST*CFL(2)+ROOT*CFL(1)
      PANS2(1) = CFC(1) - DIST*CFL(1) + ROOT*CFL(2)
      PANS2(2) = CFC(2) - DIST*CFL(2) - ROOT*CFL(1)
      PANS1(3) = QNUL
      PANS2(3) = QNUL
C... WHEN ONLY ONE INTERSECTION FOUND, CALCULATE THE DISTANCE FROM THE
C... INTERSECTION POINT TO THE PSEUDO DS, AND STORE THAT IN QFIL(9)
C... USED IN AINT TO SELECT BEST TAN. PT. IN 'MULTIPLE TAN. PT.' CASE
    5 IF(J .NE. 2) GO TO 40
      IF(ICASE .NE. 2) GO TO 50
      QFIL(9)=DABS(CFL(1)*PANS1(1) + CFL(2)*PANS1(2) - CFL(3))
      RETURN
   50 CALL AVSUB(PANS1,CFC,VTEM)
      VTEM(3) = QNUL
      CALL AVLENG(VTEM,ANS)
      QFIL(9) = DABS(ANS - CFL(3))
   40 CONTINUE
      RETURN
      END

