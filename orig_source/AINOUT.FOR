      SUBROUTINE AINOUT
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C
      IMPLICIT REAL*8(A-H,O-Z)
       INTEGER ISLASH/Z00000304/
       INTEGER DEBUG,SUM
       INTEGER*2 IZW
       REAL*8 NAME,KRFSYS
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
       COMMON/AMOTCM/PINT(30),IFURST,JPTIND,NOW,JSUB,KRESLT,KRSLT2
     1,NWDS,ITS,NEXT,MULTAX
       COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
       COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
       DIMENSION IPT(600)
       EQUIVALENCE (PT(1),IPT(1)),(ITEMP,IZW)
      COMMON/AVST/VST(2750),PTPP(2225),CANON(2225)
       COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
C
            IF(ISTARP.GE.JLMENT-1) GO TO 129
       JMODE = 5
       INPTP = 3
       NPT = 0
       IPT(1) = 5
       IPT(2) = 0
       PT(2) = 0.0
       ITEMP = ICLASS(ISTARP)
      IF(IZW-2)10,50,200
C
C...     TITLES
   10  ISTARP = ISTARP + 1
   15  CALL APTLOD
       NPT = NPT + 1
            IF(ISTARP.LE.JLMENT) GO TO 15
       NPR = 3
      GOTO 900
C
C...     PUNCH/
   50  NPR = 2
            IF(ICLASS(ISTARP+1).NE.ISLASH) GO TO 155
       ISTARP = ISTARP + 2
   51       IF(ICLASS(ISTARP).NE.3) GO TO 129
   55  ITSQ = 4
            IF(ELMENT(ISTARP).NE.0.0) GO TO 90
C...     PUNCH/0 OR PRINT/0
   60       IF(ISTARP.LT.JLMENT) JSUBER = 129
       CALL APTLOD
      NPT=1
      GOTO 900
C
C...     PUNCH/1-3 OR PRINT/1-3
   90  CALL APTLOD
       NPT = NPT + 1
C...     TEST FOR VOCABULARY WORD
            IF(JPTIND.EQ.0) GO TO 500
C...     TEST FOR END OF LIST
            IF(ISTARP.GT.JLMENT) GO TO 100
C...     TEST FOR OVERFLOW OF PT BUFFER
            IF(INPTP-298)  90, 1000, 1000
  100       IF(NPT.LE.1) GO TO 129
      GOTO 900
C
C...     PRINT/
  200  NPR = 1
            IF(ICLASS(ISTARP+1).NE.ISLASH) GO TO 155
       ISTARP = ISTARP + 2
            IF(ICLASS(ISTARP).EQ.3) GO TO 55
C...     PRINT/ON OR /OFF
      INTER=4
       CALL APTLOD
            IF(JPTIND.NE.0) GO TO 129
            IF(KRESLT.EQ.71) INTER = 3
       IPT(1) = 8
       IPT(2) = INTER
       INPTP = 2
       GO TO 990
C
C...     PUNCH OR PRINT/1-3,ALL
  500       IF(NPT.NE.2) GO TO 129
            IF(ISTARP.LE.JLMENT) GO TO 129
            IF(KRESLT.NE.51) GO TO 132
C
C...     OUTPUT PTPP 5 RECORD
  900       IF(JMODE.EQ.5) GO TO 910
       JMODE = 3
       GO TO 990
  910  IPT(2) = INPTP - 2
       IPT(3) = NPT
       IPT(4) = NPR
  990  INPTP = INPTP - 1
       CALL APTPUT
  999  RETURN
C
C...     PT BUFFER OVERFLOW
 1000       IF(JMODE.NE.2) JMODE = 1
       INPTP = INPTP - 1
       CALL APTPUT
       JMODE = 2
       INPTP = 1
       GO TO 90
C
C...     MISSING SLASH
  155  JSUBER = 155
       GO TO 999
C..      ERROR
  129 JSUBER=129
      GOTO 999
  132 JSUBER=132
      GOTO 999
      END

