       SUBROUTINE TRACUT (KKK)
C  *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 0 ***
C***********************************************************************
      IMPLICIT REAL*8 (A-H,O-Z)
C***********************************************************************
       DOUBLE PRECISION   APOSTP,ATAPTB
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1 NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
       COMMON/APOSTP/PPNAME(20)
      COMMON/A3FXD1/AMATI1(4,4),AMATI2(4,4),AMATI3(4,4),AMATRX(3,4),
     1AMTR(36),AN1,AN2,ANAME,AX,AX0,AXVEC(3),AY,AY0,CNTM(36),CNTMAT(3,4)
     2,CONT(3),COUNT(3),CSEQNO(1),DELX,DELY,DX,DY,F0,ORIGIN(3),PARRAY
     3(20),PARTNO(12),PNT(3),PPRINT(12),PPT(6),PT0(3),PTT(6),PTU(3),
     4SEQNO(1),SUB(5),SUB4(6),TAPSTO(250),TITL(8),TL,TMATRX(3,4),
     5TNTM(36),TOOLNG,TRAMAT(3,4),VEC(3),WORD,X0,X1,X2,X3,XNEW,
     6Y0,Y1,Y2,Y3,YNEW
      REAL*8 MOTION
      COMMON/A3FXD2/MOTION(8)
      COMMON/A3FXI1/IARROW,I1,I2,ICLWAS,ICOPY,IDPLOT,IDPLSQ,IFIRST,
     1IGODLT,INDN,INSTR1,INSTR2,IND2TB(160),INDOFF,INDTAB(160),
     2INDXNO(3),IPERSP,IPL5AX,IPLOTI,IPLOTX,IPLWAS,IPX,IPY,IRECNI(3),
     3IRECNO,IRECTP,IRET,IRETVR,ISUBSC,ISWMAC,ISWNOC,IT,
     4ITHPNT,ITRAFL,ITRUNC,JARROW,JCLPRT,JCOPY,JPTSW,
     5JSW,JTYPSW,JVECTR,KCLPRT,KCOPY,MAXCOP,MULTAX,
     6NCAMRA,NK,NNTAB,NRECNO,NTAB,NUMWDS,NURCNO,NX,NX0,
     7NX1,NX2,NX4,NX5,NXP,NY,NY0,NY1,NY2,NY4,NY5,NYP,
     8IFALMS,IWARMS,INTSEQ
       REAL*8 NUCLTP
      EQUIVALENCE   (NUCLTP,TAPES2)
C...********************************************************************
C... THIS SECTION PROCESSES THE TRACUT INSTRUCTION...
C... IS INDEXX ON
  700  IF(INDEXX-K1)150,705,150
C... IS THE MODIFIER NOMORE - IF SO TURN OFF THE TRACUT FLAG.
  705  IF(I1-53)720,710,720
C... TURN OFF TRACUT    FLAG
  710  ITRAFL=K0
                  GO TO  800
C... TURN ON TRACUT FLAG
  720  ITRAFL=K1
C... STORE TRACUT MATRIX FROM TAPE AND STORE BY COLUMNS
       K=K2
       DO 730  I = 1,3
       DO 730  J = 1,4
       K=K+K1
  730          TRAMAT(I,J) = TAPSTO(K)
C... MOVE COPY MATRIX
  800              CALL MATMOV (CNTMAT,TMATRX)
C... IS A COPY IN EFFECT
       IF(ICOPY-K1)810,850,830
C... IS THIS A NOMORE
  810  IF(I1-53)820,870,820
C... MOVE THE TRACUT    MATRIX
  820              CALL MATMOV (TRAMAT,TMATRX)
                  GO TO 870
C... UPDATE THE TMATRX IF THERE IS MORE THAN ONE COPY IN EFFECT
  830  DO 840 I=K2,ICOPY,K1
       CALL MULTM (TMATRX,CNTM( 12*I- 11),TMATRX)
  840  CONTINUE
C... IS THIS A NOMORE
  850  IF(I1-53)860,870,860
C... MULTIPLY TMATRX AND TRAMAT
  860             CALL  MULTM (TMATRX,TRAMAT,TMATRX)
  150  KKK=K1
       GO TO 9999
  870  KKK=K2
 9999  RETURN
       END

