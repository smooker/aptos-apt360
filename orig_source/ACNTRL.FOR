      SUBROUTINE ACNTRL
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C     *          *          *          *          *          *
C     *          *          *          *          *          *
C     SECTION ZERO NAMED COMMON
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/ATIME/FLTIME,DATE,CLOCK(2)
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1NOPLOT,NUMPST,NUMPTR,IS3(3),KFLAGS(9)
      COMMON/APOSTP/PPNAME(20)
      INTEGER PUNTAP
      COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,
     1TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
C     *          *          *          *          *          *
      EQUIVALENCE(IS3(3),IPLOTR),(IS3(2),INDEXX),(IS3(1),ICLPRT)
C     *          *          *          *          *          *
C     END OF SECTION ZERO COMMON AND EQUIVALENCE STATEMENTS
C     *          *          *          *          *          *
C9000 IS THIS A NEW PART PROGRAM
 9000 IF(KFLAGS(6).EQ.IBLANK)GO TO 9002
C
 9001 CALL INITAL
C     GET SECTION 1
       ISECT = 1
       GO TO 9510
C
C...     OBTAIN AND PRINT ELAPSED TIME IN LAST SECTION
9002  CLOCK1=FLTIME
      CALL ARTIME
      CLOCK1=FLTIME-CLOCK1
      WRITE(IOUTAP,9003)CLOCK1
 9003 FORMAT(////,42X,'ELAPSED TIME IS ',F12.5,1X,'MINUTES'/1H0,70X)
C...     IF IWAVEN = 0, NO ERROR. IF IT = 1, ERRORS IN ONE OF
C...     SECTIONS 1, 3, OR 4. IF IT = 2, SECTION 2 ERRORS FOUND
            IF(IWAVEN-1)  9200, 9001, 9100
C
C...     SECTION 2 ERRORS FOUND - SEE IF AN AUXILIARY SEC. 2 IS TO
C...     BE EXECUTED
 9100       IF(LTVMIT.EQ.0) GO TO 9110
C
C...     AUXILIARY SECTION 2 DESIRED - SET FLAGS FOR IT
       KFLAGS(3) = 1
       LTVMIT = 0
       GO TO 9114
C
C9110 NO AUXILIARY SECTION 2 TO BE EXECUTED. DO NOT POST PROCESS.
 9110  KFLAGS(5) = 0
       KFLAGS(3) = 0
C9114 HAS CLPRNT/ON OR /OFF BEEN REQUESTED
9114  IF(ICLPRT)   9116,9115,9116
C...     TURN ON CLFILE PRINT FLAG
 9115  ICLPRT = 1
 9116  ISECT = 4
       GO TO 9530
C
C...     IF SECTION 1 JUST PROCESSED, ADJUST FLAGS AS NECESSARY FOR
C...     LATER SECTIONS
 9200       IF(ISECT.GT.1) GO TO 9450
C
C...     CHECK FLAGS FOR POSSIBLE SECTION 3 PROCESSING
      IF(NOPLOT) 9302,9303,9302
C9302 VOID PLOTTING
 9302   IPLOTR = 0
C...     CHECK PLOT, CLPRNT, AND COPY
 9303  DO 9310  I = 1,3
            IF(IS3(I).EQ.0) GO TO 9310
C9305 TURN ON SECTION 3 PROCESSING
 9305  KFLAGS(4) = 1
 9310 CONTINUE
      IF(ITRCUT)9315,9320,9315
 9315  KFLAGS(4) = 1
C...     SEE IF SECTION 4 IS TO BE PROCESSED
 9320 IF(NOPOST) 9325,9326,9325
C9325 NO EXECUTION OF SECTION 4
 9325  KFLAGS(5) = 0
C
C9326 CHECK PTONLY/N PROCESSING
C     IPTNLY=0 NORMAL
C     IPTNLY=1 SKIP SECTION 2 AND EXCHANGE DATASETS
C     IPTNLY=2 SKIP SECTION 2 AND DO NOT EXCHANGE DATASETS
C     IPTNLY=3 DO NOT SKIP SECTION 2.POSITION CLTAPE AT
C              RECORD NO. NCLREC
C     *          *          *          *          *          *
9326  I = IPTNLY + 1
       GO TO (9450,9360,9370,9380),I
 9360 CALL TAPECH(PROTAP,CLTAPE)
      CALL TAPECH(PROTAP,TAPES2)
C     TURN OFF SECTION 2 PROCESSING
 9370  KFLAGS(2) = 0
       KFLAGS(3) = 0
       GO TO 9450
 9380 CALL BUFFTP(CLTAPE,2)
      CALL SEARCH(CLTAPE,NCLREC,IRET)
      IPTNLY = -NCLREC
            IF(IRET.LT.0) GO TO 9450
C9390 SECTION ZERO ERROR COMMENT
 9390 IRET = IRET-1
      WRITE (IOUTAP,9400) NCLREC,IRET
 9400 FORMAT (9X,'APT SECTION 0 ERROR COMMENT'/X,'CLTAPE COULD NOT BE PO
     1SITIONED TO RECORD NO. (',I6,') FOR ABOVE PART PROGRAM'/' NUMBER O
     2F RECORDS ON CLTAPE IS ',I6)
      GO TO 9001
C
C...     CLEAR FLAG FOR SECTION JUST EXECUTED, AND MOVE INDICATOR
C...     PAST IT
 9450  KFLAGS(ISECT) = 0
       ISECT = ISECT + 1
C...     SEARCH FOR NEXT SECTION TO BE EXECUTED
       DO 9460  I = ISECT,5
            IF(KFLAGS(I).EQ.1) GO TO 9500
 9460  CONTINUE
C...     PROCESSING COMPLETE FOR THIS PART PROGRAM
       GO TO 9001
C
C...     NEXT SECTION TO BE EXECUTED FOUND - SAVE THE INDICATOR, AND
C...     BRANCH TO OBTAIN THE DESIRED SECTION
 9500  ISECT = I
       GO TO (9510,9520,9525,9530,9540),ISECT
C
C...     GET SECTION 1
 9510  CALL ASCNTL
       GO TO 9000
C
C...     GET STANDARD SECTION 2
 9520  CALL A2CTRL
       GO TO 9000
C
C...     GET AUXILIARY SECTION 2...
C...     TURN ON FLAG FOR SECTION 3 TO RECOGNIZE AUXILIARY PRINT
 9525  KFLAGS(7) = 1
C...     CALL STATEMENT TO ENTRY NAME FOR AUX. SEC. 2 GOES HERE
C...     THE NEXT CARD SHOULD BE -
C...     GO TO 9000
       GO TO 9520
C
C...     GET SECTION 3
 9530  CALL SECTN3
       GO TO 9000
C
C...     GET SECTION 4
 9540  CALL APTPOS
       GO TO 9000
C
       END

