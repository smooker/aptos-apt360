       SUBROUTINE  CLPRNT
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C...   THIS ROUTINE PRINTS ANYONE OF THE 14 RECORD TYPES POSSIBLE ON THE
C...   CLTAPE AS IT APPEARS ON ENTRY IN TAPSTO(COMMON)
C...                    NUMWDS = THE NUMBER OF WORDS READ BY CLREAD
C...                    JTYPSW = THE RECORD TYPE INTERGER DIVDED BY 1000
C...                    TAPSTO = THE BLOCK READ FROM CLTAPE
C...           SEQNO = THE INPUT CARDS SEQUENCE NUMBER
C...           CSEQNO = THE INPUT SEQUENCE NUMBER OF A MACRO CALL
C********************************************************************
C***********************************************************************
      IMPLICIT REAL*8 (A-H,O-Z)
C***********************************************************************
       COMMON/PARM1/PARM(180)
       COMMON/POSTA1/POSTA(22)
       COMMON/POSTP1/POSTP(72)
       DOUBLE PRECISION   APOSTP,ATAPTB
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1 NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
       COMMON/APOSTP/PPNAME(20)
      COMMON/A3FXD1/AMATI1(4,4),AMATI2(4,4),AMATI3(4,4),AMATRX(3,4),
     1AMTR(36),AN1,AN2,ANAME,AX,AX0,AXVEC(3),AY,AY0,CNTM(36),CNTMAT(3,4)
     2,CONT(3),COUNT(3),CSEQNO(1),DELX,DELY,DX,DY,F0,ORIGIN(3),PARRAY
     3(20),PARTNO(12),PNT(3),PPRINT(12),PPT(6),PT0(3),PTT(6),PTU(3),
     4SEQNO(1),SUB(5),SUB4(6),TAPSTO(250),TITL(8),TL,TMATRX(3,4),
     5TNTM(36),TOOLNG,TRAMAT(3,4),VEC(3),WORD,X0,X1,X2,X3,XNEW,
     6Y0,Y1,Y2,Y3,YNEW
      REAL*8 MOTION
      COMMON/A3FXD2/MOTION(8)
      COMMON/A3FXI1/IARROW,I1,I2,ICLWAS,ICOPY,IDPLOT,IDPLSQ,IFIRST,
     1IGODLT,INDN,INSTR1,INSTR2,IND2TB(160),INDOFF,INDTAB(160),
     2INDXNO(3),IPERSP,IPL5AX,IPLOTI,IPLOTX,IPLWAS,IPX,IPY,IRECNI(3),
     3IRECNO,IRECTP,IRET,IRETVR,ISUBSC,ISWMAC,ISWNOC,IT,
     4ITHPNT,ITRAFL,ITRUNC,JARROW,JCLPRT,JCOPY,JPTSW,
     5JSW,JTYPSW,JVECTR,KCLPRT,KCOPY,MAXCOP,MULTAX,
     6NCAMRA,NK,NNTAB,NRECNO,NTAB,NUMWDS,NURCNO,NX,NX0,
     7NX1,NX2,NX4,NX5,NXP,NY,NY0,NY1,NY2,NY4,NY5,NYP,
     8IFALMS,IWARMS,INTSEQ
       REAL*8 NUCLTP
      EQUIVALENCE   (NUCLTP,TAPES2)
C...********************************************************************
C...********************************************************************
C
       EQUIVALENCE (TAPSTO(1),ITA(1))
       DIMENSION TAP(8),ITAS(2),TARRAY(24)
       EQUIVALENCE (TAPS,ITAS(1))
       DIMENSION AQ(14),ITA(500),AQ1(6),AQ2(12),AQ3(8),AQ4(6),AQ5(6),AQ7
     1(8),AQQ(2)
       DATA AQ/'CUT     DNTCUT  2DCALC  3DCALC  NDTEST  INTOF   INTOL/
     1OUTTOL/ CUTTER/ TRANTO/ CSTRANTODYNDMP/ GO/     OFFSET/ '/
       DATA AQ1/'  GOLFT/  GORGT/  GOFWD/ GOBACK/   GOUP/  GODWN/'/
       DATA AQ2/'DEBUG/OFF       DEBUG/ON        SECT. 2 RESTART CLPRNT
     1/OFF     CLPRNT/ON       CLPRNT/OPTION   '/
       DATA AQ3/'TLAXIS  MULTAX  MAXDP   NUMPTS  THICK   NOPS    AUTOPS
     1 GOUGCK  '/
       DATA AQ4/'OFF     ON      NORMPS  NORMDS  PSCONTRLDSCONTRL'/
       DATA AQ5/'  TLLFT   TLRGT    TLON          TLONPS  TLOFPS '/
       DATA AQ7/'INDIRP/ INDIRV/ FROM/   GODLTA/ GO---/  SRFCNTD/
     1 SRFVCT/'/
       DIMENSION AQ8(16),IJ(3),WORD1(3),AQ9(21)
       DATA AQ8/' TLAXIS  NONAME (  PS  )(  DS  )(  CS  )( PSIS )( REGPS
     1)IMPL. TO   TO     PAST     ON    TANTO  SOME HOWSOME HOWSOME HOW
     2PSTAN  '/
       DATA AQ9/' POINT    LINE   PLANE   CIRCLE CYLINDER ELLIPSE HYPERB
     1   CONE   GCONIC  LCONIC  VECTOR  MATRIX  SPHERE  QADRIC  POLCON
     2 LOFT    TOOL   TABCYL   MESH   CONSEC  RLDSRF '/
       DIMENSION AQ6(12)
       DATA AQ6/'(9H0REC. NO.,I6,9H CARD NO.,A9,3H , ,A6,1H/,     (34X,
     1     )      A8    F10.4   ,1H,,          '/
       DATA AQQ/'(1H ,4X,A6,1H/, '/
       IF(IRS1.NE.1000) GO TO 771
       WRITE(IOUTAP,770) IRECNO,INSTR1,INSTR2,(TAPSTO(I),I=1,NUMWDS)
 770  FORMAT (4X,3Z10/(4X,5Z18))
  771  CONTINUE
  772 IF (INDEXX-1) 779,773,773
  773 III=IRECNO
      IRECNO=NURCNO
      IF (KCLPRT) 779,774,779
  774 IRECNO=IRECNO+1
  779 JTYPSW=INSTR1/1000
               GO TO (100,200,300,400,500,600,700,800,900,1000,1100,1200
     1,1300,3500),JTYPSW
C...  THE FOLLOWING INSTRUCTIONS SAVE ORIGINAL INPUT SEQUENCE NUMBER
 100   IF (INSTR2) 120,110,110
  110  WRITE(IOUTAP,192) IRECNO,TAPSTO(2),INSTR2
       SEQNO(1) = TAPSTO(2)
       GO TO  139
 120   INSTR2=IABS(INSTR2)
       CSEQNO(1) = TAPSTO(2)
       WRITE(IOUTAP,135) IRECNO,CSEQNO,INSTR2
  192 FORMAT(1H ,83X,'RECNO ',I5,' CARD ',A8,' ISN ',I5)
  135 FORMAT(1H ,67X,'** CALL CARD ** ','RECNO ',I5,' CARD ',A8,' ISN ',
     1I5)
 139   INTSEQ=INSTR2
  140 GO TO 4000
C...   THE FOLLOWING INSTRUCTINS OUTPUT THE AUXILIARY COMMANDS...
  200  IF(NUMWDS) 201,202,201
  202  IF(INSTR2.GT.1000) GO TO 203
      WRITE(IOUTAP,271) POSTA(INSTR2)
       GO TO 4000
  203  J = INSTR2-1000
      WRITE(IOUTAP,271) POSTP(J)
       GO TO 4000
  201  J = INSTR2-1000
       IF (J.LT.44) GO TO 204
       IF (J.GT.46) GO TO 204
      WRITE(IOUTAP,272) POSTP(J),(TAPSTO(I),I=1,11)
C
       GO TO 4000
  271 FORMAT(5X,A8)
  272 FORMAT(2X,A8,11A6)
  204  IF(J.NE.20) GO TO 205
       IF(TAPSTO(1).EQ.12345.) IRS1=1000
       IF(TAPSTO(1).EQ.54321.) IRS1=0
  273  FORMAT('0REC. NO. ',I5,' CARD NO. ',A8,' , ',A8,'/',3Z18/(34X,4Z1
     18))
  205 IF(J.NE.37) GO TO 207
      IF(NUMWDS.NE.14) GO TO 207
  206 WORD = TAPSTO(2)
      JJ = WORD
      WRITE(IOUTAP,274) POSTP(J),TAPSTO(1),JJ,(TAPSTO(I),I=3,14)
C
      GO TO 4000
  274 FORMAT(5X,A8,'/',A8,'(',I5,')',4(F13.7,',')/(29X,4(F13.7,',')))
C
  207 IF(J.NE.38) GO TO 208
      IF (NUMWDS.EQ.14) GO TO 206
  208 IF(J.NE.40) GO TO 220
      JJ = ITA(4)
      IF(NUMWDS.EQ.17) GO TO 209
      WRITE(IOUTAP,275) POSTP(J),TAPSTO(1),PARM(JJ),(TAPSTO(I),I=3,NUMWD
     1S)
      GO TO 4000
  209 WORD = TAPSTO(4)
      N = WORD
      WRITE(IOUTAP,276) POSTP(J),TAPSTO(1),PARM(JJ),TAPSTO(3),N,
     1TAPSTO(17),(TAPSTO(I),I=5,16)
      GO TO 4000
  276 FORMAT(5X,A8,'/',F5.0,',',A8,',',A8,'(',I5,')',F5.0/29X,4(F13.7,',
     1')/(29X,4(F13.7,',')))
C
  275 FORMAT(5X,A8,'/',F5.0,',',A8,4(',',F12.6))
C
  220 DO 221 I=1,2
  221 TARRAY(I) = AQQ(I)
      DO 222 I=3,24
  222  TARRAY(I) = AQ6(12)
      IP = 3
       NT1 = 1
       NT2 = 1
       KL = 0
       IF (J.NE.15) GO TO 224
       TAP(1) = TAPSTO(1)
      TARRAY(3) = AQ6(9)
      IP = 4
       NT1 = 2
       NT2 = 2
       KL = 1
  224  NT4 = 2
  225  IF(NT2.GT.NUMWDS) GO TO 226
       TAPS = TAPSTO(NT2)
       NT2 = NT2+1
       IF (KL.GT.6) GO TO 227
       IF (ITAS(1).EQ.0) GO TO 228
  230  KL = KL+2
       PAPS = AQ6(10)
       GO TO 229
  228  IF(ITAS(2)) 231,230,231
  227  IF(KL.EQ.8) GO TO 232
       IF(ITAS(1).NE.0)GO TO 232
       IF(ITAS(2).EQ.0)GO TO 232
  231  JJ = ITAS(2)
       TAPS = PARM(JJ)
       PAPS = AQ6(9)
       KL = KL+1
  229  TAP(NT1) = TAPS
       NT1 = NT1+1
       IF(NT4.EQ.2) GO TO 233
       IF(IP-2) 234,235,234
  233 IF(IP .EQ. 3) GO TO 235
  234  TARRAY(IP) = AQ6(11)
       TARRAY(IP+1) = PAPS
       IP = IP+2
       GO TO 225
  235  TARRAY(IP) = PAPS
       IP = IP+1
       GO TO 225
  226  NT4 = NT4+2
  232  TARRAY(IP) = AQ6(8)
       NT1 = NT1-1
       IF(IRS1.NE.1000) GO TO 239
       WRITE(IOUTAP,277) (TARRAY(I),I=1,IP)
  277  FORMAT('0TARRAY'/(5Z18))
  239  GO TO (253,236,253,236),NT4
  253  WRITE(IOUTAP,TARRAY) (TAP(I),I=1,NT1)
       GO TO 237
  236 WRITE(IOUTAP,TARRAY) POSTP(J),(TAP(I),I=1,NT1)
  237  IF(NT4.GT.2) GO TO  4000
       KL = 0
       NT1 = 1
       NT2 = NT2-1
       NT4 = 1
       TARRAY(1) = AQ6(7)
       DO 238 I=2,IP
  238  TARRAY(I) = AQ6(12)
       IP = 2
       GO TO 225
C...   THE FOLLOWING INSTRUCTIONS OUTPUT THE SURFACE DATA...
  300  JJ = ITA(4)
       IF(JJ.GT.17) JJ=JJ-32
       WORD = TAPSTO(5)
       J = WORD
       WORD = TAPSTO(4)
       IF(WORD.EQ.0.) WORD = AQ8(2)
       KL = ITA(2)+8
       IF (NUMWDS.EQ.5) GO TO 310
      WRITE(IOUTAP,380) AQ9(JJ),AQ8(INSTR2+2),WORD,J,AQ8(KL),
     1(TAPSTO(I),I=6,NUMWDS)
       GO TO   4000
  310 WRITE(IOUTAP,9997) AQ9(JJ),AQ8(INSTR2+2),WORD,J,AQ8(KL)
 9997 FORMAT(1H ,14X,'SURFACE DATA - ',2A8,' ** ',A8,'(',I5,') ** ',A8,'
     1 **')
       GO TO   4000
  380 FORMAT(1H ,14X,'SURFACE DATA - ',2A8,' ** ',A8,'(',I5,') ** ',A8,'
     1 **',/22X,'CANON FORM IS ',6(F13.7,',')/
     2(36X,6(F13.7,',')))
  400 WRITE(IOUTAP,401) AQ5(INSTR2)
  401 FORMAT(1H ,14X,'TOOL ORIENTATION IS ',A8)
C
      GO TO 4000
C...   THE FOLLOWING INSTRUCTIONS OUTPUT THE CUTTER LOCATIONS...
  500  GO TO(510,510,530,540,530,530,4000,510),INSTR2
  540  IF(NUMWDS.NE.3) GO TO 541
      WRITE(IOUTAP,580) AQ7(INSTR2),AQ8(1),TAPSTO(3)
       GO TO   4000
  580 FORMAT(1H ,14X,'$$$ ',2A8,',',F10.4)
  541  IF (TAPSTO(1)) 543,542,543
  542 WRITE(IOUTAP,9999) AQ7(INSTR2),TAPSTO(3),TAPSTO(4),TAPSTO(5)
 9999 FORMAT(1H ,14X,'*** ',A8,F10.4,2(',',F10.4))
       GO TO   4000
  543  WORD = TAPSTO(2)
       J = WORD
      WRITE(IOUTAP,9998) AQ7(INSTR2),TAPSTO(1),J,TAPSTO(3),TAPSTO(4),TAP
     1STO(5)
 9998 FORMAT(1H ,14X,'*** ',2A8,'(',I5,') ... ',F10.4,2(',',F10.4))
       GO TO   4000
  530  WORD = TAPSTO(2)
       J = WORD
       WORD = TAPSTO(1)
       IF (ITA(1).EQ.0) WORD = AQ8(2)
       IF(MULTAX) 532,531,532
  531 WRITE(IOUTAP,581) AQ7(INSTR2),WORD,J,(TAPSTO(I),I=3,NUMWDS)
C
       GO TO   4000
  532 WRITE(IOUTAP,582) AQ7(INSTR2),WORD,J,(TAPSTO(I),I=3,NUMWDS)
C
       GO TO   4000
  582 FORMAT(1H ,14X,'*** ',2A8,'(',I5,')'/(20X,6F15.7))
C
  581 FORMAT(1H ,14X,'*** ',2A8,'(',I5,')'/(38X,3F15.7))
C
  510  J = 1
       DO 511 I=1,11,5
       WORD1(J) = TAPSTO(I)
       WORD = TAPSTO(I+1)
       JJ = WORD
       IJ(J) = JJ
       IF (TAPSTO(I).EQ.0.) WORD1(J)=AQ8(2)
  511  J = J+1
      WRITE(IOUTAP,583) AQ7(INSTR2),(WORD1(I),IJ(I),I=1,3),(WORD1(I),IJ(
     1I),TAPSTO(5*I-2),TAPSTO(5*I-1),TAPSTO(5*I),I=1,3)
       GO TO   4000
  583 FORMAT(1H ,14X,'*** ',A8,2(A8,'(',I5,'),'),A8,'(',I5,')'/27X,A8,'(
     1',I5,') =',3(F11.5,','))
C...  THE FOLLOWING FLAGS ARE SPECIAL FLAGS FOR ARELEM SECTION
  600  N = INSTR2+3
       GO TO(610,620,630,640,640,660,670,670,640),INSTR2
  610  N = I1+1
  611 WRITE(IOUTAP,9996) AQ(N)
 9996 FORMAT(1H ,14X,A8)
       GO TO 4000
  620  N = I1+3
       GO TO 611
  630  WORD = TAPSTO(1)
       J = WORD
      WRITE(IOUTAP,681) AQ(N),J
       GO TO 4000
  640 WRITE(IOUTAP,682) AQ(N),(TAPSTO(I),I=1,NUMWDS)
       GO TO 4000
  670 WRITE(IOUTAP,681) AQ(N),I1,TAPSTO(2)
       GO TO 4000
  660  IF(ITA(1).NE.0) GO TO 640
       IF(ITA(2).EQ.0) GO TO 640
      WRITE(IOUTAP,683) AQ(N),ITA(2),(TAPSTO(I),I=2,NUMWDS)
C
       GO TO 4000
  681 FORMAT(1H ,12X,A10,I6,A10)
  682 FORMAT(1H ,12X,A10,8(F10.6))
C
  683 FORMAT(1H ,12X,A10,I16,7(F10.4))
C
  700  N = INSTR2+12
      WRITE(IOUTAP,790) AQ(N),ITA(2)
       GO TO 4000
  790 FORMAT(1H ,14X,'START UP INSTRUCTION - ',A8,I5,' SURFACES')
C
  800 WRITE(IOUTAP,890) AQ1(INSTR2)
  890 FORMAT(1H ,14X,'MOTION INSTRUCTION IS ',A8)
C
      GO TO 4000
C...   THE FOLLOWING INSTRUCTIONS OUTPUT THE AXIS MODE (3AXIS OR 5AXIS).
  900  GO TO (910,920,930,930,930,960,960,920),INSTR2
  920  N = ITA(2)+1
  921 WRITE(IOUTAP,980) AQ3(INSTR2),AQ4(N)
       GO TO 4000
  960 WRITE(IOUTAP,980) AQ3(INSTR2)
       GO TO 4000
  930 WRITE(IOUTAP,981) AQ3(INSTR2),(TAPSTO(I),I=1,NUMWDS)
       GO TO 4000
  980 FORMAT(1H ,14X,2A8)
  981 FORMAT(1H ,14X,A8,6F10.4)
C
  910  WORD = TAPSTO(1)
       N = WORD
       GO TO (911,912,913,914,917),N
  912  N = ITA(4)+2
       GO TO 921
  914  WORD = TAPSTO(2) + 4.0D0
       N = WORD
      WRITE(IOUTAP,982) AQ3(INSTR2),PARM(17),AQ4(N)
       GO TO 4000
  982 FORMAT(1H ,14X,2A8,',',A8)
  911  WORD = TAPSTO(3)
       J = WORD
       WORD = TAPSTO(2)
       IF (WORD.EQ.0.0) WORD=AQ8(2)
      WRITE(IOUTAP,983) AQ3(INSTR2),WORD,J,TAPSTO(4),TAPSTO(5),TAPSTO(6)
C
       GO TO 4000
  983 FORMAT(1H ,14X,2A8,'(',I5,')',3F10.6)
C
  913  WORD = TAPSTO(2) + 4.0D0
       N = WORD
       IF (NUMWDS.EQ.3) GO TO 918
       IF (NUMWDS.EQ.4) GO TO 915
       WORD = TAPSTO(5)
       J = WORD
      WRITE(IOUTAP,984) AQ3(INSTR2),PARM(1),AQ4(N),TAPSTO(3),TAPSTO(4),J
     1,TAPSTO(6),TAPSTO(7),TAPSTO(8)
       GO TO 4000
  984 FORMAT(1H ,14X,2A8,',',A8,',',F9.4,',',A8,'(',I5,')',3F9.4)
C
  915 WRITE(IOUTAP,985) AQ3(INSTR2),PARM(1),AQ4(N),TAPSTO(
     13),PARM(160),TAPSTO(4)
       GO TO 4000
  985 FORMAT(1H ,14X,2A8,',',A8,',',F9.4,',',A8,',',F9.4)
C
  917 WRITE(IOUTAP,986) AQ3(INSTR2),INSTR2
       GO TO 4000
  986 FORMAT(1H ,14X,A8,I1)
  918 WRITE(IOUTAP,988) AQ3(1),PARM(1),AQ4(N),TAPSTO(3)
       GO TO 4000
  988 FORMAT(1H ,14X,2A8,',',A8,',',F9.4)
C
C...   THE FOLLOWING INSTRUCTIONS OUTPUT THE REGION FLAGS...
 1000 WRITE(IOUTAP,1001) (TAPSTO(I),I=1,NUMWDS)
      GO TO 4000
 1001 FORMAT(1H ,1X,'REGION'/(5X,4Z18))
C...   THE FOLLOWING INSTRUCTIONS OUTPUT THE SPECIAL ROUTINE PARAMETERS.
 1100 WRITE(IOUTAP,1101) (TAPSTO(I),I=1,NUMWDS)
      GO TO 4000
 1101 FORMAT(1H ,14X,'** POCKET **  PARAMETERS ARE --'/(29X,4F12.6))
C
C...   THE FOLLOWING INSTRUCTIONS OUTPUT THE SPECIAL PROGRAMS...
 1200  IF(INSTR2.EQ.2) GO TO 1210
      WRITE(IOUTAP,1201) (TAPSTO(I),I=1,NUMWDS)
       GO TO 4000
 1210 WRITE(IOUTAP,1202) (TAPSTO(I),I=1,NUMWDS)
       GO TO 4000
 1201 FORMAT(1H ,14X,'** SPECIAL PROGRAM. CALL/ ',A8/(41X,4F12.6))
C
 1202 FORMAT(1H ,14X,'** SPECIAL PROGRAM. CALL/ ',A8/(41X,2(A8,' = ',F12
     1.6)))
 1300  GO TO (1301,1302,1303,1304),INSTR2
 1303  IT = ITA(2)
       IF(KFLAGS(7).NE.0) GO TO 1350
       CALL CERROR
       GO TO 4000
 1350 NKOM=TAPSTO(1)
      CALL LERROR (NKOM)
       GO TO 4000
 1301  N = 2*(ITA(2)+1) - 1
 1305 WRITE(IOUTAP,1306) AQ2(N),AQ2(N+1)
       GO TO 4000
 1302  N = 5
       GO TO 1305
 1304  N = 2*(ITA(2)+3) +1
       GO TO 1305
 1306 FORMAT(1H ,14X,2A8)
C...  THE FOLLOWING INSTRUCTIONS OUTPUT THE FINI
 3500 WRITE(IOUTAP,3510)
 3510 FORMAT(1H ,1X,'** FINI **')
      IF(KFLAGS(7).EQ.0) GO TO 4000
 3520 IF(IWAVEN)4000,4000,3530
 3530 CALL LERROR(14000)
C...  THIS IS THE COMMON RETURN POINT OF THIS SUBROUTINE
 4000 IF (INDEXX-1) 4002,4001,4001
 4001 IRECNO=III
 4002 RETURN
C...  END OF CLPRNT SUBROUTINE
       END

