      SUBROUTINE AERR(KARG)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4,MODIFICATION 4 ***
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*4 AB
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,
     1TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
      COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
      COMMON/A2CMMN/ADUM(75), EPS1(1), EPS2(1), EPS3(1), EPS4(1),
     1 EPS6(1), EPS8(1), TAU(1), TAU1(1), TAU2(1), AAADUM(516),
     2 IIIDUM(5), ISFTYP(1), ITLON(1), JJJDUM(233), BBBDUM(536)
      COMMON/A2CMMN/ IS, IIS, IT, IIT, IPS,
     1IIPS      ,IDS       ,IIDS      ,ICS       ,IICS      ,IGS       ,
     2IIGS      ,ICDEFL    ,ICDEFS    ,IAUTPS    ,IGO       ,ICRDCT    ,
     3ICUT      ,IGTFLG    ,INOPS     ,ISRCH     ,IOFSET    ,ISTRUP    ,
     4I3DFLG    ,MULOUT    ,MULTAX    ,NUMAX     ,NUMSFS    ,NUMSUR    ,
     5IGOUG     ,IPDPL     ,NUMDIM    ,IRSTRT    ,ICSCNT    ,I3        ,
     6I31       ,J         ,JA        ,JL        ,JS        ,JT        ,
     7KC        ,KND       ,KR        ,L         ,INCFS     ,NP        ,
     8IBEGIN    ,           IFAR1     ,IK        ,INS1      ,ITNFLG    ,
     9IVAMAX    ,IWS       ,IIWS      ,IZ        ,NEXT1     ,NEXT2
      COMMON/A2CMMN/ NPTS ,NUMPT1 ,JAM ,JAP ,JTUSED ,
     1IFRL      ,N         ,M         ,MDIC      ,JBR       ,JCKR      ,
     2JCPR      ,JCR       ,JDR       ,JGR       ,JMIN      ,JMINR     ,
     3JPR       ,JPXR      ,JTR       ,JCNT1     ,JCNT2     ,JCNT3     ,
     4JSW       ,JTKF      ,LISV      ,LSV       ,IPT       ,JFIND     ,
     5IC        ,ICC       ,IL        ,K         ,NUMPTS    ,IAMDCT    ,
     6IFL2      ,J5        ,J6        ,JW6       ,J10       ,J12       ,
     7J13       ,J40       ,J43       ,J54       ,J103
      COMMON/A2CMMN/ BDUM(2100) ,IER ,INSTR1 ,INSTR2 ,NWDS , ICL  ,
     1NREC      ,IRECNO    ,ITRFLG    ,NW        ,IDUMMY
      COMMON/A2DYDP/ KDYNFQ(12), NKFQ
      COMMON/TAUMD1/     SVTAU1,SVTAU2,SVTAU,SVEPS1,SVEPS8,SVEPS2,SVEPS3
     1,SVEPS4,SVEPS6,MTAU
      COMMON/TAUMD2/               SAVTT,SAVTO,SAVTI,SAVT1,SAVT2,SAVT3,
     1SAVT4,SAVT6,SAVT8,ISMATA, IISMAT,KCHNGE, KON, KST
C    INITIALIZE AMIND RETURN FLAG
      JMIN = 0
      IF(KARG)88881,900,88882
88881 IF(ICOUNT .GE. 5) GO TO 88882
      GO TO 88884
88882 IF(MTAU .NE. 1) GO TO 88883
      TAU1(ICS) = SVTAU1
      TAU2(ICS) = SVTAU2
      TAU(ICS) = SVTAU
      EPS1(ICS) = SVEPS1
      EPS8(ICS) = SVEPS8
      EPS2(ICS) = SVEPS2
      EPS3(ICS) = SVEPS3
      EPS4(ICS) = SVEPS4
      EPS6(ICS) = SVEPS6
      MTAU = 0
88883 IF(KCHNGE .NE. 1) GO TO 88884
      TAU(ISMATA) = SAVTT
      TAU1(ISMATA) = SAVTO
      TAU2(ISMATA) = SAVTI
      EPS1(ISMATA) = SAVT1
      EPS2(ISMATA) = SAVT2
      EPS3(ISMATA) = SAVT3
      EPS4(ISMATA) = SAVT4
      EPS6(ISMATA) = SAVT6
      EPS8(ISMATA) = SAVT8
      ITLON(IISMAT) = KON
      ISFTYP(IISMAT) = KST
      KCHNGE = 0
C...
88884 CONTINUE
      DIMENSION AB(2), ISAVE(10)
       DATA AB(1),AB(2)/4H**AE,4HRR**/
C...
C...             OUTPUT ANY POINTS IN BUFFER
C...
      DATA LNREC,LNW/0,0/
      IARG = KARG
C...IARG=ACTUAL MESSAGE NUMBER
      IF(IARG) 10,900,20
   10 IF((NW.EQ.LNW).AND.(NREC.EQ.LNREC)) GO TO 30
      ICOUNT = 1
      LNW = NW
      LNREC = NREC
      GO TO 31
   20 ISAVE(1) = IARG
      IAUTPS = 0
      ICOUNT = 1
      IST = 1
      GO TO 46
   30 ICOUNT = ICOUNT + 1
   31 ISAVE(ICOUNT) = IARG
      IF(ICOUNT - 6) 35,40,40
   35 IF(IVAMAX - 3) 900,44,44
   40 IARG = 2201
      ICOUNT = ICOUNT + 1
      ISAVE(ICOUNT) = IARG
      IF(IVAMAX.LE.2) GO TO 45
   44 IST = ICOUNT
      GO TO 46
   45 IST = 1
   46 CALL ATAPE
      NW = 0
      ISWT = 0
      IF(IL.NE.0) GO TO 400
      IF(ICLPRT.EQ.1) GO TO 400
      IF(IARG) 200,900,300
  200 CALL ASTOR(1,4,ARG,8)
      NCLREC = NCLREC + 1
      ISWT = 1
      CALL ATAPWT(CLTAPE,KER,4,NCLREC,1,13000,1,4,1,ARG,1,ARG,0,ARG,0)
      ICLPRT = -1
C...    FLAG SECTION 3
      KFLAGS(4) = 1
      GO TO 400
  300 ICLPRT = 1
  400 DO 450 II=IST,ICOUNT
      NCLREC = NCLREC + 1
      CALL ASTOR(ISAVE(II),4,ARG,8)
      CALL ATAPWT(CLTAPE,KER,4,NCLREC,1,13000,1,3,1,ARG,1,ARG,0,ARG,0)
  450 CONTINUE
      IF(ISWT) 500,590,500
  500 NCLREC = NCLREC + 1
      CALL ASTOR(0,4,ARG,8)
      CALL ATAPWT(CLTAPE,KER,4,NCLREC,1,13000,1,4,1,ARG,1,ARG,0,ARG,0)
C                OUTPUT ERROR COMMENT
  590 IF(IARG) 600,900,610
  600 GO TO (900,900,750,800),IVAMAX
  610 GO TO (850,750,750,800),IVAMAX
  750 IF(I3) 800,840,800
  800 NKFQ = 1
      IBMSV = KDYNFQ(1)
      KDYNFQ(1)=1
      WRITE (IOUTAP,1000)  IARG
 1000 FORMAT(1H0/22H ERROR OR WARNING NO.  I5/)
      CALL BDYNDP(AB(1),1,111111)
      KDYNFQ(1) = IBMSV
      NKFQ=1
  840 IF(IARG) 900,900,850
  850 IWAVEN = 2
      IRSTRT=1
      ICOUNT = 0
C...  UNRECOVERABLE ERROR FROM ASEC2 - TERMINATE.
      IF(IARG.EQ.10.OR.IARG.EQ.41) CALL ASEC2C(9,ISTX2)
      CALL ASEC2
  900 RETURN
      END

