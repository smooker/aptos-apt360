      SUBROUTINE APREPA(JBR)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 2, MODIFICATION 0 ***
C
      IMPLICIT REAL*8(A-H,O-Z)
       INTEGER PUNTAP
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/AVST/VST(7200)
      DIMENSION DEFTAB(1000)
      EQUIVALENCE(VST(7200),DEFTAB(1000))
      DIMENSION D(1000)
      EQUIVALENCE (DEFTAB(1),D(1))
C               *          *          *          *          *
      DIMENSION SMAT(12)
      COMMON/APRBRK/SMAT,XXXX1,XXXX2,XXXX3,XXXX4,ANS1,ANS2,ANS3,
     1 KTR,KWORD,JMOD2,JMOD1,INKX,KMOVE,L1,L2,KFRNT,KADD,KADD1
C
C...  IF TRANSFORM IS NECESSARY , SET INDICATOR
C...  AND BRING IN MATRIX.
C
      IF(IDEFTB(4)-110)1002,1000,1002
 1000 KTR=1
      KWORD=KWORD+14
      DO1001I1=1,12
      SMAT(I1)=D(I1+5)
 1001 CONTINUE
C
C...  MOVE POINTS TO REAR OF AREA
C
 1002 KMOVE=IDEFTB(1)
      DO1038I2=1,KMOVE
      L1= 996-I2
      L2=IDEFTB(1)+ 2-I2
      D(L1)=D(L2)
 1038 CONTINUE
C
C...  DETERMINE CUBIC METHOD
C...  DETERMINE CUBIC METHOD AND SET JMOD2
C...  EQUAL TO 1 FOR FOURPT , 2 FOR TWOPT ,
C...  3 FOR PTSLOP , 4 FOR PTNORM , AND 5 FOR
C...  SPLINE . ERROR IF NONE OF ABOVE .
C
      IF(IDEFTB(3)-101)1003,1009,1003
 1003 IF(IDEFTB(3)-102)1004,1010,1004
 1004 IF(IDEFTB(3)-103)1005,1011,1005
 1005 IF(IDEFTB(3)-104)1006,1012,1006
 1006 IF(IDEFTB(3)-105)1007,1013,1007
 1007 WRITE (IOUTAP,1008)
 1008 FORMAT(26H0TABCYL MODIFIER 2 INVALID)
      JSUBER=1003
      RETURN
 1009 JMOD2=1
      GOTO1014
 1010 JMOD2=2
      GOTO1014
 1011 JMOD2=3
      GOTO1014
 1012 JMOD2=4
      GOTO1014
 1013 JMOD2=5
C
C...  DETERMINE HOW POINTS DEFINED AND ROTATION MATRIX
C...  JMOD1 EQUALS 1 FOR RTHETA , 2 FOR NOZ , 3 FOR
C...  NOY , 4 FOR NOX , 5 FOR XYZ , AND 6 FOR
C...  THETAR . ERROR IF OTHER .
C
 1014 IF(IDEFTB(2)-106)1015,1021,1015
 1015 IF(IDEFTB(2)-16)1016,1022,1016
 1016 IF(IDEFTB(2)-15)1017,1024,1017
 1017 IF(IDEFTB(2)-14)1018,1025,1018
 1018 IF(IDEFTB(2)-108)20,1026,20
   20 IF(IDEFTB(2)-107)1019,21,1019
 1019 WRITE (IOUTAP,1020)
 1020 FORMAT(26H0TABCYL MODIFIER 1 INVALID)
      JSUBER=1003
      RETURN
 1021 JMOD1=1
      GOTO1023
   21 JMOD1=6
      GOTO1023
 1022 JMOD1=2
 1023 D(8)=0.0
      D(9)=0.0
      D(10)=1.0
      GOTO1034
 1024 JMOD1=3
      D(8)=0.0
      D(9)=1.0
      D(10)=0.0
      GOTO1034
 1025 JMOD1=4
      D(8)=1.0
      D(9)=0.0
      D(10)=0.0
      GOTO1034
 1026 JMOD1=5
      IF(KTR)1031,1027,1031
 1027 IF(IDEFTB(4)-3011)1028,1030,1028
 1028 WRITE (IOUTAP,1029)
 1029 FORMAT(53H0TABCYL AXIS VECTOR GIVEN INCORRECTLY WITH XYZ FORMAT)
      JSUBER=1003
      RETURN
 1030 D(8)=D(5)
      D(9)=D(6)
      D(10)=D(7)
      GOTO1033
 1031 IF(IDEFTB(18)-3011)1028,1032,1028
 1032 D(8)=D(19)
      D(9)=D(20)
      D(10)=D(21)
      INKX=5
      XXXX1=D(8)
      XXXX2=D(9)
      XXXX3=D(10)
      XXXX4=1.0
      JBR = -1
      RETURN
 1034 JBR = 0
      RETURN
 1033 JBR = 1
      RETURN
      END

