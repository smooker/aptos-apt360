      SUBROUTINE APRFIX(IOP,IRET)
C
C...  IOP=1, SET 4 BYTE INTEGER COMBINATION OF VST(NAMSUB+1) TO (-,-)
C            TO REPRESENT A DIMENSIONED SCALAR VARIABLE
C...  IOP=2, SET 4 BYTE INTEGER COMBINATION OF VST(NAMSUB+1) TO (-,+)
C            TO REPRESENT A DIMENSIONED SURFACE VARIABLE
C...  IOP=3, SET IRET=1, IF VST(NAMSUB+1) REPRESENTS DIM. SCALAR VAR.
C            SET IRET=2, IF VST(NAMSUB+1) REPRESENTS DIM. SURFACE VAR.
C            SET IRET=0, IF NEITHER CASE APPLIES
C
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
      COMMON/AVST/VST(2750),PTPP(2225),CANON(2225)
      INTEGER*4 IVST(5500)
      EQUIVALENCE(IVST(1),VST(1))
      INTEGER AMATOD,AEXTRA,AMDTOA,AEXTRD,AEXCH,DEBUG,SUM
      REAL*8 INWORD,NEWONE,NAME,IDIS,MACNAM,KRFSYS
C
      INL=K2*(NAMSUB+1)
      INH=INL-K1
      GOTO(20,10,30),IOP
 10   IVST(INL)=-IVST(INL)
      IVST(INH)=-IVST(INH)
      RETURN
 20   IVST(INH)=-IVST(INH)
      RETURN
 30   IF(IVST(INH)) 50,40,40
 40   IRET=0
      RETURN
 50   IRET=K1
      IF(IVST(INL)) 60,60,70
 60   RETURN
 70   IRET=K2
      RETURN
      END

