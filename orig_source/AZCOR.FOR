      SUBROUTINE AZCOR(POINT,IBMIND)
      IMPLICIT REAL*8 (A-H,O-Z)
      COMMON/A2CMMN/ADUM(720) ,TE(3) ,TEK(3) ,TEL(3) ,TES(3) ,TA(3) ,
     1TAK(3)    ,TAL(3)    ,PMOVE(3)  ,TI(3)     ,TIK(3)    ,TIL(3)    ,
     2U2(3)     ,UVEC(3)   ,VTEM(3)   ,CMOVE(3)  ,EX(3)     ,EY(3)     ,
     3EZ(3)     ,VNUL(3)   ,TM(3)     ,DIR(3)    ,AXIS(3)   ,AXIS1(3)  ,
     4AXIS2(3)  ,AXIS3(3)  ,REFPNT(3) ,RGT(3)    ,FWD(3)    ,UP(3)     ,
     5ZLNORM(3) ,ZLPNT(3)  ,TNDIR(3)  ,VA(3)     ,TMVCMP(3) ,P1(3)     ,
     6P2(3)     ,PNT(3)    ,PNT1(3)   ,OLDU1(3)  ,OGLE(3)   ,RZERO(3)  ,
     7TANMOT(3) ,TLEND1(3) ,V(3)      ,CEND(3)   ,DELMOT(3) ,D2(3)     ,
     8DNMOT(3)  ,AX4(3)    ,A         ,B         ,C         ,RA        ,
     9HI        ,ALPHA     ,GAMMA     ,CAGL      ,SAGL      ,COM1
      COMMON/A2CMMN/ COM4, COSTH, CTOCL, DIAM, DIF,
     1DIFOUT    ,DINC      ,DP        ,DPE       ,DPI       ,DPL       ,
     2DPMAX     ,DP1       ,DPCNT     ,DSMOV     ,D1        ,D2A       ,
     3EL1       ,EL2       ,FIPNT     ,FLIPCK    ,HAFDIA    ,HCHORD    ,
     4OFFSET    ,PROD1     ,PROD2     ,PSI       ,RADNO     ,RC1       ,
     5RDRM      ,RDRN      ,RONE      ,RZEROL    ,SAVE1     ,SIUTH     ,
     6TANGL     ,THETA     ,ALP       ,EPS7      ,VAMAX     ,VL        ,
     7ZDOTC     ,ZGAMMA    ,ZIGN      ,ZL        ,ZL1       ,ZL2       ,
     8ZNPTS     ,TOLBND    ,CENDIS    ,CENLEN    ,CHORD     ,
     9           ABCD(2)   ,ACARD(2)  ,SAVE(6)   ,CUTDAT(7) ,TEM(10)
      COMMON/A2CMMN/ TEMP(20), TCDAT(260), QEQUIV(20)
      COMMON/A2CMMN/BDUM(52) ,PROBUF(100) ,CANSTO(2000) ,IER ,INSTR1 ,
     1INSTR2 ,NWDS ,ICL ,NREC ,IRECNO ,ITRFLG ,NW ,IDUMMY
      COMMON/A2CTDF/        TLHITE(1) ,TANHI(1)  ,TANLO(1)  ,UMAX(1)   ,
     1R1(1)     ,CORRAD(1) ,TCONT(1)  ,TLINC(65)
      DIMENSION  SINL(1), COSL(1), TLLDAT(1)
      EQUIVALENCE(SINL(1),TANHI(1)), (COSL(1),TANLO(1)), (TLLDAT(1),
     1TCONT(1))
      COMMON/A2FPC / Q15X01,QP9X01    ,QP6X01    ,QP5X01    ,QP4X01    ,
     1QP0001    ,QP001     ,QP01      ,QP1       ,Q1P       ,Q10P      ,
     2Q1000P    ,Q1PE5     ,Q1PE6     ,Q1PE10    ,Q1PE20    ,Q1PE30    ,
     3Q1PE36    ,Q1PE38    ,QP8X01    ,QP7X01    ,
     4QP4X09    ,QP9       ,QP99      ,QP995     ,QP997     ,QP999     ,
     5QP9999    ,QP4X95    ,QP5X95    ,QP6X9     ,QP7X9     ,
     6QP6X05    ,QP5X05    ,QP4X05    ,QP0005    ,QP005     ,QP05      ,
     7QP5       ,Q5P       ,                                 Q4X045    ,
     8QP0002    ,QP0047    ,QP017     ,Q1RAD     ,QP0349    ,QP125     ,
     9QP6       ,QP2       ,QP2499    ,QP25      ,QP3
      COMMON/A2FPC / QP7   ,QP75      ,QP8       ,QP866     ,Q1P01     ,
     1Q1P1      ,Q1P2      ,Q1P25     ,Q1P5      ,Q2P       ,Q2P5      ,
     2Q3P       ,Q3P5      ,Q4P       ,Q8P       ,Q11P      ,Q45P      ,
     3Q90P      ,Q130P     ,Q4500P    ,Q9000P    ,QP02      ,QNUL      ,
     4QPIE       ,QFIL(9)
C      CORRECTS COMPUTED CUTTER LOCATION FOR Z VALUE
C     MORE ACCURATELY8 MOVES CUTTER UP OR DOWN ALONG ITS AXIS
C      UNTIL THE CUTTER END POINT IS IN A PLANE PARALLEL TO
C      THE PART SURVACE PLANE, AND WHICH PLANE ALSO CONTAINS THE
C      ORIGINAL CUTTER END POINT TE , WHERE THE CUTTER WAS AT THE
C      START OF I-D PROCESSING
C
C      POINT IS THE  POINT TO BE CORRECTED
C      IBMIND HAS THREE VALUES     -1   FOR FIRST TIME IN MEANS
C      COMPUTE ONLY THE PLANE VECTOR AND D VALUE
C      0 MEANS NOT LAST POINT ... CORRECT AND OUTPUT
C      1 MEANS IS LAST POINT ... CORRECT, OUTPUT, AND FLUSH BUFFER
C
C
      DIMENSION POINT(1), VSPEC(3)
C      BRANCH ON INPUT SWITCH
      IF(IBMIND.NE.-1) GO TO 10
C      INITIALIZATION BRANCH
C
      CALL AVDOT(POINT,CANSTO(5),DSPEC)
C     COMPUTES VALUE OF D FOR SPECIAL PLANE
C      CHECK THAT TOOL AXIS IS NOT PARALLEL TO PS PLANE
      CALL AVDOT(TA,CANSTO(5),DENOM)
C      DENOM WILL BE USED IN THE LATER CALCULATIONS
C      REVERSE IT, AS WE WANT THE VECTOR TO POINT IN
C      THE NEGATIVE TOOL AXIS DIRECTION WHEN OFFSETTINE TO THE PALEN
      DENOM = - DENOM
      IF(DABS(DENOM).LT.QP001) CALL AERR(725)
C      SET UP PLANE VECTOR
      CALL AVSUB(VNUL,TA, VSPEC)
      RETURN
C      NON INITIALIZATION BRANCH ... MAJE CORRECTION
   10 CONTINUE
C      THE CALCULATION IS MUCH THE SAME AS IN DDPLANE
C      COMPUTE THE DIRECTED DISTANCE TO THE SPECIAL PLANE FROM THE
C      CURRENT CUTTER LOCATION AND MOVE THE CUTTER THAT MUCH ALONE THE T
      CALL AVDOT(POINT,CANSTO(5),ANS)
      ANMOV = (DSPEC-ANS)/DENOM
      CALL AVMULT(VSPEC,ANMOV,VTEM)
      CALL AVSTO(TE,TEK)
      CALL AVADD(POINT,VTEM,TE)
C      OUTPUT
      CALL ASTOS
C      FLUSH BUFFER IF TOLD TO DO SO
      IF(IBMIND.EQ.0) RETURN
      IER = -10
      CALL ATAPE
      NW = 0
      RETURN
      END

