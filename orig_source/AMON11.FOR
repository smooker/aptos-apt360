      SUBROUTINE AMON11
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C
      IMPLICIT REAL*8(A-H,O-Z)
       REAL*8 INWORD,NAME,IDIS,MACNAM,KRFSYS
       LOGICAL*1 LCLAS1(2400),GBRN(2)
       INTEGER*2 JBRN/0/,KSYNB(400),LCLAS2(1200),LMENT2(2400)
      INTEGER AMATOD,AEXTRA,AMDTOA,AEXTRD,AEXCH,DEBUG,SUM
      COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST
     1 ,NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(6)
C     THIS PROGRAM PROCESSES VOCABULARY CLASSES 11 THRU 32
C          COMMON  STORAGE
C               *          *          *          *          *
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,
     1TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
      EQUIVALENCE(TAPES4,ERRTAP)
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
      COMMON/AMXTAB/MAXTAB,MAXVS1,MAXVS2,MAXPTP,MAXSCL,MAXVS,MAXVST,MXPT
     1PP,MXCAN,MXSRCN,MAXSLR,MAXELM,MAXPOT
       COMMON/AMOTCM/PINT(30),IFURST,JPTIND,NOW,JSUB,KRESLT,KRSLT2
     1,NWDS,ITS,NEXT,MULTAX
      COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
      COMMON/ASYNTB/SYNB(100),INSYN,MAXSYN
      COMMON/AINPOT/INWORD(14),MORE,IFIRST
      COMMON/ASCALR/SCALR(180),ISCWS,NSURF,LOCTEM,IARGTP
      COMMON/APARTB/ILPCNT,IRPCNT,ILVCNT
      COMMON/APRTAB/ISTARP,IENDP,NMOVE,NL,ITSQ,LINDX
      COMMON/AVST/VST(2750),PTPP(2225),CANON(2225)
       DIMENSION IPT(600),IVST(5500)
      COMMON/ABREAK/NEXTNW,NRELCN,KANLCN,LOCSEQ,NEXTCN,NWONRD,LPLOCN,
     1 JSW4,ISN,K,MXLOOP,JSW2,JSAV,JSW1,MAXMV,MXNEST,INILL,KF
      COMMON/AMACRO/LIMCAN,LMDW,NITEMS,JWHAT,MACREC,MACVST,MACERR
      COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
       EQUIVALENCE (PT(1),IPT(1)),(VST(1),IVST(1))
      COMMON/AMCSTF/MACNAM(5),MACCUR,MACLCN(5),MACRD,MACSTR(5),NMACVR
     1 ,NUMIDS,IDLOCN,MACIDS(5),ISVID
      COMMON/ADATA1/ANODEF,BLANX,BLANKS,SYN,TLAXIS,DUMMY,PLENT,LOOPST
     1 ,LOOPND,MACRO,NTRMAC,NCALL,LAPTH,JAPTH,IPLUS,NCOMMA,IFF,IC(10),
     2 LLASS
      COMMON/AKLAS7/PPSEQ1,PPSEQ2,IDIS,IISN,IDVST,KFK
      COMMON/ALIBRY/AMACVR(50),AMACVL(50),MACICL(50),DEFNAM,SEGNAM
     1 ,IVARCT,ISYSMC,IRDMOD,LUUP,NWUNRD,NOLIBR
      DIMENSION AWRONG(7),ANERR(7),ALIBER(14)
       EQUIVALENCE (ICLASS(1),LCLAS1(1),LCLAS2(1)),(GBRN(1),JBRN)
       EQUIVALENCE (SYNB(1),KSYNB(1)),(ELMENT(1),LMENT2(1))
      DATA ALIBER/' THE LIBRY STATEMENT WITHIN A SEGMENT READ WILL CAUSE
     1 THE SYSTEM MACROS TO BE   READ IN AT TIME OF FIRST CALL   '/
      DATA AWRONG/' THIS VOCABULARY WORD NOT IMPLEMENTED IN THIS PROCESS
     1OR '/
      DATA  ANERR/' INCORRECT TUNEUP FORMAT.  MUST BE TUNEUP/VST,PTPP,CA
     1NON'/
C
       INTEGER SLASH/Z00000304/,ICOMMA/Z00000904/
C
C...  SET FLAG JBRN EQUAL VOC.CLASS AND BRANCH ON VALUE
      JBRN = KLASS-10
C...    THE BRANCH ON JBRN < 0 IS NEVER TAKEN. THE STATEMENT PREVENTS
C       COMPILER ERROR WHEN LIBRY PROCESS STATEMENTS ARE DISABLED
      IF (JBRN.LT.0) GO TO 8000
      GOTO (3320,3340,3345,3330,3360,3570,3760,3950,4000,4010,4170,4170
     1,4170,4000,4180,4295,4295,4300,4000,4000,4000,4325,5000,6000,7000)
     2,JBRN
C
C...     LOOPST - LOOPND (CLASS 11)
 3320 GO TO (3330,3337),KLASTP
C...  LOOPND - RESET FLAGS AND RETURN FOR MORE INPUT
 3337       IF(LOOP.NE.0) GO TO 3338
C...  LOOPND FOUND WITHOUT A CORRESPONDING LOOPST
      JSUBER = 208
      GO TO 998
C...  THIS IS THE END OF LOOP MODE - TURN MODE FLAG OFF
 3338 LOOP = 0
      NWONRD = 0
C...     TURN OFF LOOP MODE FLAG FOR PASS TWO
       IPT(1) = 19
       IPT(2) = 1
       PT(2) = 0.0
      INPTP = 2
      JMODE = 5
      CALL APTPUT
      JSW4 = 1
C...  REWIND ERRTAP
      CALL ATAPOP(ERRTAP,1,IOFLAG)
      GO TO 60
C
 3330 JSUBER = 209
      GO TO 998
C
C...     POCKET (CLASS 12)
 3340  CALL APOCK1
       GO TO 60
C
C...     PSIS (CLASS 13)
C...     CHECK FOR IMPLICIT NESTED PLANE DEFINITION
 3345  CALL AHELPR(INILL)
            IF(JSUBER.NE.0) GO TO 998
       CALL AMOTIN
      GO TO 60
C
C...     DEBUG, DYNDMP (CLASS 15)
 3360 GO TO(3500,3370),KLASTP
C...  DYNDMP
 3370 KFK = 2
C...  GENERATE A PTPP CLASS 7 RECORD
      CALL ACLAS7
C...  TRANSFER DYNDMP STATEMENT FROM ELMENT TO IPOTTY
C...  GENERATE A CLASS 6 PTPP RECORD AND SET UP ARELEM FLAGS
      CALL AFLAGS
      GO TO 998
C...  DEBUG
 3500 KFK = 1
      CALL ACLAS7
C...  SET LOCATION OF SLASH
      N = INILL+1
      NKY = N + 3
C...  SET UP FLAG TO OUPUT A DEBUG RECORD FOR A SINGLE SECTION ONLY
      NGOT = 1
C...  IS 1ST PARAMETER FOLLOWING SLASH APT MODIFIER ON  OR OFF
      IF ( AEXTRA(IBCLAS(N+1),2).EQ.29) GOTO 3530
      IF ( AEXTRA(IBCLAS(N+1),2).NE.31) GOTO 3550
C...  STATEMENT IS OF THE FORM  DEBUG/SECX, ON  -DETERMINE VALUE OF X
C...  BRANCH IF DEBUG IS FOR SECTION 1
      IF ( AMDTOA(IBCLAS(N+1),2).EQ.1) GOTO 3535
      IF(AMDTOA(IBCLAS(N+1),K2).NE.K2) GO TO 3550
C.... OUTPUT SECTION TWO DEBUG FLAG
C...  TEST 2ND PARAM FOR ON OR OFF CONDITION
 3510 IF ( AEXTRA(IBCLAS(NKY),2).NE.29 ) GOTO 3550
C...  BRANCH IF OFF SPECIFIED
      IF ( AMDTOA(IBCLAS(NKY),2).EQ.72) GOTO 3515
C...  ONLY MINOR MODIFIER  ON  ALLOWED
      IF ( AMDTOA(IBCLAS(NKY),2).NE.71 ) GOTO 3550
C.... SET SWITCH FOR ON
      IZW = 1
      GO TO 3520
C.... SET SWITCH FOR OFF
 3515 IZW = 0
C..   SET UP PTPP INTEGER PARAMETERS  PTPP(1) = C,N
 3520  IPT(1) = 6
       IPT(2) = 4
C...  PTPP(2) = NPT,NPR
       IPT(3) = 1
       IPT(4) = 1
C...  PTPP(3) = CL,SC
       IPT(5) = 13000
       IPT(6) = 1
C...  PTPP(4) = I,J DESCRIBE 1ST PARAM TO RITE OF SLASH
       IPT(7) = 1
       IPT(8) = 0
C...  PTPP(5) = K,L DESCRIBE 1ST PARAM TO RITE OF SLASH
       IPT(9) = 0
       IPT(10) = IZW
C...  SET INPUT VAR. TO APTPUT TO INDICATE A NORMAL TYPE OF MOVE TO PTPP
      JMODE = 5
      INPTP = 5
 3525 CALL APTPUT
            IF(JSUBER.NE.0) GO TO 998
      NGOT = NGOT-1
            IF(NGOT)  60, 60, 3510
C
C.... OUTPUT DEBUG FLAG FOR BOTH SECTIONS
 3530 NGOT = 2
C...  SET POINTER TO PROCESS PARAMETER THAT IMMEDIATELY FOLLOWS SLASH
      NKY = NKY-2
C...  ONLY MODIFIER WORD ON OR OFF ALLOWABLE
 3535 IF(AEXTRA(IBCLAS(NKY),K2).NE.29) GO TO 3550
      IF(AMDTOA(IBCLAS(NKY),K2).EQ.72) GO TO 3540
C...  ON IS ONLY ALLOWABLE PARAMETER NOW
      IF ( AMDTOA(IBCLAS(NKY),2).NE.71 ) GOTO 3550
C.... SET DEBUG ON FOR SECTION ONE
      DEBUG = 1
C...  SET UP A CLASS 8 PTPP RECORD  FOR DEBUG SECTION 1
       IPT(2) = 1
      GO TO 3545
C.... SET DEBUG OFF FOR SECTION ONE
 3540 DEBUG = 0
C...  SET UP A CLASS 8 PTPP RECORD - DEBUG -DEBUG/SEC1,OFF
       IPT(2) = 2
 3545  IPT(1) = 8
       N = 1
C...  NO. OF 8 BYTE WORDS IN PT TO BE MOVED TO PTPP
      INPTP = 1
C...  CALL APTPUT TO MOVE STMT IN PT TO THE PTPP TABLE
      GO TO 3525
C...  ILLEGAL DEBUG FORMAT
 3550 JSUBER = 22
      GO TO 998
C
C...     RESERV (CLASS 16)
 3570 IF ( LOOP.EQ.0) GOTO 3590
C...  RESERV NOT ALLOWED IN A LOOP OR MACRO
 3580 JSUBER=252
      GO TO 998
C...  CHECK FORMAT FOR SLASH FOLLOWING MAJ. WD.
 3590       IF(ICLASS(INILL+1).NE.SLASH) GO TO 7070
C...  SET LOC. OF 1ST PARAMETER FOLLOWING SLASH
 3610 N = INILL+2
       JTEMP1 = 4*N - 3
       GBRN(2) = LCLAS1(JTEMP1+3)
C...  CHECK ORDER - IS IT A,50 OR 50,A
 3620 GO TO(3640,3630,3670),JBRN
C...  ONLY A VAR. SYMB. OR A NUMBER IS ACCEPTABLE
 3630 JSUBER=253
      GO TO 998
C...  FORMAT MUST BE  RESERV/A,X  -ILLEGAL IF X IS NOT A FL.PT.NO.
 3640       IF(ICLASS(N+2).EQ.3) GO TO 3660
C...  VALUE NOT FOUND - FORMAT ERROR EXISTS
 3650 JSUBER=255
      GO TO 998
C...  LEGAL FORMAT  -  PROCESS RESERV/A,50
C...     NV IS SET EQUAL VAR.NAME, AND, NN IS SET EQUAL NUMERIC NUMBER
 3660 NV=N
      NN = N+2
      GO TO 3700
C...  1ST PARAMETER IS A NUMBER - 2ND  MUST BE A VAR.SYMBOL
 3670       IF(ICLASS(N+2).EQ.1) GO TO 3690
C...  DID NOT FIND PROPER ARRAY NAME
 3680 JSUBER=254
      GO TO 998
C...  LEGAL FORMAT  -  PROCESS  RESERV/50,A
 3690 NV = N+2
      NN=N
C...  CHECK FOR COMMA SEPARATING PARAMETERS
 3700       IF(ICLASS(N+1).EQ.ICOMMA) GO TO 3730
C...  NO COMMA
 3710  JSUBER = 7
      GO TO 998
C...  ENTER NAME IN VST
 3730  NAME = ELMENT(NV)
C...     MAKE SURE THIS IS A VARIABLE SYMBOL
            IF(ICLASS(NV).EQ.1) GO TO 3735
       JSUBER = 253
       GO TO 3748
 3735  CALL AVS1PT(J)
            IF(J.EQ.1) GO TO 3750
 3740 JSUBER=256
 3745  SUM = 1
 3748  CALL ADIAGP
      GO TO 3755
C...     TEST FOR ROOM FOR ARRAY
 3750  IT = ELMENT(NN)
            IF(MAXVS1+MAXVS2+IT.GT.MAXVST) GO TO 3756
C...     UPDATE VST REFERENCE
       JTEMP1 = 2*NAMSUB - 1
       IVST(JTEMP1+2) = MAXVS2
       IVST(JTEMP1+3) = -IT
      MAXVS2=MAXVS2+IT
 3755  N = N + 4
            IF(N.LE.JLMENT) GO TO 3620
       GO TO 60
C...     NOT ENOUGH ROOM FOR ARRAY
 3756  JSUBER = 15
       GO TO 3745
C
C...     SYN (CLASS 17)
 3760 IF (LOOP.EQ.0 ) GOTO 3780
C...  SYN NOT ALLOWED IN LOOP OR MACRO
 3770 JSUBER=353
      GO TO 998
C...  FORMAT CHECK -IS SLASH FOLLOWING MAJ WORD  SYN
 3780       IF(ICLASS(INILL+1).NE.SLASH) GO TO 7070
C...  SET POINTER TO LOC. OF SLASH
 3800  N = INILL + 1
 3810 IF(N.LT.JLMENT)GO TO 3820
C...  PRINT OUT SYN TABLE
       CALL APRINT(9)
      GO TO 60
C...  PROCESS A SYN PAIRED ENTRY
 3820 N = N+1
      IF(N.LT.JLMENT)GO TO 3840
 3830 JSUBER=351
      GO TO 998
C...  CHECK ORDER - IS IT VAR. SYMBOL, VOCAB. OR VOCAB, VAR. SYMBOL
 3840  JTEMP1 = 4*N - 3
       GBRN(2) = LCLAS1(JTEMP1+3)
            IF(JBRN-2)  3855, 3880, 3850
 3850 JSUBER=19
      GO TO 3940
C...  MUST BE SYMBOL, VOCAB.
 3855  GBRN(2) = LCLAS1(JTEMP1+11)
            IF(JBRN.EQ.2) GO TO 3870
 3860 JSUBER=356
      GO TO 3940
 3870 J = 0
      GO TO 3910
C...  MUST BE VOCAB., SYMBOL
 3880       IF(ICLASS(N+2).NE.1) GO TO 3900
 3890 J = 2
      GO TO 3910
 3900 JSUBER=355
      GO TO 3940
 3910       IF(INSYN+2.LE.MAXSYN) GO TO 3930
C...  SYN TABLE OVERFLOW
 3920 JSUBER=354
      GO TO 998
C...  ENTER IN SYN TABLE
 3930 NPJ  =  N + J
       SYNB(INSYN+1) = ELMENT(NPJ)
       INSTO = 4*INSYN - 3
       ICL2 = 2*(N+2-J) - 1
       LMEN4 = 2*ICL2 - 1
       GBRN(2) = LCLAS1(LMEN4+2)
       KSYNB(INSTO+8) = JBRN
       KSYNB(INSTO+9) = LCLAS2(ICL2)
       KSYNB(INSTO+10) = LMENT2(LMEN4+1)
       KSYNB(INSTO+11) = LMENT2(LMEN4+3)
       INSYN = INSYN + 2
 3940  N = N + 3
      GO TO 3810
C
C...     FINI (CLASS 18)
C...  SHOULD HAVE BEEN PROCESSED BY SUBROUTINE  ASCAN
C..  PROCESSOR ERROR
 3950 JSUBER = 6113
      RETURN
C..
C..
C...  ILLEGAL USE OF COMPUTING FUNCTION,MODIFIER, VOCAB. WORD, ETC.
 4000 JSUBER = 76
      GO TO 998
C
C...     TRANTO (CLASS 20)
 4010 N = INILL + 1
C...  CHECK FOR SLASH
            IF(ICLASS(N).NE.SLASH) GO TO 7070
 4040 N = N+1
C...  CHECK ID TYPE
       JTEMP1 = 4*N - 3
       GBRN(2) = LCLAS1(JTEMP1+3)
      GO TO(4070,4050,4060), JBRN
 4050 JSUBER=453
      GO TO 998
C...  NUMERIC ID
 4060 A=ELMENT(N)
      CALL AIFUN8(A,NAME)
      GO TO 4080
C...  VARIABLE ID
 4070 NAME=ELMENT(N)
C...  IS ID ALREADY IN VST
 4080 CALL AVS1CK(J)
      GO TO(4100,4090,4130,4130),J
 4090 JSUBER = 3
      SUM = 1
      GO TO 998
C...  NO - ENTER IN VST
 4100 CALL AVS1PT(J)
            IF(J.EQ.1) GO TO 4120
 4110 JSUBER=404
      SUM = 1
      GO TO 998
 4120  JTEMP1 = 2*NAMSUB - 1
       IVST(JTEMP1+2) = 8
       IVST(JTEMP1+3) = 0
 4130 IF(N.EQ.JLMENT)GO TO 4150
 4140 JSUBER=409
      GO TO 998
C...  OUTPUT A PTPP CLASS 6 RECORD FOR A PROTAP 6000 RECORD
 4150 JF = 1
C...  SET TO FORWARD TRANSFER FOR PASS TWO IF SUCH IS THE CASE
       JTEMP1 = 2*NAMSUB - 1
            IF(IVST(JTEMP1+3).EQ.0) JF = 0
       IPT(1) = 6
       IPT(2) = 5
C...  NPT, NPR
       IPT(3) = 1
       IPT(4) = 1
C...  PROTAP CLASS, SUBCLASS CODE
       IPT(5) = 6000
       IPT(6) = 7
C...  PARAMETER INDICATING A STATEMENT ID
       IPT(7) = 7
       IPT(8) = 0
       IPT(9) = JF
       IPT(10) = NAMSUB
      PT(6) = VST(NAMSUB)
      INPTP = 6
C...  INPUT ARG TO APTPUT INDICATES NORM TRANSFER OF A COMPLETE STATEMEN
C...   IN TEMP. BUFFER  PT  TO PTPP TABLE
      JMODE = 5
      CALL APTPUT
      GO TO 60
C
C...     POST PROCESSOR PARAMETERS (CLASSES 21-23)
 4170  CALL APARAM
      GO TO 60
C
C...     SYSTEM FLAGS (CLASS 25)
C...  CLPRNT, NOPOST, NOPLOT, PTONLY, CLTV, BRANCH ON SUBCLASS
 4180 GO TO (4200,4210,4220,4230,4280,4201), KLASTP
C
C....  CLPRNT STATEMENT
 4200 IF(INILL .LT. JLMENT)  GO TO 4201
C....  CLPRNT   (THIS FORM TAKES PRECEDENT OVER THE OTHER OPTIONS)
C...  CLPRNT = PRINT ENTIRE INPUT TO POSTPROCESSOR
      ICLPRT = 1
      GO TO 60
C...  FORMAT CHECK - IS THERE A SLASH FOLLOWING MAJ.WORD
 4201       IF(ICLASS(INILL+1).NE.SLASH) GO TO 7070
       ISTARP = ISTARP + 2
      CALL ACLAS7
       INPTP = 10
       CALL APTLOD
            IF(JPTIND.EQ.0) GO TO 4203
C....  ENTRY SHOULD BE A VOCABULARY MINOR MODIFIER
 4212  JSUBER = 81
      GO TO 998
 4203       IF(KRESLT.EQ.71) GO TO 4204
            IF(KRESLT.EQ.72) GO TO 4205
      IF(KLASTP.EQ.6) GO TO 4213
            IF(KRESLT.EQ.144) GO TO 4206
C....  ILLEGAL VOCABULARY WORD IF NONE OF THE ABOVE MODIFIERS USED
 4213  JSUBER = 76
      GO TO 998
C....  CLPRNT/ON
 4204  IPT(9) = 0
       IPT(10) = 1
      GO TO 4207
C....  CLPRNT/OFF
 4205 PT(5) = 0.
      GO TO 4207
C....  CLPRNT/OPTION
 4206  IPT(9) = 0
       IPT(10) = 2
C....  OUTPUT CLASS 6 PTPP RECORD
 4207  IPT(1) = 6
       IPT(2) = 4
       IPT(3) = 1
       IPT(4) = 1
       IPT(5) = 13000
      IF(KLASTP.EQ.6) GO TO 4208
       IPT(6) = 4
      IF(ICLPRT.NE.1) ICLPRT = -1
      GO TO 4209
 4208  IPT(6) = 5
 4209  IPT(7) = 1
       IPT(8) = 0
      INPTP = 5
      JMODE = 5
      CALL APTPUT
      GO TO 60
C
C...  NOPLOT - SUPPRESS EXECUTION OF ALL PLOT STATEMENTS IN PART PROGRAM
 4210 NOPLOT = 1
      GO TO 60
C
C...  NOPOST - SUPPRESS EXECUTION OF ALL SPECIFIED POSTPROCESSORS
 4220 NOPOST = 1
      GO TO 60
C
C...  PTONLY - CHECK FORMAT FOR SLASH
 4230       IF(ICLASS(INILL+1).NE.SLASH) GO TO 7070
 4250 IF(ELMENT(INILL+2).LE.3.)GO TO 4270
 4260 JSUBER=553
      GO TO 998
C...  IPTNLY EQUALS PARAMETER VALUE 1,2 OR 3
 4270  IPTNLY = ELMENT(INILL+2)
C...     IF PTONLY/3, PICK UP 'N' FOLLOWING SUBCODE
            IF(IPTNLY.NE.3) GO TO 60
            IF(INILL+4.EQ.JLMENT) GO TO 4272
 4271  JSUBER = 129
       GO TO 998
C...     MAKE SURE PARAMETER GIVEN IS A NUMBER
 4272       IF(ICLASS(INILL+4).NE.3) GO TO 7090
       NCLREC = ELMENT(INILL+4)
      GO TO 60
C
C...  VOC. CLASS 25, SUBCLASS 5 - AUX. ARELEM IS TO BE USED
 4280 IF (JLMENT.EQ.3) GOTO 4284
C...  CLTV
      KFLAGS(2) = 0
      KFLAGS(3) = 1
      GOTO 60
C...  CLTV/OPTION
 4284 LTVMIT = 1
      GO TO 60
C
C...     MOTION, DIRECTION, AND TOOL POSITION COMMANDS (CLASSES 26, 27)
 4295  CALL AMOTIN
       GO TO 60
C
C...     PROCESS CANON/ON OR CANON/OFF STATEMENT (CLASS 28)
C...     TEST FOR SLASH
 4300       IF(ICLASS(INILL+1).NE.SLASH) GO TO 7070
C...     YES - MUST BE FOLLOWED BY ON OR OFF
       ISTARP = INILL + 2
       INPTP = 4
       CALL APTLOD
            IF(JPTIND.NE.0) GO TO 4212
            IF(KRESLT.EQ.72) GO TO 4302
            IF(KRESLT.NE.71) GO TO 4213
C...     CANON/ON
       IPT(2) = 5
       GO TO 4303
C...     CANON/OFF
 4302  IPT(2) = 6
 4303  IPT(1) = 8
       INPTP = 1
C
       JMODE = 5
       CALL APTPUT
       GO TO 998
C
C...     REGION, ENDREG (CLASS 32)
C...     AREGPR IS ONLY A DUMMY SUBROUTINE AT PRESENT
 4325  CALL AREGPR
      GO TO 998
C
C...     WARNING MESSAGE FOR INACTIVE VOCAB. WORDS (CLASS 33)
 5000  IPT(1) = 2
       IPT(2) = 8
       IPT(3) = 7
       IPT(4) = 2
      DO 5010 I = 3,9
 5010 PT(I) = AWRONG(I-2)
      INPTP = 9
      JMODE = 5
      CALL APTPUT
      GO TO 998
C
C...     TUNEUP (CLASS 34)
C...  SAVE CURRENT TABLE LIMITS IN CASE OF ERROR ON TUNEUP CARD
 6000 MVSAVE = MAXVST
      MPSAVE = MXPTPP
      MCSAVE = MXCAN
C...  IF CANON IS IN USE, TUNEUP CANNOT BE SPECIFIED
      IF(LIMCAN.GT.(MAXVST+MXPTPP)) GO TO 6070
C...  FLUSH OUT PTPP SO THE ORIGIN CAN BE RELOCATED
       JMODE = 6
      CALL APTPUT
C...  PROCESS ENTRIES - FORMAT IS         TUNEUP/VST,PTPP,CANON
      DO 6050  I=1,5,2
      IN = INILL + I + 1
C...  PARAMETERS MUST BE NUMERIC
            IF(ICLASS(IN).NE.3) GO TO 6070
      IJAZZ = ELMENT(IN)
      IF (I-3) 6010, 6020, 6030
C...  CHANGE VST MAXIMUM LENGTH
 6010 MAXVST = IJAZZ
      GO TO 6050
C...  CHANGE PTPP MAXIMUM LENGTH
 6020 MXPTPP = IJAZZ
      GO TO 6050
C...  CHANGE CANON MAXIMUM LENGTH
 6030 MXCAN = IJAZZ
            IF(MXCAN.LT.1300) GO TO 6070
            IF((MAXVST+MXPTPP+MXCAN).GT.MAXTAB) GO TO 6070
 6050 CONTINUE
      IF(IN.NE.JLMENT) GO TO 6070
      NEXTNW = MAXVST + 1
      LIMCAN = MAXVST + MXPTPP
      INDXPT = MAXVST + 2
      NRELCN = MAXVST + 1
      GO TO 998
C...  INCORRECT TUNEUP CARD - OUTPUT WARNING MESSAGE AND IGNORE CARD
 6070  IPT(1) = 2
       IPT(2) = 8
       IPT(3) = 7
       IPT(4) = 2
      DO 6080 I = 3,9
 6080 PT(I) = ANERR(I-2)
      INPTP = 9
      JMODE = 5
C...  RESET TABLE LIMITS TO ASSUMED VALUES
      MAXVST = MVSAVE
      MXPTPP = MPSAVE
      MXCAN  = MCSAVE
      CALL APTPUT
      GO TO 998
C
C     ENCOUNTERED LIBRY STATEMENT
C
 7000 IF (ICLASS(INILL+1).NE.SLASH) GO TO 7070
            IF((INILL+2).GT.JLMENT) GO TO 4271
C...     SAVE INDEX TO VST LOCATION OF FIRST NAME IN THIS STATEMENT
       MAXPOT = MAXVS1 + 2
C...     INCREMENT ELMENT SCANNING INDEX TO (NEXT) SYSTEM MACRO NAME
 7010 INILL = INILL+2
C...  CHECK FOR VARIABLE SYMBOL IN ELMENT TABLE
      IF (ICLASS(INILL).NE.1) GO TO 7080
      NAME = ELMENT(INILL)
C...  IS THERE ROOM IN VST FOR MACRO NAME
      IF((MAXVS1+2).GT.MAXVST) GOTO 7060
C...  PLACE SYSTEM MACRO NAME IN VST
      CALL AVS1PT(J)
 7020  JTEMP1 = 2*NAMSUB - 1
       IVST(JTEMP1+2) = 11
       IVST(JTEMP1+3) = 0
            IF(INILL.GE.JLMENT) GO TO 7030
            IF(ICLASS(INILL+1).NE.NCOMMA) GO TO 3710
       GO TO 7010
C...     SAVE INDEX TO VST ENTRY FOR LAST SYSTEM MACRO NAME
 7030  MAXVS = MAXVS1
C...  **********DISABLE TO READ SYSTEM MACROS WHEN FIRST CALLED*********
C...     TEST FOR SEGMENT READ MODE
           IF (IRDMOD.NE.0) GO TO 8000
C...     PICK UP FIRST SYSTEM MACRO NAME, AND SET FLAG TO READ IT IN
       SEGNAM = VST(MAXPOT)
       VST(MAXPOT) = BLANKS
       IRDMOD = -2
C...  ******************************************************************
       GO TO 998
C...     VST FULL
 7060  JSUBER = 15
       GO TO 998
C...     NO SLASH FOUND
 7070 JSUBER = 155
      GO TO 998
C...  VARIABLE SYMBOL NOT FOUND
 7080 JSUBER = 156
      GO TO 998
C...  IMPROPER PUNCTUATION
 7090 JSUBER = 132
      GO TO 998
C
C...     WARNING MSG FOR LIBRY STATEMENT IN SEGMENT READ
 8000 IPT(1) = 2
      IPT(2) = 15
      IPT(3) = 14
      IPT(4) = 2
      DO 8010 I=3,16
 8010 PT(I) = ALIBER(I-2)
      INPTP = 16
      JMODE = 5
      CALL APTPUT
C
   60 CONTINUE
  998 RETURN
      END

