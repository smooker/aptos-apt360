      SUBROUTINE AMON2
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C
      IMPLICIT REAL*8(A-H,O-Z)
      REAL*8 INWORD,NEWONE,NAME,IDIS,MACNAM,KRFSYS
       INTEGER DEBUG,SUM
       INTEGER*2 KRPREN(4)/0,Z0704,1,Z0B02/,IAT/0/
       LOGICAL*1 LCLAS1(2400),GAT(2)
C     THIS ROUTINE DETECTS AND STORES STATEMENT IDS
C          COMMON  STORAGE
C               *          *          *          *          *
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
      COMMON/AMXTAB/MAXTAB,MAXVS1,MAXVS2,MAXPTP,MAXSCL,MAXVS,MAXVST,MXPT
     1PP,MXCAN,MXSRCN,MAXSLR,MAXELM,MAXPOT
      COMMON/AILMTB/ELMENT(600),ICLASS(600),JLMENT
       EQUIVALENCE (ICLASS(1),LCLAS1(1)),(IAT,GAT(1))
       EQUIVALENCE (IRPREN,KRPREN(1)),(LOOPCD,KRPREN(3))
      COMMON/AINPOT/INWORD(14),MORE,IFIRST
      COMMON/ASCALR/SCALR(180),ISCWS,NSURF,LOCTEM,IARGTP
      COMMON/AVST/VST(2750),PTPP(2225),CANON(2225)
      COMMON/ABREAK/NEXTNW,NRELCN,KANLCN,LOCSEQ,NEXTCN,NWONRD,LPLOCN,
     1 JSW4,ISN,K,MXLOOP,JSW2,JSAV,JSW1,MAXMV,MXNEST,INILL,KF
      COMMON/AMACRO/LIMCAN,LMDW,NITEMS,JWHAT,MACREC,MACVST,MACERR
      COMMON/APTPP/PT(300),INPTP,NW,JMODE,KLASS,KLASTP,IRECN,NPT,NPR
      COMMON/AMCSTF/MACNAM(5),MACCUR,MACLCN(5),MACRD,MACSTR(5),NMACVR
     1 ,NUMIDS,IDLOCN,MACIDS(5),ISVID
      COMMON/ADATA1/ANODEF,BLANX,BLANKS,SYN,TLAXIS,DUMMY,PLENT,LOOPST
     1 ,LOOPND,MACRO,NTRMAC,NCALL,LAPTH,JAPTH,IPLUS,NCOMMA,IFF,IC(10),
     2 LLASS
      COMMON/AKLAS7/PPSEQ1,PPSEQ2,IDIS,IISN,IDVST,KFK
C..                                                                  D39
      INTEGER*2 I2VST(11000),ISB,IS
      INTEGER   IVST(5500)
      COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST
     1 ,NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
      EQUIVALENCE (VST(1),IVST(1),I2VST(1))
C...                                                                 D39
  320  GAT(2) = LCLAS1(4)
            IF(IAT.NE.4) GO TO 340
C...  STATEMENT CANNOT BEGIN WITH PUNCTUATION
  330  JSUBER = 5
      GO TO 998
C...
  340       IF(JLMENT.LE.2) GO TO 450
            IF(ICLASS(2).NE.IRPREN) GO TO 450
C...  SECOND ENTRY IS A ), MUST BE AN ID
            IF(ICLASS(3).NE.LOOPCD) GO TO 355
      IF(LOOP.NE.0)  GO TO 355
       K = 3
      GO TO 998
C...
  355  GO TO (400,370,390,330),IAT
C...
C...  VOCAB. WORD ILLEGAL HERE
  370 JSUBER=17
      GO TO 998
C...
C...  FLOATING PT. NO. - STORE AS PURE NUMERIC ID
  390 A=ELMENT(1)
      CALL AIFUN8(A,NAME)
      ELMENT(1) =NAME
       ICLASS(1) = 1
      GO TO 410
C...
C...  VARIABLE SYMBOL WHICH IS AN ID
  400 NAME=ELMENT(1)
C
C...     SYMBOL IS AN ID - SEE IF THERE ALREADY ARE ENTRIES
C...     IN VST FOR IT
  410  CALL AVS1CK(J)
      IF (J.GT.4) GOTO 425
      GOTO (415,425,440,430),J
C..
C..   ENTER NAME INTO  VST
  415 MAXVS1 = MAXVS1 + 2
      IF (MAXVS1.GE.MAXVST) GOTO 420
      VST(MAXVS1) = NAME
      NAMSUB = MAXVS1
      GOTO 440
C..                                                                  D39
C...     VST FULL - ENTRY COULD NOT BE MADE - ERROR
  420 JSUBER=15
      SUM = 1
      GO TO 998
  425 JSUBER = 3
      SUM = 1
      GO TO 998
C..                                                                  D39
C..   DUPLICATE STMT I.D.                                            D39
  430 IF (NAMSUB.LT.IDLOCN) GOTO 415
      IS = 2*(NAMSUB+1)
      JSUBER = 6
      IVST(IS) = 0
      SUM = 1
      IWAVEN = ISN
C..   DUPLICATE STMT I.D. - FLUSH PASS 2 PROCESSING  IWAVEN.NE.0     D39
      GOTO 445
C...
C
C...  SET VST STATUS FOR CROSS - REFERENCED ONLY
  440 NDX = INDXPT-MAXVST
      IS = 2*(NAMSUB+1)-1
      ISB = 2*(IS+1) -1
      IVST(IS) = 3
      I2VST(ISB) = IRECN+1
      I2VST(ISB+1) =NDX
C...
  445 IDIS=NAME
       K = 3
      IDVST=NAMSUB
C...  ID FOUND - GO HOME
      GO TO 998
C...
C...  STORE ID DATA FOR CLASS SEVEN PTPP DATA
  450  IDIS = 0
       IDVST = 0
       K = 1
  998 RETURN
      END

