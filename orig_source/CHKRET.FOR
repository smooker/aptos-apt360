      SUBROUTINE CHKRET(IHU,RAD,INTRCT,D)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 3, MODIFICATION 0 ***
C
C     THIS SUBROUTINE IS A TABCYL INTERVAL SCREENING TECHNIQUE THAT
C     CONSTRUCTS A RECTANGLE AROUND THE INTERVAL BEING CONSIDERED.
C     FOR TABPNT THE SECOND ARGUMENT (RAD) IS ZERO,FOR TABCIR, IT IS SET
C     EQUAL TO THE RADIUS OF THE CIRCLE.
C
      IMPLICIT REAL*8(A-H,O-Z)
      ABS(Q) = DABS(Q)
      DIMENSION PX(6),PY(6),D(1)
      TOLER=1.0E-6
      IVERTL=0
      MINUS=0
      IPLUS=0
 400  DELY=D(IHU+8)-D(IHU+1)
      DELX=D(IHU+7)-D(IHU)
      SL1Y=DELY/D(IHU+4)
      SL1X=DELX/D(IHU+4)
      SL2Y=SL1X
      SL2X=-SL1Y
      BO1=(RAD+TOLER)*SL1X
      BO2=(RAD+TOLER)*SL1Y
      BO3=ABS (D(IHU+5))+RAD+TOLER
      BO4=BO3*SL2X
      BO5=BO3*SL2Y
      BO6=ABS (D(IHU+6))+RAD+TOLER
      BO7=BO6*SL2X
      BO8=BO6*SL2Y
      PX(5)=D(IHU)-BO1
      PY(5)=D(IHU+1)-BO2
      PX(1)=PX(5)+BO4
      PY(1)=PY(5)+BO5
      PX(4)=PX(5)-BO7
      PY(4)=PY(5)-BO8
      PX(6)=D(IHU+7)+BO1
      PY(6)=D(IHU+8)+BO2
      PX(2)=PX(6)+BO4
      PY(2)=PY(6)+BO5
      PX(3)=PX(6)-BO7
      PY(3)=PY(6)-BO8
      XPLINE=D(3)*D(6)
      IF(ABS (D(4))-1.E-7)1,1,2
    1 IVERTL=1
      GO TO 3
    2 SLPLIN=-D(3)/D(4)
      X1PLIN=D(3)*D(6)
      Y1PLIN=D(4)*D(6)
      BPLIN=Y1PLIN-SLPLIN*X1PLIN
    3 DO10 I=1,4
      IF(IVERTL)5,5,6
    5 YPLINE=(SLPLIN)*PX(I)+BPLIN
      VALUE=PY(I)-YPLINE
      GO TO 4
    6 VALUE=PX(I)-XPLINE
    4 IF(VALUE)11,12,13
   11 MINUS=1
      GO TO 10
   13 IPLUS=1
   10 CONTINUE
   14 IF(MINUS-IPLUS)15,12,15
C
C     THE APPROPRIATE LINE, THAT IS, THE ACTUAL LINE FOR TABPNT OR THE
C     RADIUS PARALLEL LINE FOR TABCIR DOES NOT INTERSECT THE RECTANGLE
C     THUS THIS INTERVAL IS ELIMINATED FROM FURTHER CONSIDERATION.
C
   15 INTRCT=0
      GO TO 16
C
C     THE APPROPRIATE LINE DOES INTERSECT THE RECTANGLE SO THIS INTERVAL
C     MUST BE EXAMINED FURTHER
C
   12 INTRCT=1
   16 RETURN
       END

