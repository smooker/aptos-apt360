      SUBROUTINE ASIMEQ
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C
C...  SOLVES THREE SIMULTANEOUS EQUATIONS BY GAUSSIAN ELIMINATION
C     THE COEFFICIENTS OF THE UNKNOWNS AND THEIR RESPECTIVE CONSTANT
C     MUST BE STORED SEQUENTIALLY BY ROWS STARTING IN DEFTAB(100)
C     BEFORE THE SUBROUTINE IS ENTERED. THE SOLUTIONS TO THE EQUATIONS
C     ARE STORED SEQUENTIALLY STARTING IN DEFTAB(112). THE DEFERMINANT
C     IS STORED IN DEFTAB(115).
C     THE DETERMINANT IS TESTED, AND IF FOUND TO BE ZERO, JSUBER IS
C...  SET TO 1005 BEFORE RETURNING.
C
      IMPLICIT REAL*8(A-H,O-Z)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/AVST/VST(7200)
      DIMENSION DEFTAB(1000)
      EQUIVALENCE(VST(7200),DEFTAB(1000))
      DIMENSION A(3,4),NPRMUT(3),UNK(4)
      ABS(Q) = DABS(Q)
C
C
      DO 10 I=K1,3
 10   NPRMUT(I)=I
      DEFTAB(115)=0.
      UNK(4) = 0.
      K=100
      DO 20 I=K1,3
      DO 20 J=K1,4
      A(I,J)=DEFTAB(K)
 20   K=K+K1
      DO 90 K=K1,2
      GNAT=A(K,K)
      IF(ABS(GNAT)-10.E-5) 30,30,68
 30   DO 40 J=K,3
      IF(ABS(A(K,J))-10.E-5) 40,40,50
 40   CONTINUE
      GOTO 140
 50   DO 60 L=K1,3
      TEMP=A(L,J)
      A(L,J)=A(L,K)
 60   A(L,K)=TEMP
      IF( K.GE.2) GO TO 65
      NPRMUT(K)=J
      NPRMUT(J)=K
      GO TO 68
   65 TEMP = NPRMUT(K)
      NPRMUT(K) = NPRMUT(J)
      NPRMUT(J) = TEMP
   68 GNAT = A(K,K)
 70   DO 80 J=K,4
 80   A(K,J)=A(K,J)/GNAT
      KK=K+K1
      DO 90 I=KK,3
      BUG=A(I,K)
      DO 90 J=K,4
 90   A(I,J)=A(I,J)-A(K,J)*BUG
      IF(ABS(A(3,3))-10.E-6) 140,140,100
 100  A(3,4)=A(3,4)/A(3,3)
      DO 110 I=K1,3
      K=K4-I
      KK=K+K1
      UNK(K) = A(K,4)
      DO 110 J=KK,4
  110 UNK(K) = UNK(K) - UNK(J) * A(K,J)
      DEFTAB(115)=A(3,3)
      DO 130 I=K1,3
C...
C...  CODE CHANGED TO AGREE WITH VERSION SEVEN
C...
      LL = NPRMUT(I)
      DEFTAB(LL+111) = UNK(I)
 130  CONTINUE
      GOTO 150
 140  JSUBER = 1005
 150  RETURN
      END

