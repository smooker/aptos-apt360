       SUBROUTINE  PL3AXS (PT)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 2 ***
C... THIS SUBROUTINE IS CONCERNED WITH SETTING UP THE END POINTS OF THE
C... LINE SEGMENT BEFORE GOING ON TO PLOT.
C... IT WILL ALSO TAKE CARE OF DOING SPECIAL THINGS FOR GODLTA/ AND THE
C... FIRST POINT WITHIN A PLOT AREA.
C....*******************************************************************
      IMPLICIT REAL*8 (A-H,O-Z)
C***********************************************************************
       DOUBLE PRECISION   APOSTP,ATAPTB
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1 NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
       COMMON/APOSTP/PPNAME(20)
      COMMON/A3FXD1/AMATI1(4,4),AMATI2(4,4),AMATI3(4,4),AMATRX(3,4),
     1AMTR(36),AN1,AN2,ANAME,AX,AX0,AXVEC(3),AY,AY0,CNTM(36),CNTMAT(3,4)
     2,CONT(3),COUNT(3),CSEQNO(1),DELX,DELY,DX,DY,F0,ORIGIN(3),PARRAY
     3(20),PARTNO(12),PNT(3),PPRINT(12),PPT(6),PT0(3),PTT(6),PTU(3),
     4SEQNO(1),SUB(5),SUB4(6),TAPSTO(250),TITL(8),TL,TMATRX(3,4),
     5TNTM(36),TOOLNG,TRAMAT(3,4),VEC(3),WORD,X0,X1,X2,X3,XNEW,
     6Y0,Y1,Y2,Y3,YNEW
      REAL*8 MOTION
      COMMON/A3FXD2/MOTION(8)
      COMMON/A3FXI1/IARROW,I1,I2,ICLWAS,ICOPY,IDPLOT,IDPLSQ,IFIRST,
     1IGODLT,INDN,INSTR1,INSTR2,IND2TB(160),INDOFF,INDTAB(160),
     2INDXNO(3),IPERSP,IPL5AX,IPLOTI,IPLOTX,IPLWAS,IPX,IPY,IRECNI(3),
     3IRECNO,IRECTP,IRET,IRETVR,ISUBSC,ISWMAC,ISWNOC,IT,
     4ITHPNT,ITRAFL,ITRUNC,JARROW,JCLPRT,JCOPY,JPTSW,
     5JSW,JTYPSW,JVECTR,KCLPRT,KCOPY,MAXCOP,MULTAX,
     6NCAMRA,NK,NNTAB,NRECNO,NTAB,NUMWDS,NURCNO,NX,NX0,
     7NX1,NX2,NX4,NX5,NXP,NY,NY0,NY1,NY2,NY4,NY5,NYP,
     8IFALMS,IWARMS,INTSEQ
       REAL*8 NUCLTP
      EQUIVALENCE   (NUCLTP,TAPES2)
C...********************************************************************
C....*******************************************************************
       DOUBLE PRECISION PT(3)
C...  IS A PLOT IN EFFECT - IF NOT SAVE THE POINT AND RETURN.
             IF (IDPLOT)                          1000 , 9000 ,  1000
C...  SAVE THE INPUT POINT   PPT(I) = PT(I)
 1000  DO 1020 I=1,3
 1020          PPT(I) = PT(I)
C...  CHECK IF PERSPECTIVE PLOTTING REQUIRED
      IF (IPERSP.EQ.0) GO TO 1030
C...  PUT POINT THRU THE PERSPECTIVE MATRIX.
       CALL PERSPC (PPT(1),PPT(1))
C...  SHOULD THIS POINT BE PLOTTED - IF NOT SAVE IT AND RETURN.
 1030 IF (IPLOTI) 1040,9000,1040
C...  IS THIS THE FIRST POINT WITHIN THE PLOT-IF SO SAVE AND PLOT AN O
 1040        IF (IFIRST-K1)                       1060 , 7000 , 1050
C...  TURN FIRST POINT FLAG OFF.
 1050          IFIRST = K0
C...  CHECK IF A GODLTA - IF NOT IT MUST BE A GOTO POINT.
 1060        IF (IGODLT)                          3000 , 3000 , 1100
C...  IT IS A GODLTA - ADD COMPONENTS TO LAST POINT
 1100          PPT(IPX) = X0+PPT(IPX)
               PPT(IPY) = Y0+PPT(IPY)
C...  TURN OFF THE GODLTA FLAG.
               IGODLT = K0
C...  SET UP THE END POINTS OF LINE SEGMENT TO BE PLOTTED.
 3000          PTT(1) = X0
               PTT(2) = Y0
               PTT(3) = PPT(IPX)
               PTT(4) = PPT(IPY)
C...  PLOT THE LINE SEGMENT.
               CALL PLOT (PTT)
C...  GO TO SAVE THE POINT AND RETURN
       GO TO   9000
C...  THIS SECTION WILL PROCESS THE FIRST POINT WITHIN A PLOT AREA.
 7000          X0 = PPT(IPX)
               Y0 = PPT(IPY)
C...  CONVERT THE LOCATION TO RASTER COUNT.
               NX0 = NXV(X0)
               NY0 = NYV(Y0)
C...  CHECK IF X IS ON THE FRAME.
             IF  (NX0)                            7020 , 7050 , 7020
C...  CHECK IF Y IS ON THE FRAME.
 7020        IF  (NY0)                            7040 , 7050 , 7040
C...  IT IS ON THE FRAME - PLOT A CIRCLE AROUND THE POINT.
 7040          CALL PLOTV (NX0,NY0,38)
 7050          IFIRST = K2
C...  SAVE THE PRESENT POINT AS A PREVIOUS POINT.
 9000          X0 = PPT(IPX)
               Y0 = PPT(IPY)
C... RETURN TO SECTN3
 9999  RETURN
       END

