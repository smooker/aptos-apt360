      SUBROUTINE ARLM2(ARG1,ARG2,ARG3,ARG4,ARG5,AARG6,AARG7,IARG8,IARG9,
     1  ARG10,ARG11,ARG12,IDUMP)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 1 ***
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*4 AB
C***
C     SPECIAL COMMON FOR 2 DIMENSIONAL PACKAGE-- USES PROTAPE BUFFER
C     READ AREA WHICH IS AVAILABLE AT ARLM2 TIME AS SCRATCH
C***
C     NOTE... VARIABLES IER,VTEM,VNUL ARE NOT THE SAME AS IN THE MAIN
C     STREAM ARITHMETIC ELEMENT
C     ALSO EX,EY,EZ,VNUL
      COMMON/A2CMMN/DUMMY(1308) ,CSCF(3) ,DSCF(3) ,CFTEM(3) ,VTEM(3) ,
     1PTEM1(3)  ,PTEM2(3)  ,PT(3,6)   ,DOT(6)    ,FPNT(3)   ,TE2D(3)   ,
     2TI2D(3)   ,CR        ,THDS      ,THCS      ,TAUDS     ,TAUCS     ,
     3PERCEN    ,ANS       ,RES       ,PNTTAN(3) ,EX(3)     ,EY(3)     ,
     4EZ(3)     ,VNUL(3)   ,
     5ICSCF     ,IDSCF     ,ITOPT     ,N         ,IDONE     ,NREV      ,
     6ITFAR     ,ITC       ,IOC       ,IPC       ,INTP      ,IER       ,
     7NINT      ,ICASE     ,ITAN
      COMMON/A2FPC / Q15X01,QP9X01    ,QP6X01    ,QP5X01    ,QP4X01    ,
     1QP0001    ,QP001     ,QP01      ,QP1       ,Q1P       ,Q10P      ,
     2Q1000P    ,Q1PE5     ,Q1PE6     ,Q1PE10    ,Q1PE20    ,Q1PE30    ,
     3Q1PE36    ,Q1PE38    ,QP8X01    ,QP7X01    ,
     4QP4X09    ,QP9       ,QP99      ,QP995     ,QP997     ,QP999     ,
     5QP9999    ,QP4X95    ,QP5X95    ,QP6X9     ,QP7X9     ,
     6QP6X05    ,QP5X05    ,QP4X05    ,QP0005    ,QP005     ,QP05      ,
     7QP5       ,Q5P       ,                                 Q4X045    ,
     8QP0002    ,QP0047    ,QP017     ,Q1RAD     ,QP0349    ,QP125     ,
     9QP6       ,QP2       ,QP2499    ,QP25      ,QP3
      COMMON/A2FPC / QP7   ,QP75      ,QP8       ,QP866     ,Q1P01     ,
     1Q1P1      ,Q1P2      ,Q1P25     ,Q1P5      ,Q2P       ,Q2P5      ,
     2Q3P       ,Q3P5      ,Q4P       ,Q8P       ,Q11P      ,Q45P      ,
     3Q90P      ,Q130P     ,Q4500P    ,Q9000P    ,QP02      ,QNUL      ,
     4QPIE,Q100P,QFIL(8)
      DIMENSION ARG4(1),ARG5(1),AARG6(1),AARG7(1)
      DIMENSION ARG2(3)
C      CR,THDS,THCS,TE,TI,LDS1,LCS,ITOPT,N,TAUDS,TAUCS,PERCEN
      DIMENSION  AB(18)
      DATA AB(1),AB(2)/4HARLM,4H2 01/, AB(3),AB(4)/4HARLM,4H2 02/,
     1AB(5),AB(6)/4HARLM,4H2 03/,      AB(7),AB(8)/4HARLM,4H2 04/,
     2AB(9),AB(10)/4HARLM,4H2 05/,     AB(11),AB(12)/4HARLM,4H2 06/,
     3AB(13),AB(14)/4HARLM,4H2 07/,    AB(15),AB(16)/4HARLM,4H2 08/,
     4AB(17),AB(18)/4HARLM,4H2 09/
      CR = ARG1
      ITRY=1
C
      CALL AVSTO(ARG4,TE2D)
      CALL AVSTO(ARG5,TI2D)
      ITOPT = IARG8
      N = IARG9
      TAUDS = ARG10
      TAUCS = ARG11
      PERCEN = ARG12
      IF((PERCEN .GT. Q100P) .OR. (PERCEN .LT. QNUL)) GO TO 1
      IF(ITOPT.NE.4) GO TO 2
    1 CONTINUE
      TAUDS = ARG10 + QP4X05
      TAUCS = ARG11 + QP4X05
    2 CONTINUE
C
C...  ARLM2 FOR DECK C1.0  AUGUST 65
C     CR        =CUTTER RADIUS
C     THDS      =THICKNESS OF DRIVE SURFACE
C     THCS      =THICKNESS OF CHECK SURFACE
C     TE2D      =CURRENT CUTTER LOCATION
C     TI2D      =CURRENT DIRECTION OF MOVEMENT
C     LOCDS     =1ST CELL OF 3-D DS CANONICAL FORM
C     LOCCC     =1ST CELL OF 3-D CS CANONICAL FORM
C     TAUDS     =TOTAL DS TOLERANCE
C     TAUCS     =TOTAL CS TOLERANCE
C     ITOPT     =MOTION TERMINATION MODIFIER
C               =1 TO
C               =2 ON
C               =3 PAST
C               =4 TANTO
C     PERCEN    =PERCENTAGE OF DS TOLERANCE USED AT TE2D LOCATION
C
C
      DO 11 I=1,3
      EX(I) = QNUL
      EY(I) = QNUL
      EZ(I) = QNUL
      VNUL(I) = QNUL
   11 CONTINUE
      EX(1) = Q1P
      EY(2) = Q1P
      EZ(3) = Q1P
C***  MAKE TE2D AND TI2D  TWO DIMENSIONAL
C
      TE2D(3) = QNUL
      TI2D(3) = QNUL
      CALL AVNORM(TI2D,TI2D,IER)
      IF(IER.EQ.1) CALL AERR(701)
C
C...  STORE 2D CANONICAL FORMS
C
   12 CONTINUE
      CALL ADSCF(AARG6)
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(1),2,000010)
      CALL ACSCF(AARG7)
C
C
C...  COMPUTE ALL POSSIBLE INTERSECTIONS
   13 CONTINUE
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(5),2,000010)
C ARG2 IS TOOL NORMAL FOR DS -- USED TO TRY INNER AND OUTTER
C TOLERANCE BANDS IN PLANE CASE
      CALL AINT(ITRY)
      IF(ITRY .NE. 0) GO TO 95
C
C...  ORDER POINTS IN DIRECTION OF TRAVEL
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(7),2,000010)
      CALL AORDP
C
C...  SELECT FINAL POINT
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(9),2,000010)
      CALL ASELP
C
C
C... INITIALIZE AZCOR
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(11),2,000010)
      CALL AZCOR(ARG4,-1)
C***  SEGMENT CIRCLE DS IF APPROPRIATE
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(13),2,000010)
      IF(IDSCF.EQ.2) CALL ASEGMT
C
C...  CORRECT 2 VALUE OF FINAL POINT
C   INDICATE THAT THIS IS THE LAST POINT SO AZCOR WILL FLUSH THE BUFFER
C
      IF(IDUMP.NE.0) CALL ADYNDP(AB(15),2,000010)
      CALL AZCOR(FPNT,1)
      IF(IDUMP.NE.0) CALL ADYNDP (AB(17),2,000010)
C
      RETURN
   95 GO TO (100,110),IDSCF
  100 GO TO(101,102),ITRY
  101 ANS=TAUDS * PERCEN/Q100P
      CALL AVMULT (ARG2,ANS,VTEM)
      CALL AVADD(ARG4,VTEM,TE2D)
      TE2D(3) = QNUL
      ITRY = 2
      GO TO 12
  102 ANS = TAUDS * (Q100P - PERCEN) / Q100P
      CALL AVMULT(ARG2,ANS,VTEM)
      CALL AVSUB(ARG4,VTEM,TE2D)
      ITRY = 3
      GO TO 12
  110 GO TO (111,112),ITRY
  111 DSCF(3)=DSCF(3)-(TAUDS*PERCEN/Q100P)
      PERCEN = QNUL
      ITRY = 2
      GO TO 13
  112 DSCF(3) = DSCF(3) + TAUDS
      PERCEN = Q100P
      ITRY = 3
      GO TO 13
      END

