      SUBROUTINE AVS1CK(J)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C
      IMPLICIT REAL*8(A-H,O-Z)
      REAL*8 INWORD,NEWONE,NAME,IDIS,MACNAM,KRFSYS
       INTEGER*4 VST4(14400)
       INTEGER DEBUG,SUM
      COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
      COMMON/A1COM/NAME,KRFSYS,SUM,JSUBER,NAMSUB,DEBUG,INDXPT,LOOP,IFINI
      COMMON/AMXTAB/MAXTAB,MAXVS1,MAXVS2,MAXPTP,MAXSCL,MAXVS,
     1MAXVST,MXPTPP,MXCAN,MXSRCN,MAXSLR,MAXELM,MAXPOT
      COMMON/AVST/VST(2750),PTPP(2225),CANON(2225)
      COMMON/AMCSTF/MACNAM(5),MACCUR,MACLCN(5),MACRD,MACSTR(5),NMACVR
     1 ,NUMIDS,IDLOCN,MACIDS(5),ISVID
       EQUIVALENCE (VST(1),VST4(1))
C
C     THIS ROUTINE INTERROGATES THE VST FOR THE BCD ENTRY GIVEN IN NAMEZ
C     IF NAME IS FOUND IN THE VST, NAMSUB IS SET TO THE RELATIVE LOCATIO
C     N IN THE VST FOR NAME. IN NOT , NAMSUB=0
C     THE ENTRY TYPE IS EXAMINED, AND THE RETURN VARIABLE J SET THUSLY
C         J     TYPE OF ENTRY
C         1    SYMBOL NOT DEFINED
C         2    DEFINED AS A SURFACE
C         3    SYMBOL HAS BEEN CROSS-REFERENCED ONLY
C         4    SYMBOL IS A STATEMENT ID
C         5    DEFINED AS A SCALAR
C         6    DIMENSIONED BUT NOT USED
C         7    SYMBOL IS A MACRO NAME
C         8    SYMBOL IS DIMENSIONED AND FIRST USED AS A SCALAR
C         9    SYMBOL IS DIMENSIONED AND FIRST USED AS A SURFACE
C
C...     NAMSUB INITIALLY ZERO - SET TO VST INDEX IF SYMBOL FOUND
       NAMSUB = 0
C
C...     LOOK FOR NAME IN VST
       DO 10  N = 1,MAXVS1,2
            IF(VST(N).NE.NAME) GO TO 10
C...     SYMBOL FOUND - SET NAMSUB TO POINT TO 2ND WORD FOR IT IN VST
       NAMSUB = N
 10   CONTINUE
            IF(NAMSUB.NE.0) GO TO 20
C...     IT WAS NOT FOUND
   15 J=K1
      RETURN
C
C...     IT WAS FOUND...
   20  NAMS4 = 2*NAMSUB - 1
C...     SEE IF IT IS DIMENSIONED BUT NOT YET USED
            IF(VST4(NAMS4+3).LT.0) GO TO 70
C...     NO - HOW ABOUT DIMENSIONED AND USED
       J = VST4(NAMS4+2)
      IF(J.LT.K0) GO TO 70
C...     JUST NOT DIMENSIONED - IS IT DEFINED BUT NOT PROCESSED
      IF(J.EQ.K7) GOTO 30
C...     NO - TEST FOR REFERENCED BUT NOT DEFINED
      IF(J.EQ.K8) GOTO 35
      GOTO 40
 30   J=K2
      RETURN
 35   J=K3
      RETURN
C
C...     IS IT A STATEMENT ID
 40   IF(J.EQ.K3) GOTO 50
C...     NO - IS IT A SCALAR
      IF(J.EQ.K2) GOTO 60
C...  IF IT IS A SYSTEM MACRO WHICH IS NOT YET DEFINED, RETURN
      IF (J.EQ.11) RETURN
      J=K7
      RETURN
 50   J=K4
      RETURN
 60   J=K5
      RETURN
C
C     DIMENSIONED VARIABLE
 70   CALL APRFIX(K3,KRET)
      IF(KRET-K1)80,90,100
C...     USE NOT YET ESTABLISHED
 80   J=K6
      RETURN
C...     SCALAR ARRAY
 90   J=K8
      RETURN
C...     SURFACE ARRAY
 100  J=K9
      RETURN
      END

