      SUBROUTINE AVS2CK(JK)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 3 ***
C**** THIS ROUTINE CHECKS THE STATUS OFA VARIABLE SYMBOL IN THE VST. THE
C     INPUT TO THE ROUTINE IS THE VST, THE INDEX TO THE VST IN THE
C     VARIABLENAME AND THE SUBSCRIPT VALUE IN THE VARIABLE NAMSUB. JK IS
C     THE RETURN VARIABLE SET AS FOLLOWS
C     =1, SURFACE IN CANON TABLE
C     =2, SCALAR IN CANON TABLE
C     =3, STATEMENT ID
C     =4, SURFACE IN DEFTAB CANON
C     =5, SURFACE IN DEFPRE CANON
C     =6, SURFACE IN CANTAP FILE
C     =7, HAS NOT BEEN PROCESSED IN PHASE 2
C     =8, UNDEFINED BUT CROSS REFERENCED
C     =9, INCORRECTLY DEFINED
C     =10, SUBSCRIPT EXCEEDS ALLOWABLE RANGE
C     =11, OTHER ERRORS
C
      IMPLICIT REAL*8(A-H,O-Z)
       INTEGER*2 KVST(28800)
       DIMENSION PTPP(7200),CANON(7200)
       COMMON/A1COM/REFSYS,NAME,NAME1,JSUBER,JSV,NAMSUB,KDBUG,INDXPT,
     1 LOOP,IFINI
      COMMON/AMXTAB/MAXTAB,MAXVS1,MAXVS2,MAXPTP,MAXSCL,MAXVS,
     1MAXVST,MXPTPP,MXCAN,MXSRCN,MAXSLR,MAXELM,MAXPOT
      COMMON/AVST/VST(7200)
       DIMENSION IVST(14400)
      EQUIVALENCE(VST(1),PTPP(1),CANON(1))
       EQUIVALENCE (VST(1),IVST(1),KVST(1))
C
C     UPDATE VST INDEX
       NAME = NAME + 1
C     IS THE SYMBOL SUBSCRIPTED
            IF(NAMSUB.EQ.0) GO TO 10
C
C     THE SYMBOL IS SUBSCRIPTED.
C     GET MAXIMUM SIZE OF RESERV ARRAY
       NAMTEM = 2*NAME - 1
C...     MAKE SURE ARRAY HAS AT LEAST ONE DEFINED ENTRY
            IF(IVST(NAMTEM).LT.0) GO TO 5
C...     IT DOES NOT - SET RETURN VARIABLE FOR UNDEFINED, AND EXIT
       JK = 7
       GO TO 15
C
C...     THERE IS AT LEAST ONE ENTRY - COMPUTE INDEX TO DESCRIPTOR
C...     FOR DESIRED SUBSCRIPT VALUE
    5  NAME = IABS(IVST(NAMTEM)) + NAMSUB + MAXVS1
C
C...     PICK UP THE TYPE CODE FOR THIS (POSSIBLY SUBSCRIPTED) SYMBOL
   10  NAMTEM = 4*NAME - 3
       JK = KVST(NAMTEM+1)
            IF(JK.EQ.8) JK = 7
   15  RETURN
       END

