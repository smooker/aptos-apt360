       SUBROUTINE PL5AXS (PT)
C     *** THIS PROGRAM LAST MODIFIED FOR VERSION 4, MODIFICATION 2 ***
C... THIS ROUTINE IS USED TO PLOT A REPRESENTATION OF THE TOOL AXIS
C... VECTOR ONTO EVERY ITHPNT POINT AND IF THE JVECTR FLAG IS SET WILL
C... PUT A VECTOR ON THE IMMEDIATE POINT.
C....*******************************************************************
      IMPLICIT REAL*8 (A-H,O-Z)
C***********************************************************************
       DOUBLE PRECISION   APOSTP,ATAPTB
       REAL*8 PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,TAPES1,TAPES2,
     1 TAPES3,TAPES4,PPNAME
       INTEGER PUNTAP
       COMMON/A0CON/K0,K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11,K12,IBLANK
       COMMON/ATAPTB/PROTAP,CANTAP,CLTAPE,POCTAP,PLOTAP,SRFTAP,
     1 TAPES1,TAPES2,TAPES3,TAPES4,INTAPE,IOUTAP,PUNTAP
       COMMON/ASISTM/IPTNLY,ITRCUT,IWAVEN,KFLAG1,LTVMIT,NCLREC,NOPOST,
     1 NOPLOT,NUMPST,NUMPTR,ICLPRT,INDEXX,IPLOTR,KFLAGS(9)
       COMMON/APOSTP/PPNAME(20)
      COMMON/A3FXD1/AMATI1(4,4),AMATI2(4,4),AMATI3(4,4),AMATRX(3,4),
     1AMTR(36),AN1,AN2,ANAME,AX,AX0,AXVEC(3),AY,AY0,CNTM(36),CNTMAT(3,4)
     2,CONT(3),COUNT(3),CSEQNO(1),DELX,DELY,DX,DY,F0,ORIGIN(3),PARRAY
     3(20),PARTNO(12),PNT(3),PPRINT(12),PPT(6),PT0(3),PTT(6),PTU(3),
     4SEQNO(1),SUB(5),SUB4(6),TAPSTO(250),TITL(8),TL,TMATRX(3,4),
     5TNTM(36),TOOLNG,TRAMAT(3,4),VEC(3),WORD,X0,X1,X2,X3,XNEW,
     6Y0,Y1,Y2,Y3,YNEW
      REAL*8 MOTION
      COMMON/A3FXD2/MOTION(8)
      COMMON/A3FXI1/IARROW,I1,I2,ICLWAS,ICOPY,IDPLOT,IDPLSQ,IFIRST,
     1IGODLT,INDN,INSTR1,INSTR2,IND2TB(160),INDOFF,INDTAB(160),
     2INDXNO(3),IPERSP,IPL5AX,IPLOTI,IPLOTX,IPLWAS,IPX,IPY,IRECNI(3),
     3IRECNO,IRECTP,IRET,IRETVR,ISUBSC,ISWMAC,ISWNOC,IT,
     4ITHPNT,ITRAFL,ITRUNC,JARROW,JCLPRT,JCOPY,JPTSW,
     5JSW,JTYPSW,JVECTR,KCLPRT,KCOPY,MAXCOP,MULTAX,
     6NCAMRA,NK,NNTAB,NRECNO,NTAB,NUMWDS,NURCNO,NX,NX0,
     7NX1,NX2,NX4,NX5,NXP,NY,NY0,NY1,NY2,NY4,NY5,NYP,
     8IFALMS,IWARMS,INTSEQ
       REAL*8 NUCLTP
      EQUIVALENCE   (NUCLTP,TAPES2)
C...********************************************************************
C....*******************************************************************
       DOUBLE PRECISION PT(6)
C...  IS A PLOT IN EFFECT - ZERO MEANS NO,RETURN.
             IF (IDPLOT)                          1000 , 9999 , 1000
C...  SAVE THE INPUT POINT
 1000  DO 1020 I=1,6
 1020          PPT(I) = PT(I)
C...  CHECK IF PERSPECTIVE PLOTTING REQUIRED
      IF (IPERSP.EQ.0) GO TO 1030
C... TRANSFORM POINT    FOR PERSPECTIVE
       CALL PERSPC (PPT(1),PPT(1))
C...  IS THE VECTOR FLAG SET - IF SO THEN PLOT THE TOOL AXIS VECTOR
 1030 IF (JVECTR) 2000,2000,3000
C...  ADD ONE TO I - CAUSES A TOOL VECTOR TO BE PLOTTED EVERY ITH POINT.
 2000  K = K+1
C...  IS I = ITHPNT - IF SO THEN PLOT THE TOOL AXIS VECTOR.
       IF (ITHPNT.NE.K) GO TO 9999
C...  SET UP THE END POINTS FOR THE TOOL AXIS VECTOR.
 3000          PTT(1) = PPT(IPX)
               PTT(2) = PPT(IPY)
               PTT(3) = (PPT(IPX+3)*(.3*TOOLNG))+PPT(IPX)
               PTT(4) = (PPT(IPY+3)*(.3*TOOLNG))+PPT(IPY)
               JARROW = K0
C... PLOT THE TOOL AXIS VECTOR
               CALL PLOT (PTT)
               PTT(1) = PTT(3)+((.1*TOOLNG)*PPT(IPX+3))
               PTT(2) = PTT(4)+((.1*TOOLNG)*PPT(IPY+3))
               PTT(3) = PTT(1)+((.2*TOOLNG)*PPT(IPX+3))
               PTT(4) = PTT(2)+((.2*TOOLNG)*PPT(IPY+3))
               JARROW = K0
               CALL PLOT (PTT)
               PTT(1) = PTT(3)+((.1*TOOLNG)*PPT(IPX+3))
               PTT(2) = PTT(4)+((.1*TOOLNG)*PPT(IPY+3))
               PTT(3) = PTT(1)+((.3*TOOLNG)*PPT(IPX+3))
               PTT(4) = PTT(2)+((.3*TOOLNG)*PPT(IPY+3))
               JARROW = K0
               CALL PLOT (PTT)
C...  A TOOL AXIS VECTOR HAS BEEN PLOTTED-SET THE COUNTER(I) BACK
       K = 0
               JVECTR = K0
 9999  RETURN
       END

